(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    525927,      12354]
NotebookOptionsPosition[    504250,      11993]
NotebookOutlinePosition[    504592,      12008]
CellTagsIndexPosition[    504549,      12005]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Definitions", "Title",
 InitializationCell->True,
 CellChangeTimes->{{3.7665228924941683`*^9, 3.7665228941026397`*^9}, {
  3.766523070660013*^9, 3.766523072435424*^9}, {3.7722997825530252`*^9, 
  3.7722997835712566`*^9}},ExpressionUUID->"7b061464-1174-42da-9a30-\
015c9811eb9c"],

Cell[CellGroupData[{

Cell["Pauli matrices and projector |+><+|", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.7647978740567865`*^9, 3.7647979890356164`*^9}, {
   3.764838616666809*^9, 3.7648386987759185`*^9}, 
   3.7667046474820557`*^9},ExpressionUUID->"9ebe6c1d-02e0-4df3-9f0b-\
a476c90512f9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"one", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProjX", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"one", "+", "x"}], ")"}], "/", "2"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.763365631911147*^9, 3.7633656378642044`*^9}, {
   3.7633657053634434`*^9, 3.7633657091602755`*^9}, {3.7633667008114567`*^9, 
   3.7633667110300894`*^9}, {3.763369026214366*^9, 3.763369028766115*^9}, {
   3.763384051323248*^9, 3.7633840610587907`*^9}, {3.764779538902252*^9, 
   3.764779723077499*^9}, {3.764797854016339*^9, 3.764797865728911*^9}, {
   3.764836954872919*^9, 3.764837014702769*^9}, {3.764837698635578*^9, 
   3.764837699365696*^9}, 3.7665165418363285`*^9, {3.7667046536381454`*^9, 
   3.766704654949318*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"502f799d-cad8-4eb8-a569-7f825d0b12d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Density matrices of pure |+> states, pure magic states and pure CCZ states\
\>", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.7667046613330708`*^9, 
  3.766704676839938*^9}},ExpressionUUID->"1919e19d-05f9-4691-900f-\
a2678a4e9203"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MagicState", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "I"}], " ", 
           RowBox[{"\[Pi]", "/", "4"}]}], "]"}]}], "}"}], "}"}], 
      "\[HermitianConjugate]"}], ".", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "I"}], " ", 
          RowBox[{"\[Pi]", "/", "4"}]}], "]"}]}], "}"}], "}"}]}], "/", 
    "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlusState", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "}"}], "\[HermitianConjugate]"}], ".", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], "}"}]}], "/", "2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CCZState", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
         RowBox[{"-", "1"}]}], "}"}], "}"}], "\[HermitianConjugate]"}], ".", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        RowBox[{"-", "1"}]}], "}"}], "}"}]}], "/", "8"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.766704683056755*^9, 3.766704683717539*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"0e8a831e-4518-4d6d-9873-6edd7268de0b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Density matrices of 5, 7 and 4 |+> states", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.7667046871079426`*^9, 
  3.7667046974764633`*^9}},ExpressionUUID->"790315b2-b4b4-4a0e-9436-\
cd193891b3b3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Init4Qubit", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
    "PlusState", ",", "PlusState", ",", "PlusState", ",", "PlusState"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Init5Qubit", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
    "PlusState", ",", "PlusState", ",", "PlusState", ",", "PlusState", ",", 
     "PlusState"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Init7Qubit", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
    "PlusState", ",", "PlusState", ",", "PlusState", ",", "PlusState", ",", 
     "PlusState", ",", "PlusState", ",", "PlusState"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.7667047015363674`*^9},
 CellLabel->"In[81]:=",ExpressionUUID->"f9bbf4ed-d63c-44b4-b382-bb4523a0e8b2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Density matrices corresponding to the ideal output state of 15-to-1, 20-to-4 \
and 8-to-CCZ\
\>", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.766704704595609*^9, 
  3.766704711822815*^9}},ExpressionUUID->"15368d64-d5dc-400a-be4e-\
3c8e0363c136"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Ideal15to1", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
    "MagicState", ",", "PlusState", ",", "PlusState", ",", "PlusState", ",", 
     "PlusState"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ideal20to4", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
    "MagicState", ",", "MagicState", ",", "MagicState", ",", "MagicState", 
     ",", "PlusState", ",", "PlusState", ",", "PlusState"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IdealCCZ", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"CCZState", ",", "PlusState"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.766704714876405*^9},
 CellLabel->"In[84]:=",ExpressionUUID->"c115fa45-4058-4b57-8100-0fa8b25ae19e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Pauli product rotation ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["e", "iP\[Phi]"], TraditionalForm]],ExpressionUUID->
  "c05be2a0-6f6a-4583-9e90-e5a35b46ad80"],
 ", where the Pauli product P is specified by \[OpenCurlyQuote]axis\
\[CloseCurlyQuote]"
}], "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.764798002802386*^9, 
  3.7647980442532253`*^9}},ExpressionUUID->"2b4d590d-9b92-403f-ad14-\
1bbc3524227b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PauliRot", "[", 
   RowBox[{"axis_", ",", "\[Phi]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"N", "[", 
      RowBox[{"\[Phi]", ",", "50"}], "]"}], "]"}], 
    RowBox[{"KroneckerProduct", "@@", 
     RowBox[{"Table", "[", 
      RowBox[{"one", ",", 
       RowBox[{"Length", "[", "axis", "]"}]}], "]"}]}]}], "+", 
   RowBox[{"I", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"N", "[", 
      RowBox[{"\[Phi]", ",", "50"}], "]"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"KroneckerProduct", "@@", "axis"}], ")"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.764779729436793*^9, 3.7647797903001275`*^9}, 
   3.764779861275017*^9, 3.764780076697667*^9, {3.766520783609143*^9, 
   3.766520808890809*^9}, {3.766520999209588*^9, 3.7665210055445004`*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"8eb5be51-f800-4bdf-824e-9cc74a87a20f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Maps \[Rho] \[Rule] ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SubscriptBox["p", "1"], "-", 
     SubscriptBox["p", "2"], "-", 
     SubscriptBox["p", "3"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "ee1a46ed-201d-405f-be00-0268692ecf33"],
 " (",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["e", 
    RowBox[{"i", " ", "P", " ", 
     FractionBox["\[Pi]", "8"]}]], TraditionalForm]],ExpressionUUID->
  "7c5c07d3-e092-4416-99a4-5dd6534838c4"],
 ") \[Rho] (",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["e", 
    RowBox[{"i", " ", "P", " ", 
     FractionBox["\[Pi]", "8"]}]], TraditionalForm]],ExpressionUUID->
  "409ac945-f2a5-4d25-a8ac-06dae1a15807"],
 Cell[BoxData[
  FormBox[
   SuperscriptBox[")", "\[Dagger]"], TraditionalForm]],ExpressionUUID->
  "ae75a162-c8f2-4521-93fa-be60660e1c88"],
 " + ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["p", "1"], TraditionalForm]],ExpressionUUID->
  "cb90c5b6-7e9a-412d-8315-5b7ff05c495e"],
 " (",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["e", 
    RowBox[{"i", " ", "P", " ", 
     FractionBox[
      RowBox[{"5", "\[Pi]"}], "8"]}]], TraditionalForm]],ExpressionUUID->
  "ce41080e-8f14-40c6-a520-fc4d305d2760"],
 ") \[Rho] (",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["e", 
    RowBox[{"i", " ", "P", " ", 
     FractionBox[
      RowBox[{"5", "\[Pi]"}], "8"]}]], TraditionalForm]],ExpressionUUID->
  "86de0afa-84cd-474d-bf61-b5471935d6b0"],
 Cell[BoxData[
  FormBox[
   SuperscriptBox[")", "\[Dagger]"], TraditionalForm]],ExpressionUUID->
  "fc19ac19-59cd-4c21-96fe-ad1ae595239c"],
 " + ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["p", "2"], TraditionalForm]],ExpressionUUID->
  "1ebf1e49-4168-42ea-b8b6-afecd8aba1be"],
 " (",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["e", 
    RowBox[{
     RowBox[{"-", "i"}], " ", "P", " ", 
     FractionBox["\[Pi]", "8"]}]], TraditionalForm]],ExpressionUUID->
  "909ca898-17d9-4229-a926-40bf44041cec"],
 ") \[Rho] (",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["e", 
    RowBox[{
     RowBox[{"-", "i"}], " ", "P", " ", 
     FractionBox["\[Pi]", "8"]}]], TraditionalForm]],ExpressionUUID->
  "38052289-2d7f-4edf-9b99-b97b42e476e2"],
 Cell[BoxData[
  FormBox[
   SuperscriptBox[")", "\[Dagger]"], TraditionalForm]],ExpressionUUID->
  "4bc616b3-ffd5-47e7-92a2-0e54ced2ea43"],
 " + ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["p", "3"], TraditionalForm]],ExpressionUUID->
  "6c8680d0-0101-440f-baa4-220ed781c7a0"],
 " (",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["e", 
    RowBox[{
     RowBox[{"-", "i"}], " ", "P", " ", 
     FractionBox[
      RowBox[{"3", "\[Pi]"}], "8"]}]], TraditionalForm]],ExpressionUUID->
  "4c3ecd6d-4ad4-4dba-82be-bdda5c7d040f"],
 ") \[Rho] (",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["e", 
    RowBox[{
     RowBox[{"-", "i"}], " ", "P", " ", 
     FractionBox[
      RowBox[{"3", "\[Pi]"}], "8"]}]], TraditionalForm]],ExpressionUUID->
  "690cd31e-7240-4ea5-a095-bb99e7d00fa7"],
 Cell[BoxData[
  FormBox[
   SuperscriptBox[")", "\[Dagger]"], TraditionalForm]],ExpressionUUID->
  "1e1daedb-77b4-4b78-bc43-8b2b78cbb79b"],
 ", i.e. attempts to perform a ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["P", 
    RowBox[{"\[Pi]", "/", "8"}]], TraditionalForm]],ExpressionUUID->
  "136855ee-671d-495d-ad1f-ed2871efc240"],
 " rotation, with a probability ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["p", "1"], TraditionalForm]],ExpressionUUID->
  "5c15ef2d-91f8-4f88-91f5-e22c55d2df6e"],
 " / ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["p", 
    RowBox[{"2", " "}]], TraditionalForm]],ExpressionUUID->
  "df27fab2-1691-4cf3-ad1f-740eb25818d7"],
 " / ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["p", 
    RowBox[{"3", " "}]], TraditionalForm]],ExpressionUUID->
  "7e04d08b-d30c-4f32-b8af-7eb646618a92"],
 " of performing ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["P", 
    RowBox[{"5", 
     RowBox[{"\[Pi]", "/", "8"}]}]], TraditionalForm]],ExpressionUUID->
  "c294cd8b-446e-4732-b232-92197c932546"],
 " / ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["P", 
    RowBox[{
     RowBox[{"-", "\[Pi]"}], "/", "8"}]], TraditionalForm]],ExpressionUUID->
  "d0aafcaa-2f9c-4167-97e8-ae982c8a4ff5"],
 " / ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["P", 
    RowBox[{"3", 
     RowBox[{"\[Pi]", "/", "8"}]}]], TraditionalForm]],ExpressionUUID->
  "37bce09a-15e2-4cb7-8000-fd085c369691"],
 " instead, leading to a ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["P", 
      RowBox[{"\[Pi]", "/", "2"}]], "/", 
     SubscriptBox["P", 
      RowBox[{
       RowBox[{"-", "\[Pi]"}], "/", "4"}]]}], "/", 
    SubscriptBox["P", 
     RowBox[{"\[Pi]", "/", "4"}]]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "13cd4ec6-c560-44aa-a7bb-093ba96127ff"],
 " error."
}], "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.7647980534732914`*^9, 3.7647983813315706`*^9}, {
  3.766704769951722*^9, 
  3.766704830398197*^9}},ExpressionUUID->"f4f0b7fa-5ce7-4424-bffd-\
7b23bd97be66"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ApplyRot", "[", 
   RowBox[{"\[Rho]_", ",", "axis_", ",", "p1_", ",", "p2_", ",", "p3_"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "p1", "-", "p2", "-", "p3"}], ")"}], 
    RowBox[{
     RowBox[{"PauliRot", "[", 
      RowBox[{"axis", ",", 
       RowBox[{"\[Pi]", "/", "8"}]}], "]"}], ".", "\[Rho]", ".", 
     RowBox[{
      RowBox[{"PauliRot", "[", 
       RowBox[{"axis", ",", 
        RowBox[{"\[Pi]", "/", "8"}]}], "]"}], "\[HermitianConjugate]"}]}]}], 
   "+", 
   RowBox[{"p1", " ", 
    RowBox[{
     RowBox[{"PauliRot", "[", 
      RowBox[{"axis", ",", 
       RowBox[{"5", 
        RowBox[{"\[Pi]", "/", "8"}]}]}], "]"}], ".", "\[Rho]", ".", 
     RowBox[{
      RowBox[{"PauliRot", "[", 
       RowBox[{"axis", ",", 
        RowBox[{"5", 
         RowBox[{"\[Pi]", "/", "8"}]}]}], "]"}], 
      "\[HermitianConjugate]"}]}]}], "+", 
   RowBox[{"p2", " ", 
    RowBox[{
     RowBox[{"PauliRot", "[", 
      RowBox[{"axis", ",", 
       RowBox[{
        RowBox[{"-", "\[Pi]"}], "/", "8"}]}], "]"}], ".", "\[Rho]", ".", 
     RowBox[{
      RowBox[{"PauliRot", "[", 
       RowBox[{"axis", ",", 
        RowBox[{
         RowBox[{"-", "\[Pi]"}], "/", "8"}]}], "]"}], 
      "\[HermitianConjugate]"}]}]}], "+", 
   RowBox[{"p3", " ", 
    RowBox[{
     RowBox[{"PauliRot", "[", 
      RowBox[{"axis", ",", 
       RowBox[{"3", 
        RowBox[{"\[Pi]", "/", "8"}]}]}], "]"}], ".", "\[Rho]", ".", 
     RowBox[{
      RowBox[{"PauliRot", "[", 
       RowBox[{"axis", ",", 
        RowBox[{"3", 
         RowBox[{"\[Pi]", "/", "8"}]}]}], "]"}], 
      "\[HermitianConjugate]"}]}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7647798280432205`*^9, 3.764779931307378*^9}, {
  3.766660040316926*^9, 3.766660046900759*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"4dd718ac-0c82-44ca-9dec-5d5008c8bd22"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Maps \[Rho] \[Rule] (1-p) \[Rho]  +  p  P \[Rho] P, i.e.,  applies a Pauli \
operation P with probability p\
\>", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.7647983961920767`*^9, 
  3.764798434242041*^9}},ExpressionUUID->"060ecccd-6c36-408b-ae7f-\
075de8b4df9d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ApplyPauli", "[", 
   RowBox[{"\[Rho]_", ",", "pauli_", ",", "p_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "p"}], ")"}], "\[Rho]"}], "+", 
   RowBox[{"p", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "@@", "pauli"}], ")"}], ".", "\[Rho]", ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "@@", "pauli"}], ")"}]}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7647800291579633`*^9, 3.7647800692528086`*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"4ec0e330-bb8f-4409-83b0-94cafced2957"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Estimate of the logical error rate of a distance-d surface-code patch with \
a circuit-level error rate of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["p", "phys"], TraditionalForm]],ExpressionUUID->
  "db1d9f5e-31d7-4c45-8d2e-2e451cfc93d8"]
}], "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.7647984435876226`*^9, 
  3.764798477243034*^9}},ExpressionUUID->"805c1e0c-df17-490a-acc0-\
2cd362f2af9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"plog", "[", 
   RowBox[{"pphys_", ",", "d_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", "10"], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"100", "pphys"}], ")"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"d", "+", "1"}], ")"}], "/", "2"}]]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7647799397519045`*^9, 3.764779961159222*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"1b1a8366-6b6d-4811-9042-767ad19fad5e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
For the 8-to-CCZ protocol, applies X/Z storage errors to qubits 1-4 with \
probabilities p1-p4\
\>", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.7647985135703*^9, 3.7647985337404194`*^9}, {
   3.764838708951502*^9, 3.764838713856134*^9}, 
   3.7667048634860344`*^9},ExpressionUUID->"8a8c97dd-e7dd-47e9-8352-\
4a1f3be55759"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StorageZ4Qubit", "[", 
   RowBox[{"\[Rho]_", ",", "p1_", ",", "p2_", ",", "p3_", ",", "p4_"}], "]"}],
   ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "output", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"\[Rho]", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "one", ",", "one", ",", "one"}], "}"}], ",", 
        "p1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "z", ",", "one", ",", "one"}], "}"}], ",", 
        "p2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "z", ",", "one"}], "}"}], ",", 
        "p3"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "one", ",", "z"}], "}"}], ",", 
        "p4"}], "]"}]}], ";", "\[IndentingNewLine]", "output"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7660877256243467`*^9, 3.7660877850216446`*^9}, {
  3.7660893353933992`*^9, 3.7660893409425597`*^9}, {3.7661825418021455`*^9, 
  3.7661825520984173`*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"7d73a321-eaac-4fac-904c-47ff56c07f6f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StorageX4Qubit", "[", 
   RowBox[{"\[Rho]_", ",", "p1_", ",", "p2_", ",", "p3_", ",", "p4_"}], "]"}],
   ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "output", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"\[Rho]", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "one", ",", "one", ",", "one"}], "}"}], ",", 
        "p1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "x", ",", "one", ",", "one"}], "}"}], ",", 
        "p2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "x", ",", "one"}], "}"}], ",", 
        "p3"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "one", ",", "x"}], "}"}], ",", 
        "p4"}], "]"}]}], ";", "\[IndentingNewLine]", "output"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7660892507334795`*^9, 3.766089256333625*^9}, {
  3.7660893423690877`*^9, 3.7660893450831847`*^9}, {3.7661825436538215`*^9, 
  3.766182564547154*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"16f46c30-1471-433e-8711-28372439517d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
For the 15-to-1 protocol, applies X/Z storage errors to qubits 1-5 with \
probabilities p1-p5\
\>", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{
  3.7667048732859344`*^9},ExpressionUUID->"9c017ebc-519a-4f40-a733-\
73cf474ef4d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StorageZ5Qubit", "[", 
   RowBox[{
   "\[Rho]_", ",", "p1_", ",", "p2_", ",", "p3_", ",", "p4_", ",", "p5_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "output", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"\[Rho]", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "one", ",", "one", ",", "one", ",", "one"}], "}"}],
         ",", "p1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "z", ",", "one", ",", "one", ",", "one"}], "}"}],
         ",", "p2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "z", ",", "one", ",", "one"}], "}"}],
         ",", "p3"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "one", ",", "z", ",", "one"}], "}"}],
         ",", "p4"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "one", ",", "one", ",", "z"}], "}"}],
         ",", "p5"}], "]"}]}], ";", "\[IndentingNewLine]", "output"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7660877256243467`*^9, 3.7660877850216446`*^9}, {
  3.7660893353933992`*^9, 3.7660893409425597`*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"77e7bfdd-72d9-4fc0-8438-7c8618af701e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StorageX5Qubit", "[", 
   RowBox[{
   "\[Rho]_", ",", "p1_", ",", "p2_", ",", "p3_", ",", "p4_", ",", "p5_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "output", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"\[Rho]", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "one", ",", "one", ",", "one", ",", "one"}], "}"}],
         ",", "p1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "x", ",", "one", ",", "one", ",", "one"}], "}"}],
         ",", "p2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "x", ",", "one", ",", "one"}], "}"}],
         ",", "p3"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "one", ",", "x", ",", "one"}], "}"}],
         ",", "p4"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "one", ",", "one", ",", "x"}], "}"}],
         ",", "p5"}], "]"}]}], ";", "\[IndentingNewLine]", "output"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7660892507334795`*^9, 3.766089256333625*^9}, {
  3.7660893423690877`*^9, 3.7660893450831847`*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"7790425b-67fc-4a5a-9af9-7fb6072120af"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
For the 20-to-4 protocol, applies X/Z storage errors to qubits 1-7 with \
probabilities p1-p7\
\>", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{
  3.7667048803576794`*^9},ExpressionUUID->"2fcbcf47-d3c2-4aa2-ad3d-\
2a245cb767bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StorageZ7Qubit", "[", 
   RowBox[{
   "\[Rho]_", ",", "p1_", ",", "p2_", ",", "p3_", ",", "p4_", ",", "p5_", ",",
     "p6_", ",", "p7_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "output", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"\[Rho]", ",", 
        RowBox[{"{", 
         RowBox[{
         "z", ",", "one", ",", "one", ",", "one", ",", "one", ",", "one", ",",
           "one"}], "}"}], ",", "p1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{
         "one", ",", "z", ",", "one", ",", "one", ",", "one", ",", "one", ",",
           "one"}], "}"}], ",", "p2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{
         "one", ",", "one", ",", "z", ",", "one", ",", "one", ",", "one", ",",
           "one"}], "}"}], ",", "p3"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{
         "one", ",", "one", ",", "one", ",", "z", ",", "one", ",", "one", ",",
           "one"}], "}"}], ",", "p4"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{
         "one", ",", "one", ",", "one", ",", "one", ",", "z", ",", "one", ",",
           "one"}], "}"}], ",", "p5"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{
         "one", ",", "one", ",", "one", ",", "one", ",", "one", ",", "z", ",",
           "one"}], "}"}], ",", "p6"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{
         "one", ",", "one", ",", "one", ",", "one", ",", "one", ",", "one", 
          ",", "z"}], "}"}], ",", "p7"}], "]"}]}], ";", "\[IndentingNewLine]",
      "output"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7660877256243467`*^9, 3.7660877850216446`*^9}, {
  3.7660893353933992`*^9, 3.7660893409425597`*^9}, {3.7661790588251514`*^9, 
  3.766179104219982*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"dfe4f924-234f-488a-9cf6-8163b81c8ba0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StorageX7Qubit", "[", 
   RowBox[{
   "\[Rho]_", ",", "p1_", ",", "p2_", ",", "p3_", ",", "p4_", ",", "p5_", ",",
     "p6_", ",", "p7_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "output", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"\[Rho]", ",", 
        RowBox[{"{", 
         RowBox[{
         "x", ",", "one", ",", "one", ",", "one", ",", "one", ",", "one", ",",
           "one"}], "}"}], ",", "p1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{
         "one", ",", "x", ",", "one", ",", "one", ",", "one", ",", "one", ",",
           "one"}], "}"}], ",", "p2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{
         "one", ",", "one", ",", "x", ",", "one", ",", "one", ",", "one", ",",
           "one"}], "}"}], ",", "p3"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{
         "one", ",", "one", ",", "one", ",", "x", ",", "one", ",", "one", ",",
           "one"}], "}"}], ",", "p4"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{
         "one", ",", "one", ",", "one", ",", "one", ",", "x", ",", "one", ",",
           "one"}], "}"}], ",", "p5"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{
         "one", ",", "one", ",", "one", ",", "one", ",", "one", ",", "x", ",",
           "one"}], "}"}], ",", "p6"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyPauli", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{
         "one", ",", "one", ",", "one", ",", "one", ",", "one", ",", "one", 
          ",", "x"}], "}"}], ",", "p7"}], "]"}]}], ";", "\[IndentingNewLine]",
      "output"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7660892507334795`*^9, 3.766089256333625*^9}, {
   3.7660893423690877`*^9, 3.7660893450831847`*^9}, 3.7661790614501195`*^9, {
   3.766179109924609*^9, 3.7661791256290007`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"3710a954-c850-4b2f-be8f-36996c7da5bc"],

Cell[BoxData[{
 RowBox[{"Off", "[", 
  RowBox[{"NumberForm", "::", "sigz"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Off", "[", 
  RowBox[{"NumberForm", "::", "reqsigz"}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7647910679493713`*^9, 3.764791071797351*^9}, {
  3.765719596795343*^9, 3.765719599085593*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"3fe62e5e-f406-46e5-9029-8b957d9a3e02"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["15-to-1 protocol", "Title",
 InitializationCell->True,
 CellChangeTimes->{{3.766523084124572*^9, 
  3.7665230894198265`*^9}},ExpressionUUID->"2cf1b9f8-6207-4ef8-9bb1-\
e72fb706d8c5"],

Cell[CellGroupData[{

Cell["\<\
Generates the output-state density matrix of the 15-to-1 protocol\
\>", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.764798548319666*^9, 
  3.764798559642825*^9}},ExpressionUUID->"cf4077be-3b48-4490-bdaa-\
3655940f326c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"OneLevel15to1", "[", 
   RowBox[{"pphys_", ",", "dx_", ",", "dz_", ",", "dm_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"output", ",", "px", ",", "pz", ",", "pm"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Introduce", " ", "shorthand", " ", "notation", " ", "for", " ", 
      "logical", " ", "error", " ", "rate", " ", "with", " ", "distances", 
      " ", 
      RowBox[{
       RowBox[{"dx", "/", "dz"}], "/", "dm"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"px", "=", 
      RowBox[{"plog", "[", 
       RowBox[{"pphys", ",", "dx"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pz", "=", 
      RowBox[{"plog", "[", 
       RowBox[{"pphys", ",", "dz"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pm", "=", 
      RowBox[{"plog", "[", 
       RowBox[{"pphys", ",", "dm"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "1", " ", "of", " ", "15"}], "-", "to", "-", 
       RowBox[{
       "1", " ", "protocol", " ", "applying", " ", "rotations", " ", "1"}], 
       "-", 
       RowBox[{"3", " ", "and", " ", "5"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"Init5Qubit", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "z", ",", "one", ",", "one", ",", "one"}], "}"}],
         ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox["dm", "dz"], "pz", " ", "dm"}]}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "dz", " ", "pm"}]}], ",", 
        RowBox[{"pphys", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "z", ",", "one", ",", "one"}], "}"}],
         ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox["dm", "dz"], "pz", " ", "dm"}]}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "dz", " ", "pm"}]}], ",", 
        RowBox[{"pphys", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "one", ",", "z", ",", "one"}], "}"}],
         ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox["dm", "dz"], "pz", " ", "dm"}]}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "dz", " ", "pm"}]}], ",", 
        RowBox[{"pphys", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "z", ",", "z", ",", "z", ",", "one"}], "}"}], 
        ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}]}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{"3", "dz", "*", "dx"}], "dm"], " ", "pm"}]}], ",", 
        RowBox[{"pphys", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "dm", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"output", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", "0"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"output", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", "0"}], "]"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "2"}], ":", " ", 
       RowBox[{
        RowBox[{"apply", " ", "rotations", " ", "6"}], "-", "7"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Last", " ", 
       RowBox[{"operation", ":", " ", 
        RowBox[{
         RowBox[{
         "apply", " ", "addditional", " ", "storage", " ", "errors", " ", 
          "to", " ", "qubit", " ", "1", " ", "due", " ", "to", " ", "multi"}],
          "-", 
         RowBox[{"patch", " ", "measurements"}]}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "z", ",", "z", ",", "one", ",", "one"}], "}"}], 
        ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}]}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx", "+", 
              RowBox[{"2", "dz"}]}], ")"}], "*", "dx"}], "dm"], " ", "pm"}]}],
         ",", 
        RowBox[{"pphys", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "z", ",", "one", ",", "z", ",", "one"}], "}"}], 
        ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}]}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx", "+", 
              RowBox[{"3", "dz"}]}], ")"}], "*", "dx"}], "dm"], " ", "pm"}]}],
         ",", 
        RowBox[{"pphys", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"dx", "+", 
             RowBox[{"2", "dz"}]}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{"dx", "+", 
             RowBox[{"3", "dz"}]}], ")"}]}], "dx"], "px", " ", "dm"}], ",", 
        "0", ",", "0", ",", "0", ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "dm", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", "0"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", "0"}], "]"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "3"}], ":", " ", 
       RowBox[{
        RowBox[{"apply", " ", "rotation", " ", "4", " ", "and", " ", "8"}], 
        "-", "9"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "one", ",", "z", ",", "z", ",", "one"}], "}"}], 
        ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}]}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx", "+", 
              RowBox[{"3", "dz"}]}], ")"}], "*", "dx"}], "dm"], " ", "pm"}]}],
         ",", 
        RowBox[{"pphys", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "one", ",", "one", ",", "z", ",", "z"}], "}"}], 
        ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}]}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx", "+", 
              RowBox[{"4", "dz"}]}], ")"}], "*", "dx"}], "dm"], " ", "pm"}]}],
         ",", 
        RowBox[{"pphys", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "one", ",", "one", ",", "z"}], "}"}],
         ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox["dm", "dz"], "pz", " ", "dm"}]}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "dz", " ", "pm"}]}], ",", 
        RowBox[{"pphys", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"dx", "+", 
             RowBox[{"3", "dz"}]}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{"dx", "+", 
             RowBox[{"4", "dz"}]}], ")"}]}], "dx"], "px", " ", "dm"}], ",", 
        "0", ",", "0", ",", "0", ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "dm", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "4"}], ":", " ", 
       RowBox[{
        RowBox[{"apply", " ", "rotations", " ", "10"}], "-", "11"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "z", ",", "one", ",", "one", ",", "z"}], "}"}], 
        ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}]}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx", "+", 
              RowBox[{"4", "dz"}]}], ")"}], "*", "dx"}], "dm"], " ", "pm"}]}],
         ",", 
        RowBox[{"pphys", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "one", ",", "z", ",", "one", ",", "z"}], "}"}], 
        ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}]}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx", "+", 
              RowBox[{"4", "dz"}]}], ")"}], "*", "dx"}], "dm"], " ", "pm"}]}],
         ",", 
        RowBox[{"pphys", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"dx", "+", 
             RowBox[{"4", "dz"}]}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{"dx", "+", 
             RowBox[{"4", "dz"}]}], ")"}]}], "dx"], "px", " ", "dm"}], ",", 
        "0", ",", "0", ",", "0", ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "dm", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "5"}], ":", " ", 
       RowBox[{
        RowBox[{"apply", " ", "rotations", " ", "12"}], "-", "13"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "z", ",", "z", ",", "z", ",", "z"}], "}"}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}]}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx", "+", 
              RowBox[{"4", "dz"}]}], ")"}], "*", "dx"}], "dm"], " ", "pm"}]}],
         ",", 
        RowBox[{"pphys", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "z", ",", "z", ",", "z"}], "}"}], 
        ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}]}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"3", "dz"}], ")"}], "*", "dx"}], "dm"], " ", "pm"}]}], 
        ",", 
        RowBox[{"pphys", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"dx", "+", 
            RowBox[{"4", "dz"}]}], ")"}], "dx"], "px", " ", "dm"}], ",", "0", 
        ",", "0", ",", "0", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "dm", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Qubit", " ", "1", " ", "is", " ", "consumed", " ", "as", " ", "an", 
       " ", "output", " ", 
       RowBox[{"state", ":", " ", 
        RowBox[{
        "additional", " ", "storage", " ", "errors", " ", "for", " ", "dx", 
         " ", "code", " ", "cycles"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], "px", " ", 
         RowBox[{"(", 
          RowBox[{"dm", "+", 
           RowBox[{"2", "dx"}]}], ")"}]}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], "px", " ", 
         RowBox[{"(", 
          RowBox[{"dm", "+", 
           RowBox[{"2", "dx"}]}], ")"}]}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "6"}], ":", " ", 
       RowBox[{
        RowBox[{"apply", " ", "rotation", " ", "14"}], "-", "15"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "z", ",", "one", ",", "z", ",", "z"}], "}"}], 
        ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}]}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"4", "dz"}], ")"}], "*", "dx"}], "dm"], " ", "pm"}]}], 
        ",", 
        RowBox[{"pphys", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "z", ",", "z", ",", "one", ",", "z"}], "}"}], 
        ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}]}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"4", "dz"}], ")"}], "*", "dx"}], "dm"], " ", "pm"}]}], 
        ",", 
        RowBox[{"pphys", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "dm", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"output", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"output", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "output"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7647802407276225`*^9, 3.7647804207083793`*^9}, {
   3.76478045272071*^9, 3.7647805759571714`*^9}, {3.7647806425971437`*^9, 
   3.7647808447829924`*^9}, {3.76479017485603*^9, 3.764790181976259*^9}, {
   3.7647985735332627`*^9, 3.764798704847616*^9}, {3.765640313382701*^9, 
   3.7656403661010776`*^9}, {3.765640462295044*^9, 3.7656404649865856`*^9}, {
   3.765640621364069*^9, 3.765640622166213*^9}, {3.7656586262733164`*^9, 
   3.7656586332236032`*^9}, {3.765663100102337*^9, 3.765663135581234*^9}, {
   3.7656632108747864`*^9, 3.765663393065422*^9}, {3.7657191500215445`*^9, 
   3.76571915038243*^9}, {3.7657191861537237`*^9, 3.765719482437769*^9}, {
   3.7657198962333565`*^9, 3.765719945585207*^9}, 3.765720160986723*^9, {
   3.7657387756711273`*^9, 3.7657387838755445`*^9}, {3.766008204239706*^9, 
   3.766008286676036*^9}, 3.7660871888203983`*^9, {3.7660876608248386`*^9, 
   3.7660877156676483`*^9}, {3.7660877941526146`*^9, 3.766087809079663*^9}, {
   3.7660878572966704`*^9, 3.7660879684617977`*^9}, {3.7660880722403755`*^9, 
   3.766088131243804*^9}, {3.766088188335867*^9, 3.766088307512337*^9}, {
   3.7660883407952995`*^9, 3.766088372338836*^9}, {3.766088452409278*^9, 
   3.766088454977426*^9}, {3.7660885067832413`*^9, 3.7660885633664722`*^9}, {
   3.766088594949997*^9, 3.7660885983198805`*^9}, {3.7660886320956755`*^9, 
   3.766088655667858*^9}, {3.7660890705552425`*^9, 3.7660892281169806`*^9}, {
   3.766095657942374*^9, 3.7660956616298227`*^9}, {3.7660974606323366`*^9, 
   3.7660974886648693`*^9}, {3.7660975236643744`*^9, 3.766097555556326*^9}, {
   3.7660976038525143`*^9, 3.7660976353382397`*^9}, {3.766097668948866*^9, 
   3.766097702667136*^9}, {3.7660979317957473`*^9, 3.766097934686331*^9}, {
   3.7660979783736906`*^9, 3.7660980211871815`*^9}, {3.7660981132983246`*^9, 
   3.766098132064804*^9}, {3.766098207676673*^9, 3.7660982659126797`*^9}, {
   3.7660984187751117`*^9, 3.766098466134986*^9}, {3.7660985328394876`*^9, 
   3.7660985512307234`*^9}, {3.7661388807210283`*^9, 3.766139019462062*^9}, {
   3.7661808830321636`*^9, 3.766180884389025*^9}, {3.7662419847148685`*^9, 
   3.7662419874648304`*^9}, {3.7662420757178087`*^9, 3.766242078450493*^9}, {
   3.766391843810644*^9, 3.7663918472168536`*^9}, {3.766428839697749*^9, 
   3.7664288814003725`*^9}, {3.7664974824201365`*^9, 3.76649760150973*^9}, {
   3.766518566207036*^9, 3.766518622308543*^9}, {3.7665190152790356`*^9, 
   3.7665190200154743`*^9}, {3.7665190628303614`*^9, 
   3.7665192154390574`*^9}, {3.7665192467217455`*^9, 3.766519524963029*^9}, {
   3.7667048996818542`*^9, 3.7667050690780067`*^9}, 3.7667051654932823`*^9, {
   3.766705911275668*^9, 3.766705922789151*^9}, 3.7667071983845363`*^9, {
   3.772299194841585*^9, 3.7722992318333397`*^9}, {3.7722992770504417`*^9, 
   3.7722992842611923`*^9}, {3.7722993781287317`*^9, 3.772299389243676*^9}, {
   3.772299425979142*^9, 3.7722995250909777`*^9}, {3.772299584906498*^9, 
   3.772299772995494*^9}, {3.772751311620438*^9, 3.7727513203866644`*^9}, 
   3.772918510386821*^9, {3.772970668622929*^9, 3.7729706896330357`*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"b909ae9e-36fe-4f24-9c65-d4e05336a134"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Calculates the output error and space-time cost of the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"(", 
     RowBox[{"15", "-", "to", "-", "1"}], ")"}], 
    RowBox[{
     SubscriptBox["d", "x"], ",", " ", 
     SubscriptBox["d", "z"], ",", " ", 
     SubscriptBox["d", "m"]}]], TraditionalForm]],ExpressionUUID->
  "482efb54-9154-4179-9f29-f245d586b8a1"],
 " protocol with a physical error rate ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["p", "phys"], TraditionalForm]],ExpressionUUID->
  "cb37d4ed-0f12-44f3-9999-6c842ad72a13"],
 "."
}], "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.764798548319666*^9, 3.764798559642825*^9}, {
   3.7647987276519747`*^9, 3.7647987320112915`*^9}, {3.764798772566616*^9, 
   3.7647988107091117`*^9}, {3.7647988766983724`*^9, 3.764798892262065*^9}, 
   3.764798925821597*^9, {3.766705274335498*^9, 
   3.7667052747353644`*^9}},ExpressionUUID->"4b4a6f57-2631-4851-8f13-\
3a7b4f2b2589"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CostOfOneLevel15to1", "[", 
   RowBox[{"pphys_", ",", "dx_", ",", "dz_", ",", "dm_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "out", ",", "OutPostSel", ",", "pout", ",", "pfail", ",", "reqdist1", 
      ",", "reqdist2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", "  ", 
     RowBox[{
      RowBox[{"Generate", " ", "output", " ", "state", " ", "of", " ", "15"}],
       "-", "to", "-", 
      RowBox[{"1", " ", "protocol"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"out", "=", 
      RowBox[{"OneLevel15to1", "[", 
       RowBox[{"pphys", ",", "dx", ",", "dz", ",", "dm"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "Compute", " ", "failure", " ", "probability", " ", "as", " ", "the", 
         " ", "probability", " ", "to", " ", "measure", " ", "qubits", " ", 
         "2"}], "-", 
        RowBox[{"5", " ", "in", " ", "the"}]}], "|", 
       RowBox[{"+", 
        RowBox[{">", " ", "state"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pfail", "=", 
      RowBox[{"Re", "[", 
       RowBox[{"1", "-", 
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{
           "one", ",", "ProjX", ",", "ProjX", ",", "ProjX", ",", "ProjX"}], 
           "]"}], ".", "out"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "Compute", " ", "the", " ", "density", " ", "matrix", " ", "of", " ", 
         "the", " ", "post"}], "-", 
        RowBox[{"selected", " ", "output", " ", "state"}]}], ",", " ", 
       RowBox[{"i", ".", "e", "."}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"after", " ", "projecting", " ", "qubits", " ", "2"}], "-", 
         RowBox[{"5", " ", "into"}]}], " ", "|", 
        RowBox[{"+", ">"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"OutPostSel", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", "pfail"}]], 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
         "one", ",", "ProjX", ",", "ProjX", ",", "ProjX", ",", "ProjX"}], 
         "]"}], ".", "out", ".", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{
          "one", ",", "ProjX", ",", "ProjX", ",", "ProjX", ",", "ProjX"}], 
          "]"}], "\[HermitianConjugate]"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Compute", " ", "output", " ", "error", " ", "from", " ", "the", " ", 
        "infidelity", " ", "between", " ", "the", " ", "post"}], "-", 
       RowBox[{
       "selected", " ", "state", " ", "and", " ", "the", " ", "ideal", " ", 
        "output", " ", "state"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pout", "=", 
      RowBox[{"Re", "[", 
       RowBox[{"1", "-", 
        RowBox[{"Tr", "[", 
         RowBox[{"OutPostSel", ".", "Ideal15to1"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Full", "-", 
       RowBox[{"distance", " ", 
        RowBox[{"computation", ":", " ", 
         RowBox[{
          RowBox[{
          "determine", " ", "full", " ", "distance", " ", "required", " ", 
           "for", " ", "a", " ", "100"}], "-", 
          RowBox[{"qubit", "/", "10000"}], "-", 
          RowBox[{"qubit", " ", "computation"}]}]}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"reqdist1", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Round", "[", 
          RowBox[{"d", ",", "2"}], "]"}], "+", "1"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"Quiet", "[", 
         RowBox[{"Solve", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"231.", "/", "pout"}], "*", "d", "*", 
              RowBox[{"plog", "[", 
               RowBox[{"pphys", ",", "d"}], "]"}]}], "\[Equal]", "0.01"}], 
            ",", 
            RowBox[{"d", ">", "1"}]}], "}"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"reqdist2", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Round", "[", 
          RowBox[{"d", ",", "2"}], "]"}], "+", "1"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"Quiet", "[", 
         RowBox[{"Solve", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"20284.", "/", "pout"}], "*", "d", "*", 
              RowBox[{"plog", "[", 
               RowBox[{"pphys", ",", "d"}], "]"}]}], "\[Equal]", "0.01"}], 
            ",", 
            RowBox[{"d", ">", "1"}]}], "}"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Print", " ", "output", " ", "error"}], ",", " ", 
       RowBox[{"failure", " ", "probability"}], ",", " ", 
       RowBox[{"space", " ", "cost"}], ",", " ", 
       RowBox[{
        RowBox[{"time", " ", "cost", " ", "and", " ", "space"}], "-", 
        RowBox[{"time", " ", "cost"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<(15-to-1\!\(\*SubscriptBox[\()\), \(`1`, `2`, `3`\)]\) with \
\!\(\*SubscriptBox[\(p\), \(phys\)]\)=`4`, \!\(\*SubscriptBox[\(d\), \
\(x\)]\)=`1`, \!\(\*SubscriptBox[\(d\), \(z\)]\)=`2` and \
\!\(\*SubscriptBox[\(d\), \(m\)]\)=`3`\>\"", ",", "dx", ",", "dz", ",", "dm", 
        ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{"N", "[", "pphys", "]"}], "]"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<Output error: \!\(\*SubscriptBox[\(p\), \(out\)]\) = `1`\>\"", 
        ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{"pout", ",", "4"}], "]"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<Failure probability: \!\(\*SubscriptBox[\(p\), \(fail\)]\) = \
`1`\>\"", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{"pfail", ",", "4"}], "]"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{"\"\<Space cost: `1` qubits\>\"", ",", 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", "dx", 
            RowBox[{"(", 
             RowBox[{"dx", "+", 
              RowBox[{"4", "dz"}]}], ")"}]}], "+", 
           RowBox[{"2", "dm"}]}], ")"}]}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{"\"\<Time cost: `1` code cycles\>\"", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{
          RowBox[{"6", 
           RowBox[{"dm", "/", 
            RowBox[{"(", 
             RowBox[{"1", "-", "pfail"}], ")"}]}]}], ",", "4"}], "]"}]}], 
       "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{"\"\<Spacetime cost: `1` qubitcycles\>\"", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", "dx", 
              RowBox[{"(", 
               RowBox[{"dx", "+", 
                RowBox[{"4", "dz"}]}], ")"}]}], "+", 
             RowBox[{"2", "dm"}]}], ")"}], "6", 
           RowBox[{"dm", "/", 
            RowBox[{"(", 
             RowBox[{"1", "-", "pfail"}], ")"}]}]}], ",", "4"}], "]"}]}], 
       "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<For a 100-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \
\(3\)]\) (d=`2`)\>\"", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", "dx", 
              RowBox[{"(", 
               RowBox[{"dx", "+", 
                RowBox[{"4", "dz"}]}], ")"}]}], "+", 
             RowBox[{"2", "dm"}]}], ")"}], "6", 
           RowBox[{
            RowBox[{"dm", "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", "pfail"}], ")"}]}], "/", 
            SuperscriptBox["reqdist1", "3"]}]}], ",", "4"}], "]"}], ",", 
        "reqdist1"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<For a 10000-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\
\)]\) (d=`2`)\>\"", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", "dx", 
              RowBox[{"(", 
               RowBox[{"dx", "+", 
                RowBox[{"4", "dz"}]}], ")"}]}], "+", 
             RowBox[{"2", "dm"}]}], ")"}], "6", 
           RowBox[{
            RowBox[{"dm", "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", "pfail"}], ")"}]}], "/", 
            SuperscriptBox["reqdist2", "3"]}]}], ",", "4"}], "]"}], ",", 
        "reqdist2"}], "]"}], "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7647808485660877`*^9, 3.764781121485984*^9}, {
   3.7647812244214864`*^9, 3.7647814176780906`*^9}, {3.7647814513813167`*^9, 
   3.7647814662906294`*^9}, {3.7647815181881695`*^9, 
   3.7647816382576275`*^9}, {3.7647816701464195`*^9, 3.764781868705923*^9}, {
   3.764788957175082*^9, 3.764789010183885*^9}, {3.764798826680689*^9, 
   3.7647988333837247`*^9}, 3.7649446427537518`*^9, {3.764944793232644*^9, 
   3.764944796952179*^9}, {3.764944875011983*^9, 3.7649448776316986`*^9}, {
   3.765105822418619*^9, 3.7651058226373644`*^9}, {3.765409912658734*^9, 
   3.765409914361842*^9}, {3.7654099848786616`*^9, 3.7654099908942127`*^9}, {
   3.765719486026596*^9, 3.7657195804876823`*^9}, {3.765719633010495*^9, 
   3.765719654503462*^9}, {3.765724261946707*^9, 3.7657242660873556`*^9}, {
   3.7657243168577394`*^9, 3.7657243169757023`*^9}, {3.7657403726625185`*^9, 
   3.765740379352043*^9}, {3.7657404095698957`*^9, 3.76574041904922*^9}, {
   3.7657405675836535`*^9, 3.7657405683785963`*^9}, {3.76574078102347*^9, 
   3.765740781498436*^9}, {3.766008294488429*^9, 3.7660083045664067`*^9}, 
   3.7660886711577196`*^9, {3.7660982850842876`*^9, 3.7660982903342133`*^9}, {
   3.766139026541629*^9, 3.7661390398828115`*^9}, {3.7662472578710856`*^9, 
   3.7662472597148104`*^9}, 3.766248605805954*^9, 3.766248644618353*^9, {
   3.7665198291047754`*^9, 3.766519844164812*^9}, {3.766703958212303*^9, 
   3.766703972188796*^9}, {3.766704094018799*^9, 3.7667041517928905`*^9}, {
   3.7667050907246447`*^9, 3.766705194167454*^9}, {3.7667053304407926`*^9, 
   3.7667053307846775`*^9}, {3.772299823901974*^9, 3.772299858722703*^9}, {
   3.772810613334372*^9, 3.772810625382041*^9}, {3.7728913693619432`*^9, 
   3.7728913832227273`*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"92310ae5-d95b-40eb-bef5-476929887f1b"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["(15-to-1)\[Times](15-to-1) protocol", "Title",
 InitializationCell->True,
 CellChangeTimes->{{3.766523084124572*^9, 3.7665230894198265`*^9}, {
  3.7665231201077113`*^9, 
  3.7665231263246613`*^9}},ExpressionUUID->"16af40d5-7719-4dfa-9552-\
ab3062ed2075"],

Cell[CellGroupData[{

Cell[TextData[{
 "Calculates the output error and space-time cost of the (15-to-",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    SuperscriptBox[
     RowBox[{"1", ")"}], 
     SubscriptBox["n", "L1"]], 
    RowBox[{
     SubscriptBox["d", "x"], ",", "  ", 
     SubscriptBox["d", "z"], ",", "  ", 
     SubscriptBox["d", "m"]}]], TraditionalForm]],ExpressionUUID->
  "820cdb7d-b036-44f6-a068-ddba5181d175"],
 "\[Times](15-to-1",
 Cell[BoxData[
  FormBox[
   SubscriptBox[")", 
    RowBox[{
     SubscriptBox["d", "X2"], ",", " ", 
     SubscriptBox["d", "Z2"], ",", " ", 
     SubscriptBox["d", "m2"]}]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "e84f95de-9961-4374-9c8e-d8468efa0175"],
 " protocol with a physical error rate ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["p", "phys"], TraditionalForm]],ExpressionUUID->
  "c7433a77-0716-4f14-a95c-ba49e5b6816d"],
 "."
}], "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.764798548319666*^9, 3.764798559642825*^9}, {
   3.7647987276519747`*^9, 3.7647987320112915`*^9}, {3.764798772566616*^9, 
   3.7647988107091117`*^9}, {3.7647988766983724`*^9, 3.764798892262065*^9}, 
   3.764798925821597*^9, {3.766705259168877*^9, 3.766705268657409*^9}, {
   3.766705339047531*^9, 
   3.7667053819828215`*^9}},ExpressionUUID->"865670e1-1850-4537-a572-\
5d54955a35f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CostOfTwoLevel15to1", "[", 
   RowBox[{
   "pphys_", ",", "dx_", ",", "dz_", ",", "dm_", ",", "dx2_", ",", "dz2_", 
    ",", "dm2_", ",", "nl1_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "out", ",", "out2", ",", "OutPostSel", ",", "OutPostSel2", ",", "pl1", 
      ",", "pout", ",", "l1time", ",", "ncycles", ",", "lmove", ",", "pfail", 
      ",", "pfail2", ",", "reqdist1", ",", "reqdist2", ",", "px2", ",", "pz2",
       ",", "pm2"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Introduce", " ", "shorthand", " ", "notation", " ", "for", " ", 
      "logical", " ", "error", " ", "rate", " ", "with", " ", "distances", 
      " ", 
      RowBox[{
       RowBox[{"dx2", "/", "dz2"}], "/", "dm2"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"px2", "=", 
      RowBox[{"plog", "[", 
       RowBox[{"pphys", ",", "dx2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pz2", "=", 
      RowBox[{"plog", "[", 
       RowBox[{"pphys", ",", "dz2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pm2", "=", 
      RowBox[{"plog", "[", 
       RowBox[{"pphys", ",", "dm2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Compute", " ", "pl1"}], ",", 
       RowBox[{
        RowBox[{"the", " ", "output", " ", "error", " ", "of", " ", "level"}],
         "-", 
        RowBox[{"1", " ", "states"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out", "=", 
      RowBox[{"OneLevel15to1", "[", 
       RowBox[{"pphys", ",", "dx", ",", "dz", ",", "dm"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pfail", "=", 
      RowBox[{"Re", "[", 
       RowBox[{"1", "-", 
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{
           "one", ",", "ProjX", ",", "ProjX", ",", "ProjX", ",", "ProjX"}], 
           "]"}], ".", "out"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"OutPostSel", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", "pfail"}]], 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
         "one", ",", "ProjX", ",", "ProjX", ",", "ProjX", ",", "ProjX"}], 
         "]"}], ".", "out", ".", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{
          "one", ",", "ProjX", ",", "ProjX", ",", "ProjX", ",", "ProjX"}], 
          "]"}], "\[HermitianConjugate]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pl1", "=", 
      RowBox[{"Rationalize", "[", 
       RowBox[{
        RowBox[{"Re", "[", 
         RowBox[{"1", "-", 
          RowBox[{"Tr", "[", 
           RowBox[{"OutPostSel", ".", "Ideal15to1"}], "]"}]}], "]"}], ",", 
        SuperscriptBox["10", 
         RowBox[{"-", "50"}]]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Compute", " ", "l1time"}], ",", 
       RowBox[{
        RowBox[{"the", " ", "speed", " ", "at", " ", "which", " ", "level"}], 
        "-", 
        RowBox[{
        "2", " ", "rotations", " ", "can", " ", "be", " ", "performed", " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["t", "L1"], " ", "in", " ", "the", " ", "paper"}], 
          ")"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"l1time", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"6", 
         RowBox[{
          RowBox[{"dm", "/", 
           RowBox[{"(", 
            RowBox[{"nl1", "/", "2"}], ")"}]}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", "pfail"}], ")"}]}]}], ",", "dm2"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"ncycles", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"15", "/", "2"}], ")"}], "*", "l1time"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Define", " ", "lmove"}], ",", 
       RowBox[{
        RowBox[{"the", " ", "effective", " ", "width"}], "-", 
        RowBox[{"dm2", " ", "region", " ", "a", " ", "level"}], "-", 
        RowBox[{
        "1", " ", "state", " ", "needs", " ", "to", " ", "traverse", " ", 
         "before", " ", "reaching", " ", "the", " ", "level"}], "-", 
        RowBox[{"2", " ", "block"}]}], ",", 
       RowBox[{
       "picking", " ", "up", " ", "additional", " ", "storage", " ", 
        "errors"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"lmove", "=", 
      RowBox[{
       RowBox[{"10", "dm2"}], "+", 
       RowBox[{
        RowBox[{"nl1", "/", "4"}], "*", 
        RowBox[{"(", 
         RowBox[{"dx", "+", 
          RowBox[{"4", "dz"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "1", " ", "of", " ", 
        RowBox[{"(", 
         RowBox[{"15", "-", "to", "-", "1"}], ")"}], "\[Times]", 
        RowBox[{"(", 
         RowBox[{"15", "-", "to", "-", "1"}], ")"}], " ", "protocol", " ", 
        "applying", " ", "rotations", " ", "1"}], "-", "2"}], " ", "*)"}], 
     " ", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"Init5Qubit", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "z", ",", "one", ",", "one", ",", "one"}], "}"}],
         ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx2", "+", "dz2", "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "z", ",", "one", ",", "one"}], "}"}],
         ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"out2", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", "0", ",", 
        "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", "0", ",", 
        "0"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "2"}], ":", " ", 
       RowBox[{
        RowBox[{"apply", " ", "rotations", " ", "3"}], "-", "4"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "one", ",", "z", ",", "one"}], "}"}],
         ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx2", "+", 
              RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "one", ",", "one", ",", "z"}], "}"}],
         ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dz2", "+", "dm2"}], ")"}], "dx2"}], "dm2"], "pm2"}]}], 
        ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"out2", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "3"}], ":", " ", 
       RowBox[{
        RowBox[{"apply", " ", "rotations", " ", "5"}], "-", "6"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Last", " ", 
       RowBox[{"operation", ":", " ", 
        RowBox[{
         RowBox[{
         "apply", " ", "addditional", " ", "storage", " ", "errors", " ", 
          "due", " ", "to", " ", "multi"}], "-", 
         RowBox[{"patch", " ", "measurements"}]}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "z", ",", "z", ",", "one", ",", "one"}], "}"}], 
        ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx2", "+", 
              RowBox[{"2", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "z", ",", "z", ",", "z", ",", "one"}], "}"}], 
        ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"dx2", "+", 
            RowBox[{"2", "dz2"}], "+", "dm2"}], ")"}], "dx2"], "px2", " ", 
         "dm2"}], ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "4"}], ":", " ", 
       RowBox[{
        RowBox[{"apply", " ", "rotations", " ", "7"}], "-", "8"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "one", ",", "z", ",", "z", ",", "one"}], "}"}], 
        ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx2", "+", 
              RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "z", ",", "one", ",", "z", ",", "one"}], "}"}], 
        ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx2", "+", 
              RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"dx2", "+", 
             RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{"dx2", "+", 
             RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}]}], "dx2"], "px2", " ", 
         "dm2"}], ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "5"}], ":", " ", 
       RowBox[{
        RowBox[{"apply", " ", "rotations", " ", "9"}], "-", "10"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "z", ",", "one", ",", "one", ",", "z"}], "}"}], 
        ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx2", "+", 
              RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "one", ",", "one", ",", "z", ",", "z"}], "}"}], 
        ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx2", "+", 
              RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"dx2", "+", 
             RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{"dx2", "+", 
             RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}]}], "dx2"], "px2", " ", 
         "dm2"}], ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "6"}], ":", " ", 
       RowBox[{
        RowBox[{"apply", " ", "rotations", " ", "11"}], "-", "12"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "one", ",", "z", ",", "one", ",", "z"}], "}"}], 
        ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx2", "+", 
              RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "z", ",", "z", ",", "z", ",", "z"}], "}"}], ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx2", "+", 
              RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"dx2", "+", 
             RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{"dx2", "+", 
             RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}]}], "dx2"], "px2", " ", 
         "dm2"}], ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "7"}], ":", " ", 
       RowBox[{
        RowBox[{"apply", " ", "rotations", " ", "13"}], "-", "14"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "z", ",", "one", ",", "z", ",", "z"}], "}"}], 
        ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx2", "+", 
              RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "z", ",", "z", ",", "z"}], "}"}], 
        ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"dx2", "+", 
            RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "dx2"], "px2", " ", 
         "dm2"}], ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Qubit", " ", "1", " ", "is", " ", "consumed", " ", "as", " ", "an", 
       " ", "output", " ", 
       RowBox[{"state", ":", " ", 
        RowBox[{
        "additional", " ", "storage", " ", "errors", " ", "for", " ", "dx2", 
         " ", "code", " ", "cycles"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"dm2", "+", 
           RowBox[{"2", "dx2"}]}], ")"}], "px2"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], " ", "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"dm2", "+", 
           RowBox[{"2", "dx2"}]}], ")"}], "px2"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "8"}], ":", " ", 
       RowBox[{"apply", " ", "rotation", " ", "15"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "z", ",", "z", ",", "one", ",", "z"}], "}"}], 
        ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"out2", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Compute", " ", "level"}], "-", 
        RowBox[{
        "2", " ", "failure", " ", "probability", " ", "as", " ", "the", " ", 
         "probability", " ", "to", " ", "measure", " ", "qubits", " ", "2"}], 
        "-", 
        RowBox[{"5", " ", "in", " ", "the"}]}], "|", 
       RowBox[{"+", 
        RowBox[{">", " ", "state"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pfail2", "=", 
      RowBox[{"Re", "[", 
       RowBox[{"1", "-", 
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{
           "one", ",", "ProjX", ",", "ProjX", ",", "ProjX", ",", "ProjX"}], 
           "]"}], ".", "out2"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "Compute", " ", "the", " ", "density", " ", "matrix", " ", "of", " ", 
         "the", " ", "post"}], "-", 
        RowBox[{"selected", " ", "output", " ", "state"}]}], ",", " ", 
       RowBox[{"i", ".", "e", "."}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"after", " ", "projecting", " ", "qubits", " ", "2"}], "-", 
         RowBox[{"5", " ", "into"}]}], " ", "|", 
        RowBox[{"+", ">"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"OutPostSel2", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", "pfail2"}]], 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
         "one", ",", "ProjX", ",", "ProjX", ",", "ProjX", ",", "ProjX"}], 
         "]"}], ".", "out2", ".", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{
          "one", ",", "ProjX", ",", "ProjX", ",", "ProjX", ",", "ProjX"}], 
          "]"}], "\[HermitianConjugate]"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Compute", " ", "level"}], "-", 
       RowBox[{
       "2", " ", "output", " ", "error", " ", "from", " ", "the", " ", 
        "infidelity", " ", "between", " ", "the", " ", "post"}], "-", 
       RowBox[{
       "selected", " ", "state", " ", "and", " ", "the", " ", "ideal", " ", 
        "output", " ", "state"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pout", "=", 
      RowBox[{"Re", "[", 
       RowBox[{"1", "-", 
        RowBox[{"Tr", "[", 
         RowBox[{"OutPostSel2", ".", "Ideal15to1"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Full", "-", 
       RowBox[{"distance", " ", 
        RowBox[{"computation", ":", " ", 
         RowBox[{
          RowBox[{
          "determine", " ", "full", " ", "distance", " ", "required", " ", 
           "for", " ", "a", " ", "100"}], "-", 
          RowBox[{"qubit", "/", "10000"}], "-", 
          RowBox[{"qubit", " ", "computation"}]}]}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"reqdist1", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Round", "[", 
          RowBox[{"d", ",", "2"}], "]"}], "+", "1"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"Quiet", "[", 
         RowBox[{"Solve", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"231.", "/", "pout"}], "*", "d", "*", 
              RowBox[{"plog", "[", 
               RowBox[{"pphys", ",", "d"}], "]"}]}], "\[Equal]", "0.01"}], 
            ",", 
            RowBox[{"d", ">", "1"}]}], "}"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"reqdist2", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Round", "[", 
          RowBox[{"d", ",", "2"}], "]"}], "+", "1"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"Quiet", "[", 
         RowBox[{"Solve", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"20284.", "/", "pout"}], "*", "d", "*", 
              RowBox[{"plog", "[", 
               RowBox[{"pphys", ",", "d"}], "]"}]}], "\[Equal]", "0.01"}], 
            ",", 
            RowBox[{"d", ">", "1"}]}], "}"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Print", " ", "output", " ", "error"}], ",", " ", 
       RowBox[{"failure", " ", "probability"}], ",", " ", 
       RowBox[{"space", " ", "cost"}], ",", " ", 
       RowBox[{
        RowBox[{"time", " ", "cost", " ", "and", " ", "space"}], "-", 
        RowBox[{"time", " ", "cost"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<(15-to-1\!\(\*SubscriptBox[SuperscriptBox[\()\), \(`7`\)], \(`1`, \
`2`, `3`\)]\)\[Times](15-to-1\!\(\*SubscriptBox[\()\), \(`4`, `5`, `6`\)]\) \
with \!\(\*SubscriptBox[\(p\), \(phys\)]\)=`8`, \!\(\*SubscriptBox[\(d\), \(x\
\)]\)=`1`, \!\(\*SubscriptBox[\(d\), \(z\)]\)=`2`, \!\(\*SubscriptBox[\(d\), \
\(m\)]\)=`3`, \!\(\*SubscriptBox[\(d\), \(x2\)]\)=`4`, \!\(\*SubscriptBox[\(d\
\), \(z2\)]\)=`5`, \!\(\*SubscriptBox[\(d\), \(m2\)]\)=`6` and \
\!\(\*SubscriptBox[\(n\), \(L1\)]\)=`7`\>\"", ",", "dx", ",", "dz", ",", "dm",
         ",", "dx2", ",", "dz2", ",", "dm2", ",", "nl1", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{"N", "[", "pphys", "]"}], "]"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<Output error: \!\(\*SubscriptBox[\(p\), \(out\)]\) = `1`\>\"", 
        ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{"pout", ",", "4"}], "]"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<Failure probability: \!\(\*SubscriptBox[\(p\), \(fail\)]\) = \
`1`\>\"", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{"pfail2", ",", "4"}], "]"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{"\"\<Space cost: `1` qubits\>\"", ",", 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", "dx2", 
            RowBox[{"(", 
             RowBox[{"dx2", "+", 
              RowBox[{"4", "dz2"}]}], ")"}]}], "+", 
           RowBox[{"2", "dx2", " ", "dm2"}], "+", 
           RowBox[{"20", 
            SuperscriptBox["dm2", "2"]}], "+", 
           RowBox[{
            RowBox[{"nl1", "/", "2"}], " ", "dm2", 
            RowBox[{"(", 
             RowBox[{"dx", "+", 
              RowBox[{"4", "dz"}]}], ")"}]}], "+", 
           RowBox[{"nl1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", "dx", 
               RowBox[{"(", 
                RowBox[{"dx", "+", 
                 RowBox[{"4", "dz"}]}], ")"}]}], "+", 
              RowBox[{"2", "dm"}]}], ")"}]}]}], ")"}]}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{"\"\<Time cost: `1` code cycles\>\"", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"ncycles", "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", "pfail2"}], ")"}]}], ",", "4"}], "]"}], ",", 
          "4"}], "]"}]}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{"\"\<Spacetime cost: `1` qubitcycles\>\"", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{
          RowBox[{"2", "*", "ncycles", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", "dx2", 
               RowBox[{"(", 
                RowBox[{"dx2", "+", 
                 RowBox[{"4", "dz2"}]}], ")"}]}], "+", 
              RowBox[{"2", "dx2", " ", "dm2"}], "+", 
              RowBox[{"20", 
               SuperscriptBox["dm2", "2"]}], "+", 
              RowBox[{
               RowBox[{"nl1", "/", "2"}], " ", "dm2", 
               RowBox[{"(", 
                RowBox[{"dx", "+", 
                 RowBox[{"4", "dz"}]}], ")"}]}], "+", 
              RowBox[{"nl1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"3", "dx", 
                  RowBox[{"(", 
                   RowBox[{"dx", "+", 
                    RowBox[{"4", "dz"}]}], ")"}]}], "+", 
                 RowBox[{"2", "dm"}]}], ")"}]}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"1", "-", "pfail2"}], ")"}]}]}], ",", "4"}], "]"}]}], 
       "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<For a 100-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \
\(3\)]\) (d=`2`)\>\"", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{
          RowBox[{"ncycles", "*", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", "dx2", 
                RowBox[{"(", 
                 RowBox[{"dx2", "+", 
                  RowBox[{"4", "dz2"}]}], ")"}]}], "+", 
               RowBox[{"2", "dx2", " ", "dm2"}], "+", 
               RowBox[{"20", 
                SuperscriptBox["dm2", "2"]}], "+", 
               RowBox[{
                RowBox[{"nl1", "/", "2"}], " ", "dm2", 
                RowBox[{"(", 
                 RowBox[{"dx", "+", 
                  RowBox[{"4", "dz"}]}], ")"}]}], "+", 
               RowBox[{"nl1", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", "dx", 
                   RowBox[{"(", 
                    RowBox[{"dx", "+", 
                    RowBox[{"4", "dz"}]}], ")"}]}], "+", 
                  RowBox[{"2", "dm"}]}], ")"}]}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", "pfail2"}], ")"}]}], "/", 
            SuperscriptBox["reqdist1", "3"]}]}], ",", "4"}], "]"}], ",", 
        "reqdist1"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<For a 10000-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\
\)]\) (d=`2`)\>\"", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{
          RowBox[{"ncycles", "*", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", "dx2", 
                RowBox[{"(", 
                 RowBox[{"dx2", "+", 
                  RowBox[{"4", "dz2"}]}], ")"}]}], "+", 
               RowBox[{"2", "dx2", " ", "dm2"}], "+", 
               RowBox[{"20", 
                SuperscriptBox["dm2", "2"]}], "+", 
               RowBox[{
                RowBox[{"nl1", "/", "2"}], " ", "dm2", 
                RowBox[{"(", 
                 RowBox[{"dx", "+", 
                  RowBox[{"4", "dz"}]}], ")"}]}], "+", 
               RowBox[{"nl1", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", "dx", 
                   RowBox[{"(", 
                    RowBox[{"dx", "+", 
                    RowBox[{"4", "dz"}]}], ")"}]}], "+", 
                  RowBox[{"2", "dm"}]}], ")"}]}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", "pfail2"}], ")"}]}], "/", 
            SuperscriptBox["reqdist2", "3"]}]}], ",", "4"}], "]"}], ",", 
        "reqdist2"}], "]"}], "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7647818804197054`*^9, 3.7647827170147686`*^9}, {
   3.7647827526955023`*^9, 3.7647828037704153`*^9}, {3.7647828777323666`*^9, 
   3.7647828873914766`*^9}, {3.7647829679315805`*^9, 
   3.7647829900869355`*^9}, {3.7647871135993786`*^9, 
   3.7647871181582265`*^9}, {3.764787190717695*^9, 3.764787200944683*^9}, {
   3.7647873644636497`*^9, 3.764787367155138*^9}, 3.7647890235126734`*^9, {
   3.7647909296701856`*^9, 3.7647909529318037`*^9}, {3.7647909938776417`*^9, 
   3.7647910266716385`*^9}, {3.764792654171276*^9, 3.764792683882779*^9}, 
   3.764792718552117*^9, {3.764798953239451*^9, 3.7647990013518887`*^9}, {
   3.7649446563237267`*^9, 3.7649446627240024`*^9}, {3.7649448086121345`*^9, 
   3.76494482175257*^9}, {3.7649448836517706`*^9, 3.764944895551218*^9}, {
   3.765105828809168*^9, 3.765105829106036*^9}, {3.7654099265804377`*^9, 
   3.765409974456912*^9}, {3.7655179025619936`*^9, 3.7655179329190464`*^9}, {
   3.765518034563303*^9, 3.7655180824858165`*^9}, {3.765522264043847*^9, 
   3.7655222704840803`*^9}, {3.765720931023732*^9, 3.7657210086913185`*^9}, {
   3.7657210860919886`*^9, 3.7657210955908823`*^9}, {3.7657211268546515`*^9, 
   3.7657211568058505`*^9}, {3.7657214462471323`*^9, 3.765721453225848*^9}, {
   3.7657217641451077`*^9, 3.765721787384503*^9}, {3.7657218226869507`*^9, 
   3.765721844285879*^9}, {3.765721979927496*^9, 3.7657221507715845`*^9}, {
   3.7657221868507805`*^9, 3.7657223447121196`*^9}, {3.765722375843934*^9, 
   3.7657224224576793`*^9}, {3.7657224558337574`*^9, 
   3.7657225048227277`*^9}, {3.7657226368765144`*^9, 3.7657226399755*^9}, {
   3.7657226859904428`*^9, 3.7657226891114197`*^9}, {3.7657228154870634`*^9, 
   3.7657228230505915`*^9}, {3.76572299427556*^9, 3.765722997455518*^9}, {
   3.7657230973398333`*^9, 3.76572309930519*^9}, {3.765723141117487*^9, 
   3.7657232666743975`*^9}, {3.7657242834336734`*^9, 
   3.7657242848152246`*^9}, {3.7657243246102023`*^9, 3.76572432476615*^9}, {
   3.7657404744152803`*^9, 3.76574048244471*^9}, {3.765740612585455*^9, 
   3.7657406132904015`*^9}, {3.765740769119317*^9, 3.7657407697842703`*^9}, {
   3.766008476048359*^9, 3.766008534422531*^9}, {3.76600859029674*^9, 
   3.766008616218249*^9}, {3.7660987438906126`*^9, 3.7660987573909845`*^9}, {
   3.766098811720262*^9, 3.7660989076912527`*^9}, {3.7660989461288486`*^9, 
   3.7660989748165665`*^9}, {3.7660990077081776`*^9, 3.7660990131768503`*^9}, 
   3.766099052624571*^9, {3.7660990837178807`*^9, 3.7660990843272476`*^9}, {
   3.766169151958352*^9, 3.76616927101625*^9}, {3.766169302270108*^9, 
   3.766169331788019*^9}, {3.766175569456685*^9, 3.7661759116837015`*^9}, {
   3.7661759518616877`*^9, 3.7661761694902315`*^9}, {3.766176224531863*^9, 
   3.766176434692382*^9}, {3.7661765381919427`*^9, 3.7661766127795296`*^9}, {
   3.766176781114933*^9, 3.766176817462805*^9}, 3.7661768586452646`*^9, {
   3.7661780632281666`*^9, 3.766178065743758*^9}, {3.7661808979026413`*^9, 
   3.7661808994600325`*^9}, {3.766247336557528*^9, 3.7662473408387184`*^9}, {
   3.7662485410220985`*^9, 3.76624854200646*^9}, 3.766248608137231*^9, {
   3.7662641164773827`*^9, 3.766264148478401*^9}, {3.7662642098944197`*^9, 
   3.766264309764752*^9}, {3.7662645375634794`*^9, 3.76626455513062*^9}, {
   3.766264589098131*^9, 3.7662645912184305`*^9}, 3.7662647124545546`*^9, {
   3.7663562146131077`*^9, 3.76635623896808*^9}, {3.766356297910652*^9, 
   3.766356309201929*^9}, {3.766356423860138*^9, 3.7663564259304523`*^9}, {
   3.7663564577589607`*^9, 3.7663564581488314`*^9}, {3.7663564950436707`*^9, 
   3.766356517930125*^9}, {3.7663565524097605`*^9, 3.7663565798907013`*^9}, {
   3.766356638753299*^9, 3.766356653403469*^9}, {3.7663567292964535`*^9, 
   3.7663567915609303`*^9}, {3.766356883637577*^9, 3.766356884112421*^9}, {
   3.766356944689452*^9, 3.766356968890476*^9}, {3.7663916370285645`*^9, 
   3.7663916386222954`*^9}, {3.766401642066223*^9, 3.766401868554517*^9}, {
   3.7664020839648266`*^9, 3.766402084371072*^9}, {3.766402120011774*^9, 
   3.7664021378084345`*^9}, {3.766566732745285*^9, 3.766566747194762*^9}, {
   3.766566787410222*^9, 3.766566823874155*^9}, {3.7665669105491056`*^9, 
   3.766566997893481*^9}, {3.766661182701364*^9, 3.766661371732479*^9}, {
   3.7666614215450573`*^9, 3.7666619051676416`*^9}, {3.766691948772199*^9, 
   3.7666919631114635`*^9}, {3.7666921374016294`*^9, 
   3.7666921932127466`*^9}, {3.7667039996576095`*^9, 3.766704008678763*^9}, 
   3.76670417284365*^9, {3.7667054035967393`*^9, 3.7667057112484035`*^9}, {
   3.766707206864745*^9, 3.7667072116712303`*^9}, {3.7723044639645777`*^9, 
   3.7723045027127733`*^9}, {3.7723045332781897`*^9, 3.77230465446824*^9}, {
   3.772304689798416*^9, 3.772304699646985*^9}, {3.7723047376986055`*^9, 
   3.772304867777944*^9}, {3.772304907646675*^9, 3.7723049087245464`*^9}, {
   3.7723055922800694`*^9, 3.7723056564218826`*^9}, {3.772306398766314*^9, 
   3.7723063989850125`*^9}, {3.7727481364976497`*^9, 3.772748140671271*^9}, {
   3.7727513309221535`*^9, 3.7727513381729193`*^9}, {3.7728923597537136`*^9, 
   3.772892366475972*^9}, {3.7729230118370934`*^9, 3.7729230162161164`*^9}, {
   3.772971238313014*^9, 3.772971238442964*^9}, {3.772971901672711*^9, 
   3.772971907482662*^9}, 3.772972871384304*^9},
 CellLabel->
  "In[101]:=",ExpressionUUID->"d7e8b2ec-aa9e-423c-90aa-a7caca52b7ae"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["(15-to-1)\[Times](20-to-4) protocol", "Title",
 InitializationCell->True,
 CellChangeTimes->{{3.766523084124572*^9, 3.7665230894198265`*^9}, {
  3.7665231201077113`*^9, 3.7665231263246613`*^9}, {3.7665231897407603`*^9, 
  3.766523191163288*^9}},ExpressionUUID->"cc221950-c2a6-4cd5-8ffa-\
4154722ff588"],

Cell[CellGroupData[{

Cell[TextData[{
 "Calculates the output error and space-time cost of the (15-to-",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    SuperscriptBox[
     RowBox[{"1", ")"}], 
     SubscriptBox["n", "L1"]], 
    RowBox[{
     SubscriptBox["d", "x"], ",", "  ", 
     SubscriptBox["d", "z"], ",", "  ", 
     SubscriptBox["d", "m"]}]], TraditionalForm]],ExpressionUUID->
  "deef9b7c-4429-4b41-b33e-d47041d2ca67"],
 "\[Times](20-to-4",
 Cell[BoxData[
  FormBox[
   SubscriptBox[")", 
    RowBox[{
     SubscriptBox["d", "X2"], ",", " ", 
     SubscriptBox["d", "Z2"], ",", " ", 
     SubscriptBox["d", "m2"]}]], TraditionalForm]],ExpressionUUID->
  "3809e8f2-cd4e-4f8b-9100-ae9514f9605c"],
 " protocol with a physical error rate ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["p", "phys"], TraditionalForm]],ExpressionUUID->
  "9aacdd4f-feb6-4794-9dfd-f93e8bbc8c40"],
 "."
}], "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.764798548319666*^9, 3.764798559642825*^9}, {
   3.7647987276519747`*^9, 3.7647987320112915`*^9}, {3.764798772566616*^9, 
   3.7647988107091117`*^9}, {3.7647988766983724`*^9, 3.764798892262065*^9}, 
   3.764798925821597*^9, {3.766705259168877*^9, 3.766705268657409*^9}, {
   3.766705339047531*^9, 3.7667053819828215`*^9}, {3.766705816907696*^9, 
   3.7667058190341935`*^9}},ExpressionUUID->"758a7373-ab77-48e5-87d9-\
52bccfdfd20b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CostOfTwoLevel20to4", "[", 
   RowBox[{
   "pphys_", ",", "dx_", ",", "dz_", ",", "dm_", ",", "dx2_", ",", "dz2_", 
    ",", "dm2_", ",", "nl1_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "out", ",", "out2", ",", "OutPostSel", ",", "OutPostSel2", ",", "pl1", 
      ",", "pout", ",", "l1time", ",", "ncycles", ",", "lmove", ",", "pfail", 
      ",", "pfail2", ",", "reqdist1", ",", "reqdist2", ",", "px2", ",", "pz2",
       ",", "pm2"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Introduce", " ", "shorthand", " ", "notation", " ", "for", " ", 
      "logical", " ", "error", " ", "rate", " ", "with", " ", "distances", 
      " ", 
      RowBox[{
       RowBox[{"dx2", "/", "dz2"}], "/", "dm2"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"px2", "=", 
      RowBox[{"plog", "[", 
       RowBox[{"pphys", ",", "dx2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pz2", "=", 
      RowBox[{"plog", "[", 
       RowBox[{"pphys", ",", "dz2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pm2", "=", 
      RowBox[{"plog", "[", 
       RowBox[{"pphys", ",", "dm2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Compute", " ", "pl1"}], ",", " ", 
       RowBox[{
        RowBox[{"the", " ", "output", " ", "error", " ", "of", " ", "level"}],
         "-", 
        RowBox[{"1", " ", "states"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out", "=", 
      RowBox[{"OneLevel15to1", "[", 
       RowBox[{"pphys", ",", "dx", ",", "dz", ",", "dm"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pfail", "=", 
      RowBox[{"Re", "[", 
       RowBox[{"1", "-", 
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{
           "one", ",", "ProjX", ",", "ProjX", ",", "ProjX", ",", "ProjX"}], 
           "]"}], ".", "out"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"OutPostSel", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", "pfail"}]], 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
         "one", ",", "ProjX", ",", "ProjX", ",", "ProjX", ",", "ProjX"}], 
         "]"}], ".", "out", ".", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{
          "one", ",", "ProjX", ",", "ProjX", ",", "ProjX", ",", "ProjX"}], 
          "]"}], "\[HermitianConjugate]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pl1", "=", 
      RowBox[{"Rationalize", "[", 
       RowBox[{
        RowBox[{"Re", "[", 
         RowBox[{"1", "-", 
          RowBox[{"Tr", "[", 
           RowBox[{"OutPostSel", ".", "Ideal15to1"}], "]"}]}], "]"}], ",", 
        SuperscriptBox["10", 
         RowBox[{"-", "50"}]]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Compute", " ", "l1time"}], ",", " ", 
       RowBox[{
        RowBox[{"the", " ", "speed", " ", "at", " ", "which", " ", "level"}], 
        "-", 
        RowBox[{
        "2", " ", "rotations", " ", "can", " ", "be", " ", "performed", " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["t", "L1"], " ", "in", " ", "the", " ", "paper"}], 
          ")"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"l1time", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"6", 
         RowBox[{
          RowBox[{"dm", "/", 
           RowBox[{"(", 
            RowBox[{"nl1", "/", "2"}], ")"}]}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", "pfail"}], ")"}]}]}], ",", "dm2"}], "]"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Define", " ", "lmove"}], ",", " ", 
       RowBox[{
        RowBox[{"the", " ", "effective", " ", "width"}], "-", 
        RowBox[{"dm2", " ", "region", " ", "a", " ", "level"}], "-", 
        RowBox[{
        "1", " ", "state", " ", "needs", " ", "to", " ", "traverse", " ", 
         "before", " ", "reaching", " ", "the", " ", "level"}], "-", 
        RowBox[{"2", " ", "block"}]}], ",", " ", 
       RowBox[{
       "picking", " ", "up", " ", "additional", " ", "storage", " ", 
        "errors"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"lmove", "=", 
      RowBox[{
       RowBox[{"10", "dm2"}], "+", 
       RowBox[{
        RowBox[{"nl1", "/", "4"}], "*", 
        RowBox[{"(", 
         RowBox[{"dx", "+", 
          RowBox[{"4", "dz"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "1", " ", "of", " ", 
        RowBox[{"(", 
         RowBox[{"15", "-", "to", "-", "1"}], ")"}], "\[Times]", 
        RowBox[{"(", 
         RowBox[{"20", "-", "to", "-", "4"}], ")"}], " ", "protocol", " ", 
        "applying", " ", "rotations", " ", "1"}], "-", "2"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"Init7Qubit", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "one", ",", "one", ",", 
          RowBox[{"-", "z"}], ",", "one", ",", "one"}], "}"}], ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", "dx2"}], "+", "dz2", "+", "dm2"}], ")"}], "dx2"}], 
           "dm2"], "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "one", ",", "one", ",", "one", ",", 
          RowBox[{"-", "z"}], ",", "one"}], "}"}], ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX7Qubit", "[", 
       RowBox[{"out2", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", "0"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ7Qubit", "[", 
       RowBox[{"out2", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", "0"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "2"}], ":", " ", 
       RowBox[{
        RowBox[{"apply", " ", "rotations", " ", "4"}], "-", "5"}]}], " ", 
      "*)"}], 
     RowBox[{"(*", " ", 
      RowBox[{"Last", " ", 
       RowBox[{"operation", ":", 
        RowBox[{
         RowBox[{
         "apply", " ", "addditional", " ", "storage", " ", "errors", " ", 
          "due", " ", "to", " ", "multi"}], "-", 
         RowBox[{"patch", " ", "measurements"}]}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{
         "z", ",", "one", ",", "one", ",", "one", ",", "z", ",", "z", ",", 
          "one"}], "}"}], ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", "dx2"}], "+", 
              RowBox[{"2", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "one", ",", "one", ",", 
          RowBox[{"-", "z"}], ",", "z", ",", "z"}], "}"}], ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ7Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", "dx2"}], "+", 
            RowBox[{"2", "dz2"}], "+", "dm2"}], ")"}], "dx2"], "px2", " ", 
         "dm2"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX7Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", "0", ",", "0", 
        ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ7Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", "0", ",", "0", 
        ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "3"}], ":", " ", 
       RowBox[{"apply", " ", "rotations", " ", "3", " ", "and", " ", "6"}]}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{
         "z", ",", "one", ",", "one", ",", "one", ",", "one", ",", "z", ",", 
          "z"}], "}"}], ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", "dx2"}], "+", 
              RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{
         "one", ",", "one", ",", "one", ",", "one", ",", "one", ",", "one", 
          ",", 
          RowBox[{"-", "z"}]}], "}"}], ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dz2", "+", "dm2"}], ")"}], "dx2"}], "dm2"], "pm2"}]}], 
        ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ7Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", "dx2"}], "+", 
            RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"], "px2", " ", 
         "dm2"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX7Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", "0", ",", "0", 
        ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ7Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", "0", ",", "0", 
        ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "4"}], ":", " ", 
       RowBox[{
        RowBox[{"apply", " ", "rotations", " ", "7"}], "-", "8"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{
         "z", ",", "one", ",", "one", ",", "one", ",", "z", ",", "one", ",", 
          "z"}], "}"}], ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", "dx2"}], "+", 
              RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{
         "one", ",", "z", ",", "one", ",", "one", ",", "z", ",", "z", ",", 
          "one"}], "}"}], ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", "dx2"}], "+", 
              RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ7Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", "dx2"}], "+", 
            RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"], "px2", " ", 
         "dm2"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", "dx2"}], "+", 
            RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"], "px2", " ", 
         "dm2"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}]}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX7Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", "0", ",", "0", 
        ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ7Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", "0", ",", "0", 
        ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "5"}], ":", " ", 
       RowBox[{
        RowBox[{"apply", " ", "rotations", " ", "9"}], "-", "10"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{
         "z", ",", "z", ",", "z", ",", "z", ",", "one", ",", "z", ",", 
          "one"}], "}"}], ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", "dx2"}], "+", 
              RowBox[{"2", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{
         "one", ",", "z", ",", "one", ",", "one", ",", "z", ",", "one", ",", 
          "z"}], "}"}], ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", "dx2"}], "+", 
              RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ7Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", "dx2"}], "+", 
            RowBox[{"2", "dz2"}], "+", "dm2"}], ")"}], "dx2"], "px2", " ", 
         "dm2"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", "dx2"}], "+", 
             RowBox[{"2", "dz2"}], "+", "dm2"}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", "dx2"}], "+", 
             RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}]}], "dx2"], "px2", " ", 
         "dm2"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", "dx2"}], "+", 
            RowBox[{"2", "dz2"}], "+", "dm2"}], ")"}], "dx2"], "px2", " ", 
         "dm2"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", "dx2"}], "+", 
            RowBox[{"2", "dz2"}], "+", "dm2"}], ")"}], "dx2"], "px2", " ", 
         "dm2"}], ",", "0", ",", "0", ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX7Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ7Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "6"}], ":", " ", 
       RowBox[{
        RowBox[{"apply", " ", "rotations", " ", "11"}], "-", "12"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{
         "z", ",", "z", ",", "z", ",", "z", ",", "z", ",", "one", ",", 
          "one"}], "}"}], ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", "dx2"}], "+", "dz2", "+", "dm2"}], ")"}], "dx2"}], 
           "dm2"], "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{
         "one", ",", "z", ",", "one", ",", "one", ",", "one", ",", "z", ",", 
          "z"}], "}"}], ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", "dx2"}], "+", 
              RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ7Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", "dx2"}], "+", "dz2", "+", "dm2"}], ")"}], "dx2"], 
         "px2", " ", "dm2"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", "dx2"}], "+", "dz2", "+", "dm2"}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", "dx2"}], "+", 
             RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}]}], "dx2"], "px2", " ", 
         "dm2"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", "dx2"}], "+", "dz2", "+", "dm2"}], ")"}], "dx2"], 
         "px2", " ", "dm2"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", "dx2"}], "+", "dz2", "+", "dm2"}], ")"}], "dx2"], 
         "px2", " ", "dm2"}], ",", "0", ",", "0", ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX7Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ7Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "7"}], ":", " ", 
       RowBox[{
        RowBox[{"apply", " ", "rotations", " ", "13"}], "-", "14"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{
         "z", ",", "z", ",", "z", ",", "z", ",", "z", ",", "z", ",", "z"}], 
         "}"}], ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", "dx2"}], "+", 
              RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{
         "one", ",", "one", ",", "z", ",", "one", ",", "z", ",", "z", ",", 
          "one"}], "}"}], ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "dx2"}], "+", 
              RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ7Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", "dx2"}], "+", 
            RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"], "px2", " ", 
         "dm2"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", "dx2"}], "+", 
            RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"], "px2", " ", 
         "dm2"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", "dx2"}], "+", 
             RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "dx2"}], "+", 
             RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}]}], "dx2"], "px2", " ", 
         "dm2"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", "dx2"}], "+", 
            RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"], "px2", " ", 
         "dm2"}], ",", "0", ",", "0", ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX7Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ7Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "8"}], ":", " ", 
       RowBox[{
        RowBox[{"apply", " ", "rotations", " ", "15"}], "-", "16"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{
         "z", ",", "z", ",", "z", ",", "z", ",", "one", ",", "one", ",", 
          "z"}], "}"}], ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", "dx2"}], "+", 
              RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{
         "one", ",", "one", ",", "z", ",", "one", ",", "z", ",", "one", ",", 
          "z"}], "}"}], ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "dx2"}], "+", 
              RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ7Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", "dx2"}], "+", 
            RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"], "px2", " ", 
         "dm2"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", "dx2"}], "+", 
            RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"], "px2", " ", 
         "dm2"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", "dx2"}], "+", 
             RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "dx2"}], "+", 
             RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}]}], "dx2"], "px2", " ", 
         "dm2"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", "dx2"}], "+", 
            RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"], "px2", " ", 
         "dm2"}], ",", "0", ",", "0", ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Qubits", " ", "1", " ", "and", " ", "2", " ", "are", " ", "consumed", 
       " ", "as", " ", "output", " ", 
       RowBox[{"states", ":", " ", 
        RowBox[{
        "additional", " ", "storage", " ", "errors", " ", "for", " ", "dx2", 
         " ", "code", " ", "cycles"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX7Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"dm2", "+", 
           RowBox[{"2", "dx2"}]}], ")"}], "px2"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"dm2", "+", 
           RowBox[{"2", "dx2"}]}], ")"}], "px2"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ7Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"dm2", "+", 
           RowBox[{"2", "dx2"}]}], ")"}], "px2"}], " ", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"dm2", "+", 
           RowBox[{"2", "dx2"}]}], ")"}], "px2"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "9"}], ":", " ", 
       RowBox[{
        RowBox[{"apply", " ", "rotations", " ", "17"}], "-", "18"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{
         "one", ",", "one", ",", "z", ",", "one", ",", "one", ",", "z", ",", 
          "z"}], "}"}], ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", "dx2"}], "+", 
              RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{
         "one", ",", "one", ",", "one", ",", "z", ",", "z", ",", "z", ",", 
          "one"}], "}"}], ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx2", "+", 
              RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ7Qubit", "[", 
       RowBox[{"out2", ",", "0", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", "dx2"}], "+", 
            RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"], "px2", " ", 
         "dm2"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"dx2", "+", 
            RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"], "px2", " ", 
         "dm2"}], ",", "0", ",", "0", ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Qubit", " ", "3", " ", "is", " ", "consumed", " ", "as", " ", "an", 
       " ", "output", " ", 
       RowBox[{"state", ":", " ", 
        RowBox[{
        "additional", " ", "storage", " ", "errors", " ", "for", " ", "dx2", 
         " ", "code", " ", "cycles"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX7Qubit", "[", 
       RowBox[{"out2", ",", "0", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"dm2", "+", 
           RowBox[{"2", "dx2"}]}], ")"}], "px2"}], " ", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ7Qubit", "[", 
       RowBox[{"out2", ",", "0", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"dm2", "+", 
           RowBox[{"2", "dx2"}]}], ")"}], "px2"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "10"}], ":", " ", 
       RowBox[{
        RowBox[{"apply", " ", "rotations", " ", "19"}], "-", "20"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{
         "one", ",", "one", ",", "one", ",", "z", ",", "z", ",", "one", ",", 
          "z"}], "}"}], ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", "dx2"}], "+", 
              RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{
         "one", ",", "one", ",", "one", ",", "z", ",", "one", ",", "z", ",", 
          "z"}], "}"}], ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx2", "+", 
              RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ7Qubit", "[", 
       RowBox[{"out2", ",", "0", ",", "0", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", "dx2"}], "+", 
             RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{"dx2", "+", 
             RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}]}], "dx2"], "px2", " ", 
         "dm2"}], ",", "0", ",", "0", ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Qubit", " ", "4", " ", "is", " ", "consumed", " ", "as", " ", "an", 
       " ", "output", " ", "state", " ", "in", " ", "the", " ", "following", 
       " ", 
       RowBox[{"step", ":", " ", 
        RowBox[{
        "additional", " ", "storage", " ", "errors", " ", "for", " ", "dx2", 
         " ", "code", " ", "cycles"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX7Qubit", "[", 
       RowBox[{"out2", ",", "0", ",", "0", ",", "0", ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "px2", " ", "l1time"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", 
           RowBox[{"dm2", "+", 
            RowBox[{"2", "dx2"}]}], ")"}], "px2"}]}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ7Qubit", "[", 
       RowBox[{"out2", ",", "0", ",", "0", ",", "0", ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "px2", " ", "l1time"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", 
           RowBox[{"dm2", "+", 
            RowBox[{"2", "dx2"}]}], ")"}], "px2"}]}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Compute", " ", "level"}], "-", 
        RowBox[{
        "2", " ", "failure", " ", "probability", " ", "as", " ", "the", " ", 
         "probability", " ", "to", " ", "measure", " ", "qubits", " ", "5"}], 
        "-", 
        RowBox[{"7", " ", "in", " ", "the"}]}], " ", "|", 
       RowBox[{"+", 
        RowBox[{">", " ", "state"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pfail2", "=", 
      RowBox[{"Re", "[", 
       RowBox[{"1", "-", 
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{
           "one", ",", "one", ",", "one", ",", "one", ",", "ProjX", ",", 
            "ProjX", ",", "ProjX"}], "]"}], ".", "out2"}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "Compute", " ", "the", " ", "density", " ", "matrix", " ", "of", " ", 
         "the", " ", "post"}], "-", 
        RowBox[{"selected", " ", "output", " ", "state"}]}], ",", " ", 
       RowBox[{"i", ".", "e", "."}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"after", " ", "projecting", " ", "qubits", " ", "5"}], "-", 
         RowBox[{"7", " ", "into"}]}], " ", "|", 
        RowBox[{"+", ">"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"OutPostSel2", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", "pfail2"}]], 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
         "one", ",", "one", ",", "one", ",", "one", ",", "ProjX", ",", 
          "ProjX", ",", "ProjX"}], "]"}], ".", "out2", ".", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{
          "one", ",", "one", ",", "one", ",", "one", ",", "ProjX", ",", 
           "ProjX", ",", "ProjX"}], "]"}], "\[HermitianConjugate]"}]}]}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Compute", " ", "level"}], "-", 
       RowBox[{
       "2", " ", "output", " ", "error", " ", "from", " ", "the", " ", 
        "infidelity", " ", "between", " ", "the", " ", "post"}], "-", 
       RowBox[{
       "selected", " ", "state", " ", "and", " ", "the", " ", "ideal", " ", 
        "output", " ", "state"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pout", "=", 
      RowBox[{
       RowBox[{"Re", "[", 
        RowBox[{"1", "-", 
         RowBox[{"Tr", "[", 
          RowBox[{"OutPostSel2", ".", "Ideal20to4"}], "]"}]}], "]"}], "/", 
       "4"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Full", "-", 
       RowBox[{"distance", " ", 
        RowBox[{"computation", ":", " ", 
         RowBox[{
          RowBox[{
          "determine", " ", "full", " ", "distance", " ", "required", " ", 
           "for", " ", "a", " ", "100"}], "-", 
          RowBox[{"qubit", "/", "10000"}], "-", 
          RowBox[{"qubit", " ", "computation"}]}]}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"reqdist1", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Round", "[", 
          RowBox[{"d", ",", "2"}], "]"}], "+", "1"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"Quiet", "[", 
         RowBox[{"Solve", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"231.", "/", "pout"}], "*", "d", "*", 
              RowBox[{"plog", "[", 
               RowBox[{"pphys", ",", "d"}], "]"}]}], "\[Equal]", "0.01"}], 
            ",", 
            RowBox[{"d", ">", "1"}]}], "}"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"reqdist2", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Round", "[", 
          RowBox[{"d", ",", "2"}], "]"}], "+", "1"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"Quiet", "[", 
         RowBox[{"Solve", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"20284.", "/", "pout"}], "*", "d", "*", 
              RowBox[{"plog", "[", 
               RowBox[{"pphys", ",", "d"}], "]"}]}], "\[Equal]", "0.01"}], 
            ",", 
            RowBox[{"d", ">", "1"}]}], "}"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Print", " ", "output", " ", "error"}], ",", " ", 
       RowBox[{"failure", " ", "probability"}], ",", " ", 
       RowBox[{"space", " ", "cost"}], ",", " ", 
       RowBox[{
        RowBox[{"time", " ", "cost", " ", "and", " ", "space"}], "-", 
        RowBox[{"time", " ", "cost"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ncycles", "=", 
      RowBox[{"10", "*", "l1time"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<(15-to-1\!\(\*SubscriptBox[SuperscriptBox[\()\), \(`7`\)], \(`1`, \
`2`, `3`\)]\)\[Times](20-to-4\!\(\*SubscriptBox[\()\), \(`4`, `5`, `6`\)]\) \
with \!\(\*SubscriptBox[\(p\), \(phys\)]\)=`8`, \!\(\*SubscriptBox[\(d\), \(x\
\)]\)=`1`, \!\(\*SubscriptBox[\(d\), \(z\)]\)=`2`, \!\(\*SubscriptBox[\(d\), \
\(m\)]\)=`3`, \!\(\*SubscriptBox[\(d\), \(x2\)]\)=`4`, \!\(\*SubscriptBox[\(d\
\), \(z2\)]\)=`5`, \!\(\*SubscriptBox[\(d\), \(m2\)]\)=`6` and \
\!\(\*SubscriptBox[\(n\), \(L1\)]\)=`7`\>\"", ",", "dx", ",", "dz", ",", "dm",
         ",", "dx2", ",", "dz2", ",", "dm2", ",", "nl1", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{"N", "[", "pphys", "]"}], "]"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<Output error: \!\(\*SubscriptBox[\(p\), \(out\)]\) = `1`\>\"", 
        ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{"pout", ",", "4"}], "]"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<Failure probability: \!\(\*SubscriptBox[\(p\), \(fail\)]\) = \
`1`\>\"", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{"pfail2", ",", "4"}], "]"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{"\"\<Space cost: `1` qubits\>\"", ",", 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", "dx2", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", "dx2"}], "+", 
              RowBox[{"3", "dz2"}]}], ")"}]}], "+", 
           RowBox[{"2", "dx2", " ", "dm2"}], "+", 
           RowBox[{"20", 
            SuperscriptBox["dm2", "2"]}], "+", 
           RowBox[{
            RowBox[{"nl1", "/", "2"}], " ", "dm2", 
            RowBox[{"(", 
             RowBox[{"dx", "+", 
              RowBox[{"4", "dz"}]}], ")"}]}], "+", 
           RowBox[{"nl1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", "dx", 
               RowBox[{"(", 
                RowBox[{"dx", "+", 
                 RowBox[{"4", "dz"}]}], ")"}]}], "+", 
              RowBox[{"2", "dm"}]}], ")"}]}]}], ")"}]}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{"\"\<Time cost: `1` code cycles\>\"", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"ncycles", "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", "pfail2"}], ")"}]}], ",", "4"}], "]"}], ",", 
          "4"}], "]"}]}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<Spacetime cost: `1` qubitcycles per output state\>\"", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{
          RowBox[{"2", "*", "ncycles", "*", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", "dx2", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"4", "dx2"}], "+", 
                  RowBox[{"3", "dz2"}]}], ")"}]}], "+", 
               RowBox[{"2", "dx2", " ", "dm2"}], "+", 
               RowBox[{"20", 
                SuperscriptBox["dm2", "2"]}], "+", 
               RowBox[{
                RowBox[{"nl1", "/", "2"}], " ", "dm2", 
                RowBox[{"(", 
                 RowBox[{"dx", "+", 
                  RowBox[{"4", "dz"}]}], ")"}]}], "+", 
               RowBox[{"nl1", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", "dx", 
                   RowBox[{"(", 
                    RowBox[{"dx", "+", 
                    RowBox[{"4", "dz"}]}], ")"}]}], "+", 
                  RowBox[{"2", "dm"}]}], ")"}]}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", "pfail2"}], ")"}]}], "/", "4"}]}], ",", "4"}],
          "]"}]}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<For a 100-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \
\(3\)]\) (d=`2`)\>\"", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{
          RowBox[{"ncycles", "*", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", "dx2", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", "dx2"}], "+", 
                   RowBox[{"3", "dz2"}]}], ")"}]}], "+", 
                RowBox[{"2", "dx2", " ", "dm2"}], "+", 
                RowBox[{"20", 
                 SuperscriptBox["dm2", "2"]}], "+", 
                RowBox[{
                 RowBox[{"nl1", "/", "2"}], " ", "dm2", 
                 RowBox[{"(", 
                  RowBox[{"dx", "+", 
                   RowBox[{"4", "dz"}]}], ")"}]}], "+", 
                RowBox[{"nl1", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"3", "dx", 
                    RowBox[{"(", 
                    RowBox[{"dx", "+", 
                    RowBox[{"4", "dz"}]}], ")"}]}], "+", 
                   RowBox[{"2", "dm"}]}], ")"}]}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"1", "-", "pfail2"}], ")"}]}], "/", "4"}], "/", 
            SuperscriptBox["reqdist1", "3"]}]}], ",", "4"}], "]"}], ",", 
        "reqdist1"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<For a 10000-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\
\)]\) (d=`2`)\>\"", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{
          RowBox[{"ncycles", "*", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", "dx2", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", "dx2"}], "+", 
                   RowBox[{"3", "dz2"}]}], ")"}]}], "+", 
                RowBox[{"2", "dx2", " ", "dm2"}], "+", 
                RowBox[{"20", 
                 SuperscriptBox["dm2", "2"]}], "+", 
                RowBox[{
                 RowBox[{"nl1", "/", "2"}], " ", "dm2", 
                 RowBox[{"(", 
                  RowBox[{"dx", "+", 
                   RowBox[{"4", "dz"}]}], ")"}]}], "+", 
                RowBox[{"nl1", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"3", "dx", 
                    RowBox[{"(", 
                    RowBox[{"dx", "+", 
                    RowBox[{"4", "dz"}]}], ")"}]}], "+", 
                   RowBox[{"2", "dm"}]}], ")"}]}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"1", "-", "pfail2"}], ")"}]}], "/", "4"}], "/", 
            SuperscriptBox["reqdist2", "3"]}]}], ",", "4"}], "]"}], ",", 
        "reqdist2"}], "]"}], "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7647818804197054`*^9, 3.7647827170147686`*^9}, {
   3.7647827526955023`*^9, 3.7647828037704153`*^9}, {3.7647828777323666`*^9, 
   3.7647828873914766`*^9}, {3.7647829679315805`*^9, 
   3.7647829900869355`*^9}, {3.7647830602111425`*^9, 3.764783072488778*^9}, {
   3.764783131817492*^9, 3.764783148775908*^9}, {3.7647862596338406`*^9, 
   3.764786409561177*^9}, {3.7647864408752875`*^9, 3.7647869421775618`*^9}, {
   3.764787231830381*^9, 3.764787347496937*^9}, {3.764787487871532*^9, 
   3.7647875951390624`*^9}, {3.764788578379526*^9, 3.764788591413617*^9}, 
   3.7647890303995075`*^9, {3.764791032879811*^9, 3.7647910351007853`*^9}, {
   3.7647926957763724`*^9, 3.7647927131222076`*^9}, {3.7647933352194834`*^9, 
   3.7647934163659678`*^9}, {3.7649446741339808`*^9, 
   3.7649446796035213`*^9}, {3.764944828742154*^9, 3.764944840801855*^9}, {
   3.764944901461481*^9, 3.7649449124106145`*^9}, {3.764945000020465*^9, 
   3.764945012750493*^9}, {3.7651058377309327`*^9, 3.7651058381996737`*^9}, {
   3.7654100025346904`*^9, 3.765410018971986*^9}, {3.7655181050024023`*^9, 
   3.7655181392063417`*^9}, {3.765522280891552*^9, 3.765522283079026*^9}, {
   3.765724392207079*^9, 3.7657244079729195`*^9}, {3.765724440989117*^9, 
   3.7657244569378977`*^9}, {3.7657255689852734`*^9, 3.765725862088357*^9}, {
   3.7657259136804733`*^9, 3.7657259438076143`*^9}, 3.7657260696164446`*^9, {
   3.765740494548848*^9, 3.7657405070379596`*^9}, {3.765740624614597*^9, 
   3.765740625359543*^9}, {3.7657407755488596`*^9, 3.7657407760888205`*^9}, 
   3.766008483548252*^9, {3.7660086363273387`*^9, 3.7660087346853275`*^9}, {
   3.7661780763543944`*^9, 3.7661781169338455`*^9}, {3.7661789764987087`*^9, 
   3.766178992568207*^9}, {3.7661790452300816`*^9, 3.7661790484175386`*^9}, {
   3.766179136270814*^9, 3.7661792175494733`*^9}, {3.766179954217317*^9, 
   3.766180094871887*^9}, {3.766180155717496*^9, 3.766180542634591*^9}, {
   3.7661805909930816`*^9, 3.766180600339566*^9}, {3.7661806374694433`*^9, 
   3.766180733453707*^9}, {3.7661807659924965`*^9, 3.766180786161292*^9}, {
   3.766180906794409*^9, 3.766181205663262*^9}, 3.7661836296796627`*^9, 
   3.766183738997388*^9, 3.766247353713544*^9, 3.766248549975103*^9, 
   3.766248609571945*^9, 3.7663316920515995`*^9, {3.7663438183553934`*^9, 
   3.766343836595559*^9}, 3.766343878380926*^9, {3.766343960970273*^9, 
   3.7663440266107616`*^9}, {3.766356230872748*^9, 3.766356232105342*^9}, {
   3.7663573881852636`*^9, 3.766357403386253*^9}, {3.766357449485057*^9, 
   3.76635744993191*^9}, {3.766357482124298*^9, 3.7663574874025583`*^9}, {
   3.766357645474454*^9, 3.7663576491172523`*^9}, {3.7663577017838917`*^9, 
   3.7663578744529753`*^9}, {3.7663579257030816`*^9, 
   3.7663581088996944`*^9}, {3.7663585386920223`*^9, 3.766358546084584*^9}, {
   3.7663585839431047`*^9, 3.7663586351822166`*^9}, {3.7663586696148663`*^9, 
   3.7663589623883595`*^9}, {3.7663589987653685`*^9, 
   3.7663591024481916`*^9}, {3.7663591450211573`*^9, 3.766359149184786*^9}, {
   3.7663596930765033`*^9, 3.766359693474372*^9}, {3.7663597571883698`*^9, 
   3.7663597863417597`*^9}, {3.7663598203635454`*^9, 
   3.7663598239953485`*^9}, {3.766359874258782*^9, 3.7663599090723047`*^9}, 
   3.766360143133152*^9, {3.766391662137636*^9, 3.766391690606043*^9}, {
   3.7663917399277277`*^9, 3.7663917494276133`*^9}, {3.76640189403976*^9, 
   3.7664020686978893`*^9}, {3.7664021003865027`*^9, 3.766402107870788*^9}, {
   3.766402154465047*^9, 3.766402232357127*^9}, {3.766402333560653*^9, 
   3.766402445642296*^9}, 3.766690095738625*^9, {3.766690338841493*^9, 
   3.7666903649438887`*^9}, {3.7666904046438026`*^9, 
   3.7666906795321894`*^9}, {3.7666907172007747`*^9, 
   3.7666907249492207`*^9}, {3.766690760140562*^9, 3.766690963926614*^9}, {
   3.7666910658347254`*^9, 3.76669119413132*^9}, 3.7666912990588264`*^9, {
   3.7666913735137763`*^9, 3.7666914321812296`*^9}, {3.7666914651997204`*^9, 
   3.766691917546996*^9}, {3.7666919761183076`*^9, 3.766691988466457*^9}, {
   3.7666922258516226`*^9, 3.766692231196765*^9}, {3.76669371278594*^9, 
   3.766693727832513*^9}, {3.7667040231401453`*^9, 3.7667040273045125`*^9}, 
   3.7667041817959743`*^9, {3.766705825209962*^9, 3.766705904942371*^9}, {
   3.7667059373099227`*^9, 3.7667061710006485`*^9}, {3.76670721760559*^9, 
   3.766707226855315*^9}, {3.7723064074863615`*^9, 3.772306407689438*^9}, {
   3.772306443309762*^9, 3.772306879648426*^9}, {3.7723069266022596`*^9, 
   3.7723069499994287`*^9}, {3.7727513701500397`*^9, 
   3.7727513962405663`*^9}, {3.772892374986389*^9, 3.7728923833298597`*^9}, {
   3.7729230308840375`*^9, 3.7729230386408715`*^9}, {3.772971250452897*^9, 
   3.7729712505831614`*^9}, {3.7729743484922905`*^9, 3.772974363092383*^9}, {
   3.7729747554523735`*^9, 3.7729747603312454`*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"d57c9250-a2bd-4585-b5bf-b1bb54d29152"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["(15-to-1)\[Times](8-to-CCZ) protocol", "Title",
 InitializationCell->True,
 CellChangeTimes->{{3.766523084124572*^9, 3.7665230894198265`*^9}, {
  3.7665231201077113`*^9, 3.7665231263246613`*^9}, {3.7665231897407603`*^9, 
  3.766523206667177*^9}},ExpressionUUID->"f6cd8429-dffb-44bc-b8e8-\
ac0857f37351"],

Cell[CellGroupData[{

Cell[TextData[{
 "Calculates the output error and space-time cost of the (15-to-",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    SuperscriptBox[
     RowBox[{"1", ")"}], 
     SubscriptBox["n", "L1"]], 
    RowBox[{
     SubscriptBox["d", "x"], ",", "  ", 
     SubscriptBox["d", "z"], ",", "  ", 
     SubscriptBox["d", "m"]}]], TraditionalForm]],ExpressionUUID->
  "772052f1-82a2-41ca-b905-68cb77eb226c"],
 "\[Times](8-to-CCZ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[")", 
    RowBox[{
     SubscriptBox["d", "X2"], ",", " ", 
     SubscriptBox["d", "Z2"], ",", " ", 
     SubscriptBox["d", "m2"]}]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "04ad97e3-88e7-4034-b54d-2abbf31dd93b"],
 " protocol with a physical error rate ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["p", "phys"], TraditionalForm]],ExpressionUUID->
  "09859269-320d-4fb7-ac86-8cc29f69c33a"],
 "."
}], "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.764798548319666*^9, 3.764798559642825*^9}, {
   3.7647987276519747`*^9, 3.7647987320112915`*^9}, {3.764798772566616*^9, 
   3.7647988107091117`*^9}, {3.7647988766983724`*^9, 3.764798892262065*^9}, 
   3.764798925821597*^9, {3.766705259168877*^9, 3.766705268657409*^9}, {
   3.766705339047531*^9, 3.7667053819828215`*^9}, {3.766705816907696*^9, 
   3.7667058190341935`*^9}, {3.766706187009997*^9, 
   3.7667061889906235`*^9}},ExpressionUUID->"9719aa13-1c19-49ad-8930-\
8ef0ed383918"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CostOfTwoLevel8toCCZ", "[", 
   RowBox[{
   "pphys_", ",", "dx_", ",", "dz_", ",", "dm_", ",", "dx2_", ",", "dz2_", 
    ",", "dm2_", ",", "nl1_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "out", ",", "out2", ",", "OutPostSel", ",", "OutPostSel2", ",", "pl1", 
      ",", "pout", ",", "l1time", ",", "ncycles", ",", "lmove", ",", "pfail", 
      ",", "pfail2", ",", "reqdist1", ",", "reqdist2", ",", "px2", ",", "pz2",
       ",", "pm2"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Introduce", " ", "shorthand", " ", "notation", " ", "for", " ", 
      "logical", " ", "error", " ", "rate", " ", "with", " ", "distances", 
      " ", 
      RowBox[{
       RowBox[{"dx2", "/", "dz2"}], "/", "dm2"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"px2", "=", 
      RowBox[{"plog", "[", 
       RowBox[{"pphys", ",", "dx2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pz2", "=", 
      RowBox[{"plog", "[", 
       RowBox[{"pphys", ",", "dz2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pm2", "=", 
      RowBox[{"plog", "[", 
       RowBox[{"pphys", ",", "dm2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Compute", " ", "pl1"}], ",", " ", 
       RowBox[{
        RowBox[{"the", " ", "output", " ", "error", " ", "of", " ", "level"}],
         "-", 
        RowBox[{"1", " ", "states"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out", "=", 
      RowBox[{"OneLevel15to1", "[", 
       RowBox[{"pphys", ",", "dx", ",", "dz", ",", "dm"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pfail", "=", 
      RowBox[{"Re", "[", 
       RowBox[{"1", "-", 
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{
           "one", ",", "ProjX", ",", "ProjX", ",", "ProjX", ",", "ProjX"}], 
           "]"}], ".", "out"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"OutPostSel", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", "pfail"}]], 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
         "one", ",", "ProjX", ",", "ProjX", ",", "ProjX", ",", "ProjX"}], 
         "]"}], ".", "out", ".", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{
          "one", ",", "ProjX", ",", "ProjX", ",", "ProjX", ",", "ProjX"}], 
          "]"}], "\[HermitianConjugate]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pl1", "=", 
      RowBox[{"Rationalize", "[", 
       RowBox[{
        RowBox[{"Re", "[", 
         RowBox[{"1", "-", 
          RowBox[{"Tr", "[", 
           RowBox[{"OutPostSel", ".", "Ideal15to1"}], "]"}]}], "]"}], ",", 
        SuperscriptBox["10", 
         RowBox[{"-", "50"}]]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Compute", " ", "l1time"}], ",", " ", 
       RowBox[{
        RowBox[{"the", " ", "speed", " ", "at", " ", "which", " ", "level"}], 
        "-", 
        RowBox[{
        "2", " ", "rotations", " ", "can", " ", "be", " ", "performed", " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["t", "L1"], " ", "in", " ", "the", " ", "paper"}], 
          ")"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"l1time", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"6", 
         RowBox[{
          RowBox[{"dm", "/", 
           RowBox[{"(", 
            RowBox[{"nl1", "/", "2"}], ")"}]}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", "pfail"}], ")"}]}]}], ",", "dm2"}], "]"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Define", " ", "lmove"}], ",", " ", 
       RowBox[{
        RowBox[{"the", " ", "effective", " ", "width"}], "-", 
        RowBox[{"dm2", " ", "region", " ", "a", " ", "level"}], "-", 
        RowBox[{
        "1", " ", "state", " ", "needs", " ", "to", " ", "traverse", " ", 
         "before", " ", "reaching", " ", "the", " ", "level"}], "-", 
        RowBox[{"2", " ", "block"}]}], ",", " ", 
       RowBox[{
       "picking", " ", "up", " ", "additional", " ", "storage", " ", 
        "errors"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"lmove", "=", 
      RowBox[{
       RowBox[{"10", "dm2"}], "+", 
       RowBox[{
        RowBox[{"nl1", "/", "4"}], "*", 
        RowBox[{"(", 
         RowBox[{"dx", "+", 
          RowBox[{"4", "dz"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "1", " ", "of", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"15", "-", "to", "-", "1"}], ")"}], "\[ImplicitPlus]"}], 
        "\[Times]", 
        RowBox[{"\[ImplicitPlus]", 
         RowBox[{"(", 
          RowBox[{"8", "-", "to", "-", "CCZ"}], ")"}]}], " ", "protocol", " ",
         "applying", " ", "rotations", " ", "1"}], "-", "2"}], " ", "*)"}], 
     " ", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Last", " ", 
       RowBox[{"operation", ":", " ", 
        RowBox[{
         RowBox[{
         "apply", " ", "addditional", " ", "storage", " ", "errors", " ", 
          "due", " ", "to", " ", "multi"}], "-", 
         RowBox[{"patch", " ", "measurements"}]}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"Init4Qubit", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "one", ",", "one", ",", "z"}], "}"}], ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", "dx2"}], "+", "dz2", "+", "dm2"}], ")"}], "dx2"}], 
           "dm2"], "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "one", ",", 
          RowBox[{"-", "z"}]}], "}"}], ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dz2", "+", "dm2"}], ")"}], "dx2"}], "dm2"], "pm2"}]}], 
        ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ4Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", "dx2"}], "+", "dz2", "+", "dm2"}], ")"}], "dx2"], 
         "px2", " ", "dm2"}], ",", "0", ",", "0", ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX4Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", "0", ",", "0", 
        ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ4Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", "0", ",", "0", 
        ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "2"}], ":", " ", 
       RowBox[{
        RowBox[{"apply", " ", "rotations", " ", "3"}], "-", "4"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "z"}], ",", "z", ",", "one", ",", "z"}], "}"}], ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", "dx2"}], "+", "dz2", "+", "dm2"}], ")"}], "dx2"}], 
           "dm2"], "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "z"}], ",", "one", ",", "z", ",", "z"}], "}"}], ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", "dx2"}], "+", "dz2", "+", "dm2"}], ")"}], "dx2"}], 
           "dm2"], "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ4Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", "dx2"}], "+", "dz2", "+", "dm2"}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", "dx2"}], "+", "dz2", "+", "dm2"}], ")"}]}], "dx2"], 
         "px2", " ", "dm2"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", "dx2"}], "+", "dz2", "+", "dm2"}], ")"}], "dx2"], 
         "px2", " ", "dm2"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", "dx2"}], "+", "dz2", "+", "dm2"}], ")"}], "dx2"], 
         "px2", " ", "dm2"}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX4Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ4Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "3"}], ":", " ", 
       RowBox[{
        RowBox[{"apply", " ", "rotations", " ", "5"}], "-", "6"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "z", ",", "z", ",", "z"}], "}"}], ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", "dx2"}], "+", "dz2", "+", "dm2"}], ")"}], "dx2"}], 
           "dm2"], "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", 
          RowBox[{"-", "z"}], ",", "z", ",", "z"}], "}"}], ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "dx2"}], "+", "dz2", "+", "dm2"}], ")"}], "dx2"}], 
           "dm2"], "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ4Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", "dx2"}], "+", "dz2", "+", "dm2"}], ")"}], "dx2"], 
         "px2", " ", "dm2"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", "dx2"}], "+", "dz2", "+", "dm2"}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "dx2"}], "+", "dz2", "+", "dm2"}], ")"}]}], "dx2"], 
         "px2", " ", "dm2"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", "dx2"}], "+", "dz2", "+", "dm2"}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "dx2"}], "+", "dz2", "+", "dm2"}], ")"}]}], "dx2"], 
         "px2", " ", "dm2"}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Qubit", " ", "1", " ", "is", " ", "consumed", " ", "as", " ", "an", 
       " ", "output", " ", 
       RowBox[{"state", ":", " ", 
        RowBox[{
        "additional", " ", "storage", " ", "errors", " ", "for", " ", "dx2", 
         " ", "code", " ", "cycles"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX4Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"dm2", "+", 
           RowBox[{"2", "dx2"}]}], ")"}], "px2"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ4Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"dm2", "+", 
           RowBox[{"2", "dx2"}]}], ")"}], "px2"}], " ", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "4"}], ":", " ", 
       RowBox[{
        RowBox[{"apply", " ", "rotations", " ", "7"}], "-", "8"}]}], " ", 
      "*)"}], " ", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "z", ",", "one", ",", "z"}], "}"}], ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", "dx2"}], "+", "dz2", "+", "dm2"}], ")"}], "dx2"}], 
           "dm2"], "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "z", ",", "z"}], "}"}], ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx2", "+", "dz2", "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ4Qubit", "[", 
       RowBox[{"out2", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", "dx2"}], "+", "dz2", "+", "dm2"}], ")"}], "dx2"], 
         "px2", " ", "dm2"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"dx2", "+", "dz2", "+", "dm2"}], ")"}], "dx2"], "px2", " ",
          "dm2"}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Qubit", " ", "2", " ", "is", " ", "consumed", " ", "as", " ", "an", 
       " ", "output", " ", 
       RowBox[{"state", ":", " ", 
        RowBox[{
        "additional", " ", "storage", " ", "errors", " ", "for", " ", "dx2", 
         " ", "code", " ", "cycles"}]}]}], " ", "*)"}], " ", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Qubit", " ", "3", " ", "is", " ", "consumed", " ", "as", " ", "an", 
       " ", "output", " ", "state", " ", "in", " ", "the", " ", "following", 
       " ", 
       RowBox[{"step", ":", " ", 
        RowBox[{
        "additional", " ", "storage", " ", "errors", " ", "for", " ", "dx2", 
         " ", "code", " ", "cycles"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX4Qubit", "[", 
       RowBox[{"out2", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"dm2", "+", 
           RowBox[{"2", "dx2"}]}], ")"}], "px2"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "px2", " ", "l1time"}], "+", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"dm2", "+", 
            RowBox[{"2", "dx2"}]}], ")"}], "px2"}]}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ4Qubit", "[", 
       RowBox[{"out2", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"dm2", "+", 
           RowBox[{"2", "dx2"}]}], ")"}], "px2"}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "px2", " ", "l1time"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", 
           RowBox[{"dm2", "+", 
            RowBox[{"2", "dx2"}]}], ")"}], "px2"}]}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Compute", " ", "level"}], "-", 
        RowBox[{
        "2", " ", "failure", " ", "probability", " ", "as", " ", "the", " ", 
         "probability", " ", "to", " ", "measure", " ", "qubit", " ", "4", 
         " ", "in", " ", "the"}]}], " ", "|", 
       RowBox[{"+", 
        RowBox[{">", " ", "state"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pfail2", "=", 
      RowBox[{"Re", "[", 
       RowBox[{"1", "-", 
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{"one", ",", "one", ",", "one", ",", "ProjX"}], "]"}], ".", 
          "out2"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "Compute", " ", "the", " ", "density", " ", "matrix", " ", "of", " ", 
         "the", " ", "post"}], "-", 
        RowBox[{"selected", " ", "output", " ", "state"}]}], ",", " ", 
       RowBox[{"i", ".", "e", "."}], ",", " ", 
       RowBox[{
        RowBox[{
        "after", " ", "projecting", " ", "qubit", " ", "4", " ", "into"}], 
        " ", "|", 
        RowBox[{"+", ">"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"OutPostSel2", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", "pfail2"}]], 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"one", ",", "one", ",", "one", ",", "ProjX"}], "]"}], ".", 
        "out2", ".", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"one", ",", "one", ",", "one", ",", "ProjX"}], "]"}], 
         "\[HermitianConjugate]"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Compute", " ", "level"}], "-", 
       RowBox[{
       "2", " ", "output", " ", "error", " ", "from", " ", "the", " ", 
        "infidelity", " ", "between", " ", "the", " ", "post"}], "-", 
       RowBox[{
       "selected", " ", "state", " ", "and", " ", "the", " ", "ideal", " ", 
        "output", " ", "state"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pout", "=", 
      RowBox[{"(", 
       RowBox[{"Re", "[", 
        RowBox[{"1", "-", 
         RowBox[{"Tr", "[", 
          RowBox[{"OutPostSel2", ".", "IdealCCZ"}], "]"}]}], "]"}], ")"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Full", "-", 
       RowBox[{"distance", " ", 
        RowBox[{"computation", ":", " ", 
         RowBox[{
          RowBox[{
          "determine", " ", "full", " ", "distance", " ", "required", " ", 
           "for", " ", "a", " ", "100"}], "-", 
          RowBox[{"qubit", "/", "10000"}], "-", 
          RowBox[{"qubit", " ", "computation"}]}]}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"reqdist1", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Round", "[", 
          RowBox[{"d", ",", "2"}], "]"}], "+", "1"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"Quiet", "[", 
         RowBox[{"Solve", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"231.", "/", 
               RowBox[{"(", 
                RowBox[{"pout", "/", "4"}], ")"}]}], "*", "d", "*", 
              RowBox[{"plog", "[", 
               RowBox[{"pphys", ",", "d"}], "]"}]}], "\[Equal]", "0.01"}], 
            ",", 
            RowBox[{"d", ">", "1"}]}], "}"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"reqdist2", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Round", "[", 
          RowBox[{"d", ",", "2"}], "]"}], "+", "1"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"Quiet", "[", 
         RowBox[{"Solve", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"20284.", "/", 
               RowBox[{"(", 
                RowBox[{"pout", "/", "4"}], ")"}]}], "*", "d", "*", 
              RowBox[{"plog", "[", 
               RowBox[{"pphys", ",", "d"}], "]"}]}], "\[Equal]", "0.01"}], 
            ",", 
            RowBox[{"d", ">", "1"}]}], "}"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Print", " ", "output", " ", "error"}], ",", " ", 
       RowBox[{"failure", " ", "probability"}], ",", " ", 
       RowBox[{"space", " ", "cost"}], ",", " ", 
       RowBox[{
        RowBox[{"time", " ", "cost", " ", "and", " ", "space"}], "-", 
        RowBox[{"time", " ", "cost"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ncycles", "=", 
      RowBox[{"4", "*", "l1time"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<(15-to-1\!\(\*SubscriptBox[SuperscriptBox[\()\), \(`7`\)], \(`1`, \
`2`, `3`\)]\)\[Times](8-to-CCZ\!\(\*SubscriptBox[\()\), \(`4`, `5`, `6`\)]\) \
with \!\(\*SubscriptBox[\(p\), \(phys\)]\)=`8`, \!\(\*SubscriptBox[\(d\), \(x\
\)]\)=`1`, \!\(\*SubscriptBox[\(d\), \(z\)]\)=`2`, \!\(\*SubscriptBox[\(d\), \
\(m\)]\)=`3`, \!\(\*SubscriptBox[\(d\), \(x2\)]\)=`4`, \!\(\*SubscriptBox[\(d\
\), \(z2\)]\)=`5`, \!\(\*SubscriptBox[\(d\), \(m2\)]\)=`6` and \
\!\(\*SubscriptBox[\(n\), \(L1\)]\)=`7`\>\"", ",", "dx", ",", "dz", ",", "dm",
         ",", "dx2", ",", "dz2", ",", "dm2", ",", "nl1", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{"N", "[", "pphys", "]"}], "]"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<Output error: \!\(\*SubscriptBox[\(p\), \(out\)]\) = `1`\>\"", 
        ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{"pout", ",", "4"}], "]"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<Failure probability: \!\(\*SubscriptBox[\(p\), \(fail\)]\) = \
`1`\>\"", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{"pfail2", ",", "4"}], "]"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{"\"\<Space cost: `1` qubits\>\"", ",", 
        RowBox[{"2", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", "dx2", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", "dx2"}], "+", "dz2"}], ")"}]}], "+", 
           RowBox[{"2", "dx2", " ", "dm2"}], "+", 
           RowBox[{"20", 
            SuperscriptBox["dm2", "2"]}], "+", 
           RowBox[{
            RowBox[{"nl1", "/", "2"}], " ", "dm2", 
            RowBox[{"(", 
             RowBox[{"dx", "+", 
              RowBox[{"4", "dz"}]}], ")"}]}], "+", 
           RowBox[{"nl1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", "dx", 
               RowBox[{"(", 
                RowBox[{"dx", "+", 
                 RowBox[{"4", "dz"}]}], ")"}]}], "+", 
              RowBox[{"2", "dm"}]}], ")"}]}]}], ")"}]}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{"\"\<Time cost: `1` code cycles\>\"", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"ncycles", "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", "pfail2"}], ")"}]}], ",", "4"}], "]"}], ",", 
          "4"}], "]"}]}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<Spacetime cost: `1` qubitcycles per output state\>\"", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{
          RowBox[{"2", "*", "ncycles", "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", "dx2", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"3", "dx2"}], "+", "dz2"}], ")"}]}], "+", 
              RowBox[{"2", "dx2", " ", "dm2"}], "+", 
              RowBox[{"20", 
               SuperscriptBox["dm2", "2"]}], "+", 
              RowBox[{
               RowBox[{"nl1", "/", "2"}], " ", "dm2", 
               RowBox[{"(", 
                RowBox[{"dx", "+", 
                 RowBox[{"4", "dz"}]}], ")"}]}], "+", 
              RowBox[{"nl1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"3", "dx", 
                  RowBox[{"(", 
                   RowBox[{"dx", "+", 
                    RowBox[{"4", "dz"}]}], ")"}]}], "+", 
                 RowBox[{"2", "dm"}]}], ")"}]}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"1", "-", "pfail2"}], ")"}]}]}], ",", "4"}], "]"}]}], 
       "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<For a 100-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \
\(3\)]\) (d=`2`)\>\"", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{
          RowBox[{"ncycles", "*", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", "dx2", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", "dx2"}], "+", "dz2"}], ")"}]}], "+", 
               RowBox[{"2", "dx2", " ", "dm2"}], "+", 
               RowBox[{"20", 
                SuperscriptBox["dm2", "2"]}], "+", 
               RowBox[{
                RowBox[{"nl1", "/", "2"}], " ", "dm2", 
                RowBox[{"(", 
                 RowBox[{"dx", "+", 
                  RowBox[{"4", "dz"}]}], ")"}]}], "+", 
               RowBox[{"nl1", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", "dx", 
                   RowBox[{"(", 
                    RowBox[{"dx", "+", 
                    RowBox[{"4", "dz"}]}], ")"}]}], "+", 
                  RowBox[{"2", "dm"}]}], ")"}]}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", "pfail2"}], ")"}]}], "/", 
            SuperscriptBox["reqdist1", "3"]}]}], ",", "4"}], "]"}], ",", 
        "reqdist1"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<For a 10000-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\
\)]\) (d=`2`)\>\"", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{
          RowBox[{"ncycles", "*", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", "dx2", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", "dx2"}], "+", "dz2"}], ")"}]}], "+", 
               RowBox[{"2", "dx2", " ", "dm2"}], "+", 
               RowBox[{"20", 
                SuperscriptBox["dm2", "2"]}], "+", 
               RowBox[{
                RowBox[{"nl1", "/", "2"}], " ", "dm2", 
                RowBox[{"(", 
                 RowBox[{"dx", "+", 
                  RowBox[{"4", "dz"}]}], ")"}]}], "+", 
               RowBox[{"nl1", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", "dx", 
                   RowBox[{"(", 
                    RowBox[{"dx", "+", 
                    RowBox[{"4", "dz"}]}], ")"}]}], "+", 
                  RowBox[{"2", "dm"}]}], ")"}]}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", "pfail2"}], ")"}]}], "/", 
            SuperscriptBox["reqdist2", "3"]}]}], ",", "4"}], "]"}], ",", 
        "reqdist2"}], "]"}], "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7647818804197054`*^9, 3.7647827170147686`*^9}, {
   3.7647827526955023`*^9, 3.7647828037704153`*^9}, {3.7647828777323666`*^9, 
   3.7647828873914766`*^9}, {3.7647829679315805`*^9, 
   3.7647829900869355`*^9}, {3.7647871135993786`*^9, 
   3.7647871181582265`*^9}, {3.764787190717695*^9, 3.764787200944683*^9}, {
   3.7647873644636497`*^9, 3.764787367155138*^9}, {3.764787633161899*^9, 
   3.7647876340330133`*^9}, {3.7647878225096235`*^9, 3.764787862191*^9}, {
   3.7647879242683935`*^9, 3.7647879930332327`*^9}, {3.764788058807067*^9, 
   3.764788075720792*^9}, {3.7647881167285376`*^9, 3.764788142210624*^9}, {
   3.764788291676242*^9, 3.7647882948313284`*^9}, {3.7647883336337533`*^9, 
   3.7647884153493524`*^9}, {3.764788471735753*^9, 3.764788553968379*^9}, {
   3.76478860007366*^9, 3.7647886032600193`*^9}, {3.764788650970973*^9, 
   3.76478865225884*^9}, {3.764788687690465*^9, 3.7647888074508295`*^9}, 
   3.7647890371016693`*^9, {3.7647910398756876`*^9, 3.764791041680471*^9}, {
   3.7647927308215084`*^9, 3.7647927392748613`*^9}, {3.764836936063066*^9, 
   3.7648369373427343`*^9}, {3.7648371149912577`*^9, 
   3.7648371520010333`*^9}, {3.764837192630989*^9, 3.764837246990443*^9}, {
   3.764837292679697*^9, 3.764837561577086*^9}, {3.7648376137170515`*^9, 
   3.764837626786128*^9}, {3.764837776414965*^9, 3.7648377771550064`*^9}, {
   3.7648378584837637`*^9, 3.7648378596546526`*^9}, 3.7648381381116133`*^9, {
   3.7648385433691854`*^9, 3.7648385461078453`*^9}, {3.764839124661582*^9, 
   3.7648391255315237`*^9}, {3.7648407410464044`*^9, 3.764840774300714*^9}, 
   3.7649450465021024`*^9, {3.7649451775238504`*^9, 3.7649451850706306`*^9}, {
   3.7651058585588007`*^9, 3.765105858871297*^9}, {3.7654100708932204`*^9, 
   3.7654100868305235`*^9}, {3.765410363689436*^9, 3.765410365298794*^9}, {
   3.765731627620652*^9, 3.7657316619754124`*^9}, {3.765731694171874*^9, 
   3.7657317937692823`*^9}, {3.7657318605024447`*^9, 3.765731886906804*^9}, {
   3.7657319501211176`*^9, 3.765732011064172*^9}, 3.7657320417981153`*^9, {
   3.7660087764034815`*^9, 3.7660088275590115`*^9}, {3.766182177561737*^9, 
   3.766182193303589*^9}, {3.76618223526667*^9, 3.766182530272134*^9}, {
   3.766182619638466*^9, 3.7661826226464195`*^9}, 3.7662473780257177`*^9, {
   3.7662485727091722`*^9, 3.766248588365212*^9}, {3.7663562328331017`*^9, 
   3.766356233087018*^9}, {3.766359320401349*^9, 3.766359533825001*^9}, {
   3.7663603138928676`*^9, 3.766360426931602*^9}, {3.7663604597827725`*^9, 
   3.7663604629737225`*^9}, {3.7663917834584513`*^9, 3.766391817504915*^9}, {
   3.7664024625483456`*^9, 3.7664025619556313`*^9}, {3.766690103725995*^9, 
   3.766690107860632*^9}, {3.7666922400305862`*^9, 3.7666922441412983`*^9}, {
   3.76669542061633*^9, 3.76669545545397*^9}, {3.7666955013894234`*^9, 
   3.766695758003832*^9}, {3.766695800898983*^9, 3.766695806271508*^9}, {
   3.7666958468878613`*^9, 3.766695870227413*^9}, {3.7666959176316147`*^9, 
   3.766695919480604*^9}, {3.7666959881149235`*^9, 3.766696029655519*^9}, 
   3.7666960911191263`*^9, {3.766696122299642*^9, 3.766696138311446*^9}, {
   3.7666962558575907`*^9, 3.7666964057000504`*^9}, {3.766704036642918*^9, 
   3.7667040399611177`*^9}, 3.766704189528962*^9, {3.7667061970362177`*^9, 
   3.7667064572004128`*^9}, {3.76670723218001*^9, 3.76670724459264*^9}, {
   3.772748028277151*^9, 3.7727480946482797`*^9}, {3.7727481754014454`*^9, 
   3.7727483775425377`*^9}, {3.772748425073881*^9, 3.7727484545633607`*^9}, {
   3.77275140482413*^9, 3.7727514281838603`*^9}, {3.772892392242051*^9, 
   3.772892397241624*^9}, {3.7729230466011915`*^9, 3.7729230501452885`*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"60078593-e9e7-49ab-a3f7-598cc35e5bdf"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Small-footprint protocols", "Title",
 InitializationCell->True,
 CellChangeTimes->{{3.766523084124572*^9, 3.7665230894198265`*^9}, {
  3.7665231201077113`*^9, 3.7665231263246613`*^9}, {3.7665231897407603`*^9, 
  3.7665232394023886`*^9}, {3.7667057533132915`*^9, 
  3.766705754977744*^9}},ExpressionUUID->"36b7e4b4-fd7c-46de-a5fb-\
9989ca393b3c"],

Cell[CellGroupData[{

Cell[TextData[{
 "Calculates the output error and space-time cost of the small-footprint ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"(", 
     RowBox[{"15", "-", "to", "-", "1"}], ")"}], 
    RowBox[{
     SubscriptBox["d", "x"], ",", " ", 
     SubscriptBox["d", "z"], ",", " ", 
     SubscriptBox["d", "m"]}]], TraditionalForm]],ExpressionUUID->
  "989180c7-e61f-437a-acd4-1568370a7329"],
 " protocol with a physical error rate ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["p", "phys"], TraditionalForm]],ExpressionUUID->
  "134d0c7b-0f6d-414c-827e-36572399120d"],
 "."
}], "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.764798548319666*^9, 3.764798559642825*^9}, {
  3.7647987276519747`*^9, 3.7647987320112915`*^9}, {3.764798772566616*^9, 
  3.7647988107091117`*^9}, {3.7647988980432377`*^9, 3.764798943550701*^9}, {
  3.76670648049269*^9, 
  3.766706485363364*^9}},ExpressionUUID->"e3e6bdec-a6c9-431d-bb71-\
03483ba9a798"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CostOfOneLevel15to1SmallFootprint", "[", 
   RowBox[{"pphys_", ",", "dx_", ",", "dz_", ",", "dm_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "output", ",", "OutPostSel", ",", "pout", ",", "pfail", ",", "reqdist1", 
      ",", "reqdist2", ",", "px", ",", "pz", ",", "pm"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Introduce", " ", "shorthand", " ", "notation", " ", "for", " ", 
      "logical", " ", "error", " ", "rate", " ", "with", " ", "distances", 
      " ", 
      RowBox[{
       RowBox[{"dx", "/", "dz"}], "/", "dm"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"px", "=", 
      RowBox[{"plog", "[", 
       RowBox[{"pphys", ",", "dx"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pz", "=", 
      RowBox[{"plog", "[", 
       RowBox[{"pphys", ",", "dz"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pm", "=", 
      RowBox[{"plog", "[", 
       RowBox[{"pphys", ",", "dm"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "1", " ", "of", " ", "15"}], "-", "to", "-", 
       RowBox[{
       "1", " ", "protocol", " ", "applying", " ", "rotations", " ", "1"}], 
       "-", "3"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"Init5Qubit", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "z", ",", "one", ",", "one", ",", "one"}], "}"}],
         ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox["dm", "dz"], "pz", " ", "dm"}]}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "dz", " ", "pm"}]}], ",", 
        RowBox[{"pphys", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "z", ",", "one", ",", "one"}], "}"}],
         ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox["dm", "dz"], "pz", " ", "dm"}]}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "dz", " ", "pm"}]}], ",", 
        RowBox[{"pphys", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "one", ",", "z", ",", "one"}], "}"}],
         ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox["dm", "dz"], "pz", " ", "dm"}]}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "dz", " ", "pm"}]}], ",", 
        RowBox[{"pphys", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "dm", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"output", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", "0"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"output", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", "0"}], "]"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "2"}], ":", 
       RowBox[{"apply", " ", "rotation", " ", "5"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "z", ",", "z", ",", "z", ",", "one"}], "}"}], 
        ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}]}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{"3", "dz", "*", "dx"}], "dm"], " ", "pm"}]}], ",", 
        RowBox[{"pphys", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "dm", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"output", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", "0"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"output", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", "0"}], "]"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "3"}], ":", " ", 
       RowBox[{"apply", " ", "rotation", " ", "6"}]}], " ", "*)"}], 
     RowBox[{"(*", " ", 
      RowBox[{"Last", " ", 
       RowBox[{"operation", ":", " ", 
        RowBox[{
         RowBox[{
         "apply", " ", "addditional", " ", "storage", " ", "errors", " ", 
          "due", " ", "to", " ", "multi"}], "-", 
         RowBox[{"patch", " ", "measurements"}]}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "z", ",", "z", ",", "one", ",", "one"}], "}"}], 
        ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}]}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx", "+", 
              RowBox[{"2", "dz"}]}], ")"}], "*", "dx"}], "dm"], " ", "pm"}]}],
         ",", 
        RowBox[{"pphys", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"dx", "+", 
            RowBox[{"2", "dz"}]}], ")"}], "dx"], "px", " ", "dm"}], ",", "0", 
        ",", "0", ",", "0", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "dm", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", "0"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", "0"}], "]"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "4"}], ":", " ", 
       RowBox[{"apply", " ", "rotation", " ", "7"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "z", ",", "one", ",", "z", ",", "one"}], "}"}], 
        ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}]}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx", "+", 
              RowBox[{"3", "dz"}]}], ")"}], "*", "dx"}], "dm"], " ", "pm"}]}],
         ",", 
        RowBox[{"pphys", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"dx", "+", 
            RowBox[{"3", "dz"}]}], ")"}], "dx"], "px", " ", "dm"}], ",", "0", 
        ",", "0", ",", "0", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "dm", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", "0"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", "0"}], "]"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "5"}], ":", " ", 
       RowBox[{"apply", " ", "rotations", " ", "4", " ", "and", " ", "8"}]}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "one", ",", "z", ",", "z", ",", "one"}], "}"}], 
        ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}]}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx", "+", 
              RowBox[{"3", "dz"}]}], ")"}], "*", "dx"}], "dm"], " ", "pm"}]}],
         ",", 
        RowBox[{"pphys", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "one", ",", "one", ",", "z"}], "}"}],
         ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox["dm", "dz"], "pz", " ", "dm"}]}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "dz", " ", "pm"}]}], ",", 
        RowBox[{"pphys", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"dx", "+", 
            RowBox[{"3", "dz"}]}], ")"}], "dx"], "px", " ", "dm"}], ",", "0", 
        ",", "0", ",", "0", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "dm", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "6"}], ":", " ", 
       RowBox[{"apply", " ", "rotation", " ", "9"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "one", ",", "one", ",", "z", ",", "z"}], "}"}], 
        ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}]}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx", "+", 
              RowBox[{"4", "dz"}]}], ")"}], "*", "dx"}], "dm"], " ", "pm"}]}],
         ",", 
        RowBox[{"pphys", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"dx", "+", 
            RowBox[{"4", "dz"}]}], ")"}], "dx"], "px", " ", "dm"}], ",", "0", 
        ",", "0", ",", "0", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "dm", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "7"}], ":", 
       RowBox[{"apply", " ", "rotation", " ", "10"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "z", ",", "one", ",", "one", ",", "z"}], "}"}], 
        ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}]}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx", "+", 
              RowBox[{"4", "dz"}]}], ")"}], "*", "dx"}], "dm"], " ", "pm"}]}],
         ",", 
        RowBox[{"pphys", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"dx", "+", 
            RowBox[{"4", "dz"}]}], ")"}], "dx"], "px", " ", "dm"}], ",", "0", 
        ",", "0", ",", "0", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "dm", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "8"}], ":", " ", 
       RowBox[{"apply", " ", "rotation", " ", "11"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "one", ",", "z", ",", "one", ",", "z"}], "}"}], 
        ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}]}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx", "+", 
              RowBox[{"4", "dz"}]}], ")"}], "*", "dx"}], "dm"], " ", "pm"}]}],
         ",", 
        RowBox[{"pphys", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"dx", "+", 
            RowBox[{"4", "dz"}]}], ")"}], "dx"], "px", " ", "dm"}], ",", "0", 
        ",", "0", ",", "0", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "dm", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "9"}], ":", " ", 
       RowBox[{"apply", " ", "rotation", " ", "12"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "z", ",", "z", ",", "z", ",", "z"}], "}"}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}]}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx", "+", 
              RowBox[{"4", "dz"}]}], ")"}], "*", "dx"}], "dm"], " ", "pm"}]}],
         ",", 
        RowBox[{"pphys", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"dx", "+", 
            RowBox[{"4", "dz"}]}], ")"}], "dx"], "px", " ", "dm"}], ",", "0", 
        ",", "0", ",", "0", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "dm", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "10"}], ":", " ", 
       RowBox[{"apply", " ", "rotation", " ", "13"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "z", ",", "z", ",", "z"}], "}"}], 
        ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}]}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"3", "dz"}], ")"}], "*", "dx"}], "dm"], " ", "pm"}]}], 
        ",", 
        RowBox[{"pphys", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "dm", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "11"}], ":", " ", 
       RowBox[{"apply", " ", "rotation", " ", "14"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "z", ",", "one", ",", "z", ",", "z"}], "}"}], 
        ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}]}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"4", "dz"}], ")"}], "*", "dx"}], "dm"], " ", "pm"}]}], 
        ",", 
        RowBox[{"pphys", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "dm", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "12"}], ":", " ", 
       RowBox[{"apply", " ", "rotation", " ", "15"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"output", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "z", ",", "z", ",", "one", ",", "z"}], "}"}], 
        ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}]}], ",", 
        RowBox[{
         RowBox[{"pphys", "/", "3"}], "+", 
         RowBox[{
          FractionBox["1", "2"], "pm", " ", "dm"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"4", "dz"}], ")"}], "*", "dx"}], "dm"], " ", "pm"}]}], 
        ",", 
        RowBox[{"pphys", "/", "3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "dm", " ", 
       "code", " ", "cycles"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Qubit", " ", "1", " ", "is", " ", "consumed", " ", "as", " ", "an", 
       " ", "output", " ", "state", " ", "in", " ", "the", " ", "following", 
       " ", 
       RowBox[{"step", ":", " ", 
        RowBox[{
        "additional", " ", "storage", " ", "errors", " ", "for", " ", "dx", 
         " ", "code", " ", "cycles"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], "px", " ", 
         RowBox[{"(", 
          RowBox[{"dm", "+", 
           RowBox[{"2", "dx"}]}], ")"}]}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz", "dx"], "px", " ", "dm"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"output", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"output", ",", 
        RowBox[{
         FractionBox["1", "2"], "px", " ", 
         RowBox[{"(", 
          RowBox[{"dm", "+", 
           RowBox[{"2", "dx"}]}], ")"}]}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx", "dz"], "pz", " ", "dm"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "Compute", " ", "failure", " ", "probability", " ", "as", " ", "the", 
         " ", "probability", " ", "to", " ", "measure", " ", "qubits", " ", 
         "2"}], "-", 
        RowBox[{"5", " ", "in", " ", "the"}]}], " ", "|", 
       RowBox[{"+", 
        RowBox[{">", " ", "state"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pfail", "=", 
      RowBox[{"Re", "[", 
       RowBox[{"1", "-", 
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{
           "one", ",", "ProjX", ",", "ProjX", ",", "ProjX", ",", "ProjX"}], 
           "]"}], ".", "output"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "Compute", " ", "the", " ", "density", " ", "matrix", " ", "of", " ", 
         "the", " ", "post"}], "-", 
        RowBox[{"selected", " ", "output", " ", "state"}]}], ",", " ", 
       RowBox[{"i", ".", "e", "."}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"after", " ", "projecting", " ", "qubits", " ", "2"}], "-", 
         RowBox[{"5", " ", "into"}]}], " ", "|", 
        RowBox[{"+", ">"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"OutPostSel", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", "pfail"}]], 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
         "one", ",", "ProjX", ",", "ProjX", ",", "ProjX", ",", "ProjX"}], 
         "]"}], ".", "output", ".", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{
          "one", ",", "ProjX", ",", "ProjX", ",", "ProjX", ",", "ProjX"}], 
          "]"}], "\[HermitianConjugate]"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Compute", " ", "output", " ", "error", " ", "from", " ", "the", " ", 
        "infidelity", " ", "between", " ", "the", " ", "post"}], "-", 
       RowBox[{
       "selected", " ", "state", " ", "and", " ", "the", " ", "ideal", " ", 
        "output", " ", "state"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pout", "=", 
      RowBox[{"Re", "[", 
       RowBox[{"1", "-", 
        RowBox[{"Tr", "[", 
         RowBox[{"OutPostSel", ".", "Ideal15to1"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Full", "-", 
       RowBox[{"distance", " ", 
        RowBox[{"computation", ":", " ", 
         RowBox[{
          RowBox[{
          "determine", " ", "full", " ", "distance", " ", "required", " ", 
           "for", " ", "a", " ", "100"}], "-", 
          RowBox[{"qubit", "/", "10000"}], "-", 
          RowBox[{"qubit", " ", "computation"}]}]}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"reqdist1", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Round", "[", 
          RowBox[{"d", ",", "2"}], "]"}], "+", "1"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"Quiet", "[", 
         RowBox[{"Solve", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"231.", "/", "pout"}], "*", "d", "*", 
              RowBox[{"plog", "[", 
               RowBox[{"pphys", ",", "d"}], "]"}]}], "\[Equal]", "0.01"}], 
            ",", 
            RowBox[{"d", ">", "1"}]}], "}"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"reqdist2", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Round", "[", 
          RowBox[{"d", ",", "2"}], "]"}], "+", "1"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"Quiet", "[", 
         RowBox[{"Solve", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"20284.", "/", "pout"}], "*", "d", "*", 
              RowBox[{"plog", "[", 
               RowBox[{"pphys", ",", "d"}], "]"}]}], "\[Equal]", "0.01"}], 
            ",", 
            RowBox[{"d", ">", "1"}]}], "}"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Print", " ", "output", " ", "error"}], ",", " ", 
       RowBox[{"failure", " ", "probability"}], ",", " ", 
       RowBox[{"space", " ", "cost"}], ",", " ", 
       RowBox[{
        RowBox[{"time", " ", "cost", " ", "and", " ", "space"}], "-", 
        RowBox[{"time", " ", "cost"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<Small-footprint (15-to-1\!\(\*SubscriptBox[\()\), \(`1`, `2`, `3`\
\)]\) with \!\(\*SubscriptBox[\(p\), \(phys\)]\)=`4`, \
\!\(\*SubscriptBox[\(d\), \(x\)]\)=`1`, \!\(\*SubscriptBox[\(d\), \
\(z\)]\)=`2` and \!\(\*SubscriptBox[\(d\), \(m\)]\)=`3`\>\"", ",", "dx", ",", 
        "dz", ",", "dm", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{"N", "[", "pphys", "]"}], "]"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<Output error: \!\(\*SubscriptBox[\(p\), \(out\)]\) = `1`\>\"", 
        ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{"pout", ",", "4"}], "]"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<Failure probability: \!\(\*SubscriptBox[\(p\), \(fail\)]\) = \
`1`\>\"", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{"pfail", ",", "4"}], "]"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{"\"\<Space cost: `1` qubits\>\"", ",", 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "dx", 
            RowBox[{"(", 
             RowBox[{"dx", "+", 
              RowBox[{"4", "dz"}]}], ")"}]}], "+", "dm"}], ")"}]}]}], "]"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{"\"\<Time cost: `1` code cycles\>\"", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{
          RowBox[{"12", 
           RowBox[{"dm", "/", 
            RowBox[{"(", 
             RowBox[{"1", "-", "pfail"}], ")"}]}]}], ",", "4"}], "]"}]}], 
       "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{"\"\<Spacetime cost: `1` qubitcycles\>\"", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "dx", 
              RowBox[{"(", 
               RowBox[{"dx", "+", 
                RowBox[{"4", "dz"}]}], ")"}]}], "+", "dm"}], ")"}], "12", 
           RowBox[{"dm", "/", 
            RowBox[{"(", 
             RowBox[{"1", "-", "pfail"}], ")"}]}]}], ",", "4"}], "]"}]}], 
       "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<For a 100-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \
\(3\)]\) (d=`2`)\>\"", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "dx", 
              RowBox[{"(", 
               RowBox[{"dx", "+", 
                RowBox[{"4", "dz"}]}], ")"}]}], "+", "dm"}], ")"}], "12", 
           RowBox[{
            RowBox[{"dm", "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", "pfail"}], ")"}]}], "/", 
            SuperscriptBox["reqdist1", "3"]}]}], ",", "4"}], "]"}], ",", 
        "reqdist1"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<For a 10000-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\
\)]\) (d=`2`)\>\"", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "dx", 
              RowBox[{"(", 
               RowBox[{"dx", "+", 
                RowBox[{"4", "dz"}]}], ")"}]}], "+", "dm"}], ")"}], "12", 
           RowBox[{
            RowBox[{"dm", "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", "pfail"}], ")"}]}], "/", 
            SuperscriptBox["reqdist2", "3"]}]}], ",", "4"}], "]"}], ",", 
        "reqdist2"}], "]"}], "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7647802407276225`*^9, 3.7647804207083793`*^9}, {
   3.76478045272071*^9, 3.7647805759571714`*^9}, {3.7647806425971437`*^9, 
   3.7647808447829924`*^9}, {3.76479017485603*^9, 3.764790181976259*^9}, {
   3.7647985735332627`*^9, 3.764798704847616*^9}, {3.765640313382701*^9, 
   3.7656403661010776`*^9}, {3.765640462295044*^9, 3.7656404649865856`*^9}, {
   3.765640621364069*^9, 3.765640622166213*^9}, {3.7656586262733164`*^9, 
   3.7656586332236032`*^9}, {3.765663100102337*^9, 3.765663135581234*^9}, {
   3.7656632108747864`*^9, 3.765663393065422*^9}, {3.7657191500215445`*^9, 
   3.76571915038243*^9}, {3.7657191861537237`*^9, 3.765719482437769*^9}, {
   3.7657198962333565`*^9, 3.765719945585207*^9}, 3.765720160986723*^9, {
   3.7657387756711273`*^9, 3.7657387838755445`*^9}, {3.766008204239706*^9, 
   3.766008286676036*^9}, 3.7660871888203983`*^9, {3.7660876608248386`*^9, 
   3.7660877156676483`*^9}, {3.7660877941526146`*^9, 3.766087809079663*^9}, {
   3.7660878572966704`*^9, 3.7660879684617977`*^9}, {3.7660880722403755`*^9, 
   3.766088131243804*^9}, {3.766088188335867*^9, 3.766088307512337*^9}, {
   3.7660883407952995`*^9, 3.766088372338836*^9}, {3.766088452409278*^9, 
   3.766088454977426*^9}, {3.7660885067832413`*^9, 3.7660885633664722`*^9}, {
   3.766088594949997*^9, 3.7660885983198805`*^9}, {3.7660886320956755`*^9, 
   3.766088655667858*^9}, {3.7660890705552425`*^9, 3.7660892281169806`*^9}, {
   3.766095657942374*^9, 3.7660956616298227`*^9}, {3.7660974606323366`*^9, 
   3.7660974886648693`*^9}, {3.7660975236643744`*^9, 3.766097555556326*^9}, {
   3.7660976038525143`*^9, 3.7660976353382397`*^9}, {3.766097668948866*^9, 
   3.766097702667136*^9}, {3.7660979317957473`*^9, 3.766097934686331*^9}, {
   3.7660979783736906`*^9, 3.7660980211871815`*^9}, {3.7660981132983246`*^9, 
   3.766098132064804*^9}, {3.766098207676673*^9, 3.7660982659126797`*^9}, {
   3.7660984187751117`*^9, 3.766098466134986*^9}, {3.7660985328394876`*^9, 
   3.7660985512307234`*^9}, {3.7661388807210283`*^9, 3.766139019462062*^9}, {
   3.7661808830321636`*^9, 3.766180884389025*^9}, {3.7662419847148685`*^9, 
   3.7662419874648304`*^9}, {3.7662420757178087`*^9, 3.766242078450493*^9}, {
   3.766391843810644*^9, 3.7663918472168536`*^9}, {3.7663934385257487`*^9, 
   3.766393464634808*^9}, {3.766393514868576*^9, 3.766393529196529*^9}, {
   3.766393708201577*^9, 3.766394073806537*^9}, {3.766394118493494*^9, 
   3.766394275100977*^9}, {3.766394336475235*^9, 3.766394358787465*^9}, {
   3.766394634643507*^9, 3.7663946458464966`*^9}, 3.7663947209080925`*^9, {
   3.76648415571493*^9, 3.766484166089805*^9}, {3.766484219497402*^9, 
   3.766484355251607*^9}, {3.7666979052701716`*^9, 3.766698169443143*^9}, {
   3.766698224929637*^9, 3.7666985540485296`*^9}, {3.766698623703717*^9, 
   3.7666986846295414`*^9}, {3.766698755837578*^9, 3.7666989014070177`*^9}, {
   3.7666993407409935`*^9, 3.7666993414287653`*^9}, {3.7667040636678343`*^9, 
   3.766704069367486*^9}, 3.766704195436941*^9, {3.76670446659276*^9, 
   3.7667044684653945`*^9}, {3.7667053180988083`*^9, 
   3.7667053187965813`*^9}, {3.7667064932727985`*^9, 3.7667068086630507`*^9}, 
   3.7727502807600565`*^9, {3.7727503296051493`*^9, 3.772750477993802*^9}, {
   3.7727505081288195`*^9, 3.772750538102853*^9}, {3.772750574973339*^9, 
   3.772750795731737*^9}, {3.7728915052488117`*^9, 3.772891510822506*^9}, {
   3.772976073664495*^9, 3.77297609168645*^9}, {3.7729768555417624`*^9, 
   3.7729768590312843`*^9}, 3.7729774361905837`*^9},
 CellLabel->
  "In[104]:=",ExpressionUUID->"7917b973-72c6-4fd1-8170-ad8ae191a475"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Calculates the output error and space-time cost of the small-footprint ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"(", 
     RowBox[{"15", "-", "to", "-", "1"}], ")"}], 
    RowBox[{
     SubscriptBox["d", "x"], ",", " ", 
     SubscriptBox["d", "z"], ",", " ", 
     SubscriptBox["d", "m"]}]], TraditionalForm]],ExpressionUUID->
  "c1178d45-b878-4618-b58e-6b0e3f235768"],
 "\[Times]",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"(", 
     RowBox[{"15", "-", "to", "-", "1"}], ")"}], 
    RowBox[{
     SubscriptBox["d", "x2"], ",", " ", 
     SubscriptBox["d", "z2"], ",", " ", 
     SubscriptBox["d", "m2"]}]], TraditionalForm]],ExpressionUUID->
  "6c641081-703d-4962-be49-375d1759154a"],
 " protocol with a physical error rate ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["p", "phys"], TraditionalForm]],ExpressionUUID->
  "2b087517-3e91-4b9a-b14a-9658753ae46b"],
 "."
}], "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.764798548319666*^9, 3.764798559642825*^9}, {
  3.7647987276519747`*^9, 3.7647987320112915`*^9}, {3.764798772566616*^9, 
  3.7647988107091117`*^9}, {3.7647988980432377`*^9, 3.764798943550701*^9}, {
  3.76670648049269*^9, 3.766706485363364*^9}, {3.7667068280397224`*^9, 
  3.7667068375636253`*^9}},ExpressionUUID->"7f53c6f0-584f-4c62-a439-\
27b858cbe224"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CostOfTwoLevel15to1SmallFootprint", "[", 
   RowBox[{
   "pphys_", ",", "dx_", ",", "dz_", ",", "dm_", ",", "dx2_", ",", "dz2_", 
    ",", "dm2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "out", ",", "out2", ",", "OutPostSel", ",", "OutPostSel2", ",", "pl1", 
      ",", "pout", ",", "l1time", ",", "ncycles", ",", "lmove", ",", "pfail", 
      ",", "pfail2", ",", "reqdist1", ",", "reqdist2", ",", "px2", ",", "pz2",
       ",", "pm2"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Introduce", " ", "shorthand", " ", "notation", " ", "for", " ", 
      "logical", " ", "error", " ", "rate", " ", "with", " ", "distances", 
      " ", 
      RowBox[{
       RowBox[{"dx2", "/", "dz2"}], "/", "dm2"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"px2", "=", 
      RowBox[{"plog", "[", 
       RowBox[{"pphys", ",", "dx2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pz2", "=", 
      RowBox[{"plog", "[", 
       RowBox[{"pphys", ",", "dz2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pm2", "=", 
      RowBox[{"plog", "[", 
       RowBox[{"pphys", ",", "dm2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Compute", " ", "pl1"}], ",", " ", 
       RowBox[{
        RowBox[{"the", " ", "output", " ", "error", " ", "of", " ", "level"}],
         "-", 
        RowBox[{
        "1", " ", "states", " ", "with", " ", "an", " ", "added", " ", "Z", 
         " ", "storage", " ", "error", " ", "to", " ", "the", " ", "output", 
         " ", "state", " ", "from", " ", "moving", " ", "the", " ", "level"}],
         "-", 
        RowBox[{
        "1", " ", "state", " ", "into", " ", "the", " ", "intermediate", " ", 
         "region"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out", "=", 
      RowBox[{"OneLevel15to1", "[", 
       RowBox[{"pphys", ",", "dx", ",", "dz", ",", "dm"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pfail", "=", 
      RowBox[{"Re", "[", 
       RowBox[{"1", "-", 
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{
           "one", ",", "ProjX", ",", "ProjX", ",", "ProjX", ",", "ProjX"}], 
           "]"}], ".", "out"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"OutPostSel", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", "pfail"}]], 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
         "one", ",", "ProjX", ",", "ProjX", ",", "ProjX", ",", "ProjX"}], 
         "]"}], ".", "out", ".", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{
          "one", ",", "ProjX", ",", "ProjX", ",", "ProjX", ",", "ProjX"}], 
          "]"}], "\[HermitianConjugate]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pl1", "=", 
      RowBox[{
       RowBox[{"Rationalize", "[", 
        RowBox[{
         RowBox[{"Re", "[", 
          RowBox[{"1", "-", 
           RowBox[{"Tr", "[", 
            RowBox[{"OutPostSel", ".", "Ideal15to1"}], "]"}]}], "]"}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "50"}]]}], "]"}], "+", 
       RowBox[{"5", "pm2", " ", "dm2"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Compute", " ", "l1time"}], ",", " ", 
       RowBox[{
        RowBox[{"the", " ", "speed", " ", "at", " ", "which", " ", "level"}], 
        "-", 
        RowBox[{
        "2", " ", "rotations", " ", "can", " ", "be", " ", "performed", " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["t", "L1"], " ", "in", " ", "the", " ", "paper"}], 
          ")"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"l1time", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"6", 
         RowBox[{"dm", "/", 
          RowBox[{"(", 
           RowBox[{"1", "-", "pfail"}], ")"}]}]}], ",", 
        RowBox[{"2", "dm2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ncycles", "=", 
      RowBox[{"15", "*", "l1time"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Define", " ", "lmove"}], ",", " ", 
       RowBox[{
        RowBox[{"the", " ", "effective", " ", "width"}], "-", 
        RowBox[{"dm2", " ", "region", " ", "a", " ", "level"}], "-", 
        RowBox[{
        "1", " ", "state", " ", "needs", " ", "to", " ", "traverse", " ", 
         "before", " ", "reaching", " ", "the", " ", "level"}], "-", 
        RowBox[{"2", " ", "block"}]}], ",", " ", 
       RowBox[{
       "picking", " ", "up", " ", "additional", " ", "storage", " ", 
        "errors"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"lmove", "=", 
      RowBox[{"5", "dm2"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "1", " ", "of", " ", "the", " ", "small"}], "-", 
       RowBox[{"footprint", " ", 
        RowBox[{"(", 
         RowBox[{"15", "-", "to", "-", "1"}], ")"}], "\[Times]", 
        RowBox[{"(", 
         RowBox[{"15", "-", "to", "-", "1"}], ")"}], " ", "protocol", " ", 
        "applying", " ", "rotation", " ", "1"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"Init5Qubit", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "z", ",", "one", ",", "one", ",", "one"}], "}"}],
         ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"out2", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", "0", ",", 
        "0", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", "0", ",", 
        "0", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "2"}], ":", " ", 
       RowBox[{"apply", " ", "rotation", " ", "2"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "z", ",", "one", ",", "one"}], "}"}],
         ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"out2", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", "0", ",", 
        "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", "0", ",", 
        "0"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "3"}], ":", " ", 
       RowBox[{"apply", " ", "rotation", " ", "3"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "one", ",", "z", ",", "one"}], "}"}],
         ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"out2", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", "0"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", "0"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "4"}], ":", " ", 
       RowBox[{"apply", " ", "rotation", " ", "4"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "one", ",", "one", ",", "z"}], "}"}],
         ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dz2", "+", "dm2"}], ")"}], "dx2"}], "dm2"], "pm2"}]}], 
        ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"out2", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "5"}], ":", " ", 
       RowBox[{"apply", " ", "rotation", " ", "5"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "z", ",", "z", ",", "one", ",", "one"}], "}"}], 
        ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx2", "+", 
              RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"dx2", "+", 
            RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "dx2"], "px2", " ", 
         "dm2"}], ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "6"}], ":", " ", 
       RowBox[{"apply", " ", "rotation", " ", "6"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "z", ",", "z", ",", "z", ",", "one"}], "}"}], 
        ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "7"}], ":", " ", 
       RowBox[{"apply", " ", "rotation", " ", "7"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "one", ",", "z", ",", "z", ",", "one"}], "}"}], 
        ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx2", "+", 
              RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"dx2", "+", 
            RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "dx2"], "px2", " ", 
         "dm2"}], ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "8"}], ":", " ", 
       RowBox[{"apply", " ", "rotation", " ", "8"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "z", ",", "one", ",", "z", ",", "one"}], "}"}], 
        ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx2", "+", 
              RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"dx2", "+", 
            RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "dx2"], "px2", " ", 
         "dm2"}], ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "9"}], ":", " ", 
       RowBox[{"apply", " ", "rotation", " ", "9"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "z", ",", "one", ",", "one", ",", "z"}], "}"}], 
        ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx2", "+", 
              RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"dx2", "+", 
            RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "dx2"], "px2", " ", 
         "dm2"}], ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "10"}], ":", " ", 
       RowBox[{"apply", " ", "rotation", " ", "10"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "one", ",", "one", ",", "z", ",", "z"}], "}"}], 
        ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx2", "+", 
              RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"dx2", "+", 
            RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "dx2"], "px2", " ", 
         "dm2"}], ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "11"}], ":", " ", 
       RowBox[{"apply", " ", "rotation", " ", "11"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "one", ",", "z", ",", "one", ",", "z"}], "}"}], 
        ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx2", "+", 
              RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"dx2", "+", 
            RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "dx2"], "px2", " ", 
         "dm2"}], ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "12"}], ":", " ", 
       RowBox[{"apply", " ", "rotation", " ", "12"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "z", ",", "z", ",", "z", ",", "z"}], "}"}], ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx2", "+", 
              RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"dx2", "+", 
            RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "dx2"], "px2", " ", 
         "dm2"}], ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "13"}], ":", " ", 
       RowBox[{"apply", " ", "rotation", " ", "13"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "z", ",", "one", ",", "z", ",", "z"}], "}"}], 
        ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "14"}], ":", " ", 
       RowBox[{"apply", " ", "rotation", " ", "14"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "one", ",", "z", ",", "z", ",", "z"}], "}"}], 
        ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Step", " ", "15"}], ":", " ", 
       RowBox[{"apply", " ", "rotation", " ", "15"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"ApplyRot", "[", 
       RowBox[{"out2", ",", 
        RowBox[{"{", 
         RowBox[{"one", ",", "z", ",", "z", ",", "one", ",", "z"}], "}"}], 
        ",", 
        RowBox[{"pl1", "+", 
         RowBox[{
          FractionBox["1", "2"], "lmove", "*", "pm2"}]}], ",", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], "lmove", " ", "pm2"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "dx2"}], "dm2"], 
          "pm2"}]}], ",", "0"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Apply", " ", "storage", " ", "errors", " ", "for", " ", "l1time", " ", 
       "code", " ", "cycles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Qubit", " ", "1", " ", "is", " ", "consumed", " ", "as", " ", "an", 
       " ", "output", " ", "state", " ", "in", " ", "the", " ", "following", 
       " ", 
       RowBox[{"step", ":", " ", 
        RowBox[{
        "additional", " ", "storage", " ", "errors", " ", "for", " ", "dx2", 
         " ", "code", " ", "cycles"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageX5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", 
         RowBox[{"(", 
          RowBox[{"l1time", "+", "dx2"}], ")"}]}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}], ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dz2", "dx2"], "px2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"StorageZ5Qubit", "[", 
       RowBox[{"out2", ",", 
        RowBox[{
         FractionBox["1", "2"], "px2", " ", 
         RowBox[{"(", 
          RowBox[{"l1time", "+", "dx2"}], ")"}]}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}], ",", "0", ",", 
        RowBox[{
         FractionBox["1", "2"], 
         FractionBox["dx2", "dz2"], "pz2", " ", "l1time"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Compute", " ", "level"}], "-", 
        RowBox[{
        "2", " ", "failure", " ", "probability", " ", "as", " ", "the", " ", 
         "probability", " ", "to", " ", "measure", " ", "qubits", " ", "2"}], 
        "-", 
        RowBox[{"5", " ", "in", " ", "the"}]}], " ", "|", 
       RowBox[{"+", 
        RowBox[{">", " ", "state"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pfail2", "=", 
      RowBox[{"Re", "[", 
       RowBox[{"1", "-", 
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{
           "one", ",", "ProjX", ",", "ProjX", ",", "ProjX", ",", "ProjX"}], 
           "]"}], ".", "out2"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "Compute", " ", "the", " ", "density", " ", "matrix", " ", "of", " ", 
         "the", " ", "post"}], "-", 
        RowBox[{"selected", " ", "output", " ", "state"}]}], ",", " ", 
       RowBox[{"i", ".", "e", "."}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"after", " ", "projecting", " ", "qubits", " ", "2"}], "-", 
         RowBox[{"5", " ", "into"}]}], " ", "|", 
        RowBox[{"+", ">"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"OutPostSel2", "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", "pfail2"}]], 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
         "one", ",", "ProjX", ",", "ProjX", ",", "ProjX", ",", "ProjX"}], 
         "]"}], ".", "out2", ".", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{
          "one", ",", "ProjX", ",", "ProjX", ",", "ProjX", ",", "ProjX"}], 
          "]"}], "\[HermitianConjugate]"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Compute", " ", "level"}], "-", 
       RowBox[{
       "2", " ", "output", " ", "error", " ", "from", " ", "the", " ", 
        "infidelity", " ", "between", " ", "the", " ", "post"}], "-", 
       RowBox[{
       "selected", " ", "state", " ", "and", " ", "the", " ", "ideal", " ", 
        "output", " ", "state"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pout", "=", 
      RowBox[{"Re", "[", 
       RowBox[{"1", "-", 
        RowBox[{"Tr", "[", 
         RowBox[{"OutPostSel2", ".", "Ideal15to1"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Full", "-", 
       RowBox[{"distance", " ", 
        RowBox[{"computation", ":", " ", 
         RowBox[{
          RowBox[{
          "determine", " ", "full", " ", "distance", " ", "required", " ", 
           "for", " ", "a", " ", "100"}], "-", 
          RowBox[{"qubit", "/", "10000"}], "-", 
          RowBox[{"qubit", " ", "computation"}]}]}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"reqdist1", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Round", "[", 
          RowBox[{"d", ",", "2"}], "]"}], "+", "1"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"Quiet", "[", 
         RowBox[{"Solve", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"231.", "/", "pout"}], "*", "d", "*", 
              RowBox[{"plog", "[", 
               RowBox[{"pphys", ",", "d"}], "]"}]}], "\[Equal]", "0.01"}], 
            ",", 
            RowBox[{"d", ">", "1"}]}], "}"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"reqdist2", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Round", "[", 
          RowBox[{"d", ",", "2"}], "]"}], "+", "1"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"Quiet", "[", 
         RowBox[{"Solve", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"20284.", "/", "pout"}], "*", "d", "*", 
              RowBox[{"plog", "[", 
               RowBox[{"pphys", ",", "d"}], "]"}]}], "\[Equal]", "0.01"}], 
            ",", 
            RowBox[{"d", ">", "1"}]}], "}"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Print", " ", "output", " ", "error"}], ",", " ", 
       RowBox[{"failure", " ", "probability"}], ",", " ", 
       RowBox[{"space", " ", "cost"}], ",", " ", 
       RowBox[{
        RowBox[{"time", " ", "cost", " ", "and", " ", "space"}], "-", 
        RowBox[{"time", " ", "cost"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<Small-footprint (15-to-1\!\(\*SubscriptBox[\()\), \(`1`, `2`, `3`\
\)]\)\[Times](15-to-1\!\(\*SubscriptBox[\()\), \(`4`, `5`, `6`\)]\) with \!\(\
\*SubscriptBox[\(p\), \(phys\)]\)=`7`, \!\(\*SubscriptBox[\(d\), \
\(x\)]\)=`1`, \!\(\*SubscriptBox[\(d\), \(z\)]\)=`2`, \
\!\(\*SubscriptBox[\(d\), \(m\)]\)=`3`, \!\(\*SubscriptBox[\(d\), \
\(x2\)]\)=`4`, \!\(\*SubscriptBox[\(d\), \(z2\)]\)=`5` and \
\!\(\*SubscriptBox[\(d\), \(m2\)]\)=`6`\>\"", ",", "dx", ",", "dz", ",", "dm",
         ",", "dx2", ",", "dz2", ",", "dm2", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{"N", "[", "pphys", "]"}], "]"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<Output error: \!\(\*SubscriptBox[\(p\), \(out\)]\) = `1`\>\"", 
        ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{"pout", ",", "4"}], "]"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<Failure probability: \!\(\*SubscriptBox[\(p\), \(fail\)]\) = \
`1`\>\"", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{"pfail2", ",", "4"}], "]"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{"\"\<Space cost: `1` qubits\>\"", ",", 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx2", "+", 
              RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "2", "dx2"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dx", "+", 
              RowBox[{"4", "dz"}]}], ")"}], "3", "dx"}], "+", 
           RowBox[{"2", "dm"}], "+", 
           RowBox[{"2", 
            SuperscriptBox["dm2", "2"]}]}], ")"}]}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{"\"\<Time cost: `1` code cycles\>\"", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"ncycles", "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", "pfail2"}], ")"}]}], ",", "4"}], "]"}], ",", 
          "4"}], "]"}]}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{"\"\<Spacetime cost: `1` qubitcycles\>\"", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{
          RowBox[{"2", "*", "ncycles", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"dx2", "+", 
                 RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "2", "dx2"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"dx", "+", 
                 RowBox[{"4", "dz"}]}], ")"}], "3", "dx"}], "+", 
              RowBox[{"2", "dm"}], "+", 
              RowBox[{"2", 
               SuperscriptBox["dm2", "2"]}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"1", "-", "pfail2"}], ")"}]}]}], ",", "4"}], "]"}]}], 
       "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<For a 100-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \
\(3\)]\) (d=`2`)\>\"", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{
          RowBox[{"ncycles", "*", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"dx2", "+", 
                  RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "2", "dx2"}], 
               "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"dx", "+", 
                  RowBox[{"4", "dz"}]}], ")"}], "3", "dx"}], "+", 
               RowBox[{"2", "dm"}], "+", 
               RowBox[{"2", 
                SuperscriptBox["dm2", "2"]}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", "pfail2"}], ")"}]}], "/", 
            SuperscriptBox["reqdist1", "3"]}]}], ",", "4"}], "]"}], ",", 
        "reqdist1"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"StringForm", "[", 
       RowBox[{
       "\"\<For a 10000-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\
\)]\) (d=`2`)\>\"", ",", 
        RowBox[{"NumberForm", "[", 
         RowBox[{
          RowBox[{"ncycles", "*", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"dx2", "+", 
                  RowBox[{"4", "dz2"}], "+", "dm2"}], ")"}], "2", "dx2"}], 
               "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"dx", "+", 
                  RowBox[{"4", "dz"}]}], ")"}], "3", "dx"}], "+", 
               RowBox[{"2", "dm"}], "+", 
               RowBox[{"2", 
                SuperscriptBox["dm2", "2"]}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", "pfail2"}], ")"}]}], "/", 
            SuperscriptBox["reqdist2", "3"]}]}], ",", "4"}], "]"}], ",", 
        "reqdist2"}], "]"}], "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7647818804197054`*^9, 3.7647827170147686`*^9}, {
   3.7647827526955023`*^9, 3.7647828037704153`*^9}, {3.7647828777323666`*^9, 
   3.7647828873914766`*^9}, {3.7647829679315805`*^9, 
   3.7647829900869355`*^9}, {3.7647871135993786`*^9, 
   3.7647871181582265`*^9}, {3.764787190717695*^9, 3.764787200944683*^9}, {
   3.7647873644636497`*^9, 3.764787367155138*^9}, 3.7647890235126734`*^9, {
   3.7647909296701856`*^9, 3.7647909529318037`*^9}, {3.7647909938776417`*^9, 
   3.7647910266716385`*^9}, {3.764792654171276*^9, 3.764792683882779*^9}, 
   3.764792718552117*^9, {3.764798953239451*^9, 3.7647990013518887`*^9}, {
   3.7649446563237267`*^9, 3.7649446627240024`*^9}, {3.7649448086121345`*^9, 
   3.76494482175257*^9}, {3.7649448836517706`*^9, 3.764944895551218*^9}, {
   3.765105828809168*^9, 3.765105829106036*^9}, {3.7654099265804377`*^9, 
   3.765409974456912*^9}, {3.7655179025619936`*^9, 3.7655179329190464`*^9}, {
   3.765518034563303*^9, 3.7655180824858165`*^9}, {3.765522264043847*^9, 
   3.7655222704840803`*^9}, {3.765720931023732*^9, 3.7657210086913185`*^9}, {
   3.7657210860919886`*^9, 3.7657210955908823`*^9}, {3.7657211268546515`*^9, 
   3.7657211568058505`*^9}, {3.7657214462471323`*^9, 3.765721453225848*^9}, {
   3.7657217641451077`*^9, 3.765721787384503*^9}, {3.7657218226869507`*^9, 
   3.765721844285879*^9}, {3.765721979927496*^9, 3.7657221507715845`*^9}, {
   3.7657221868507805`*^9, 3.7657223447121196`*^9}, {3.765722375843934*^9, 
   3.7657224224576793`*^9}, {3.7657224558337574`*^9, 
   3.7657225048227277`*^9}, {3.7657226368765144`*^9, 3.7657226399755*^9}, {
   3.7657226859904428`*^9, 3.7657226891114197`*^9}, {3.7657228154870634`*^9, 
   3.7657228230505915`*^9}, {3.76572299427556*^9, 3.765722997455518*^9}, {
   3.7657230973398333`*^9, 3.76572309930519*^9}, {3.765723141117487*^9, 
   3.7657232666743975`*^9}, {3.7657242834336734`*^9, 
   3.7657242848152246`*^9}, {3.7657243246102023`*^9, 3.76572432476615*^9}, {
   3.7657404744152803`*^9, 3.76574048244471*^9}, {3.765740612585455*^9, 
   3.7657406132904015`*^9}, {3.765740769119317*^9, 3.7657407697842703`*^9}, {
   3.766008476048359*^9, 3.766008534422531*^9}, {3.76600859029674*^9, 
   3.766008616218249*^9}, {3.7660987438906126`*^9, 3.7660987573909845`*^9}, {
   3.766098811720262*^9, 3.7660989076912527`*^9}, {3.7660989461288486`*^9, 
   3.7660989748165665`*^9}, {3.7660990077081776`*^9, 3.7660990131768503`*^9}, 
   3.766099052624571*^9, {3.7660990837178807`*^9, 3.7660990843272476`*^9}, {
   3.766169151958352*^9, 3.76616927101625*^9}, {3.766169302270108*^9, 
   3.766169331788019*^9}, {3.766175569456685*^9, 3.7661759116837015`*^9}, {
   3.7661759518616877`*^9, 3.7661761694902315`*^9}, {3.766176224531863*^9, 
   3.766176434692382*^9}, {3.7661765381919427`*^9, 3.7661766127795296`*^9}, {
   3.766176781114933*^9, 3.766176817462805*^9}, 3.7661768586452646`*^9, {
   3.7661780632281666`*^9, 3.766178065743758*^9}, {3.7661808979026413`*^9, 
   3.7661808994600325`*^9}, {3.766247336557528*^9, 3.7662473408387184`*^9}, {
   3.7662485410220985`*^9, 3.76624854200646*^9}, 3.766248608137231*^9, {
   3.7662641164773827`*^9, 3.766264148478401*^9}, {3.7662642098944197`*^9, 
   3.766264309764752*^9}, {3.7662645375634794`*^9, 3.76626455513062*^9}, {
   3.766264589098131*^9, 3.7662645912184305`*^9}, 3.7662647124545546`*^9, {
   3.7663562146131077`*^9, 3.76635623896808*^9}, {3.766356297910652*^9, 
   3.766356309201929*^9}, {3.766356423860138*^9, 3.7663564259304523`*^9}, {
   3.7663564577589607`*^9, 3.7663564581488314`*^9}, {3.7663564950436707`*^9, 
   3.766356517930125*^9}, {3.7663565524097605`*^9, 3.7663565798907013`*^9}, {
   3.766356638753299*^9, 3.766356653403469*^9}, {3.7663567292964535`*^9, 
   3.7663567915609303`*^9}, {3.766356883637577*^9, 3.766356884112421*^9}, {
   3.766356944689452*^9, 3.766356968890476*^9}, {3.7663916370285645`*^9, 
   3.7663916386222954`*^9}, {3.7664002381787558`*^9, 3.7664002751470594`*^9}, 
   3.766400314224712*^9, {3.766400347572379*^9, 3.7664003567597694`*^9}, {
   3.7664003949314466`*^9, 3.766400504355316*^9}, {3.7664005532002106`*^9, 
   3.7664006218730173`*^9}, {3.7664006637006364`*^9, 
   3.7664008465007124`*^9}, {3.766400880455222*^9, 3.766400976629518*^9}, {
   3.7664010070822754`*^9, 3.7664010134571977`*^9}, {3.7664028754301977`*^9, 
   3.766402963116638*^9}, {3.7664034341864147`*^9, 3.766403602062628*^9}, {
   3.7664036345793266`*^9, 3.766403732284241*^9}, {3.7664038375201874`*^9, 
   3.7664038581777115`*^9}, 3.7664895019658337`*^9, {3.7664895812262955`*^9, 
   3.7664897262089186`*^9}, 3.7666922645376034`*^9, {3.7667010392683744`*^9, 
   3.7667010493744903`*^9}, {3.7667011192888756`*^9, 3.766701277863145*^9}, {
   3.7667014441178617`*^9, 3.766701816292155*^9}, {3.7667018668189025`*^9, 
   3.7667018793198214`*^9}, {3.7667019184994726`*^9, 3.766702014417424*^9}, {
   3.7667028303401375`*^9, 3.766702834918871*^9}, {3.766702899530339*^9, 
   3.766702899657297*^9}, {3.7667040499593554`*^9, 3.766704056027175*^9}, 
   3.766704201927638*^9, {3.766704475496828*^9, 3.7667044786540613`*^9}, {
   3.7667068436834803`*^9, 3.7667071820960646`*^9}, {3.7728918794205503`*^9, 
   3.772891891797037*^9}, {3.772891945838086*^9, 3.7728919699545507`*^9}, {
   3.7728920140168915`*^9, 3.772892147386198*^9}, {3.7728921850698853`*^9, 
   3.7728922237187567`*^9}, {3.77289225464038*^9, 3.7728923179970913`*^9}, {
   3.772892423319914*^9, 3.77289243943747*^9}, {3.7728929045418043`*^9, 
   3.7728929341485987`*^9}, {3.7728929718193398`*^9, 3.772892973207821*^9}, {
   3.772893006798786*^9, 3.7728930293129406`*^9}, {3.7728930909128942`*^9, 
   3.772893125000812*^9}, {3.7728931827122827`*^9, 3.772893185050542*^9}, {
   3.7728933171043863`*^9, 3.7728933277512536`*^9}, {3.772893362689212*^9, 
   3.7728933863950253`*^9}, 3.7728934196259546`*^9, {3.7728934607695355`*^9, 
   3.7728935502606125`*^9}, {3.7728935838248262`*^9, 
   3.7728936445897093`*^9}, {3.7728937133808985`*^9, 
   3.7728937388784256`*^9}, {3.772893784173973*^9, 3.7728937913050995`*^9}, 
   3.772894025304567*^9},
 CellLabel->
  "In[105]:=",ExpressionUUID->"d7359a8d-f955-40c2-aee5-2bd3000f8d34"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Results", "Title",
 CellChangeTimes->{{3.764787460314577*^9, 
  3.764787460916191*^9}},ExpressionUUID->"17de98fd-e5bc-43bf-bcee-\
b42d7671d4b6"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["p", "phys"], "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "4"}]]}], 
  TraditionalForm]], \
"Chapter",ExpressionUUID->"bbe0b397-4f91-4078-99cc-95dfa6f3744a"]], "Chapter",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.764790754263265*^9, 3.764790767012478*^9}, 
   3.764791540210457*^9},ExpressionUUID->"b45c8d01-6360-4a90-9931-\
6d85698dea07"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CostOfOneLevel15to1", "[", 
  RowBox[{
   SuperscriptBox["10", 
    RowBox[{"-", "4"}]], ",", "7", ",", "3", ",", "3"}], "]"}]], "Input",
 CellChangeTimes->{
  3.766008406752466*^9, {3.766089281909139*^9, 3.7660892870554347`*^9}, 
   3.7660893519329157`*^9, {3.7660983293982935`*^9, 3.7660983354294543`*^9}, {
   3.766429706250884*^9, 3.7664297100320873`*^9}, {3.76671087721607*^9, 
   3.7667108781066866`*^9}, {3.7722999436860046`*^9, 3.772299947984587*^9}, {
   3.7727859492560363`*^9, 3.772786054515504*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"881c03f1-bce6-4945-bb48-12532cac4dc4"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox["\<\"(15-to-1\\!\\(\\*SubscriptBox[\\()\\), \
\\(\\!\\(\\*RowBox[{\\\"7\\\"}]\\), \\!\\(\\*RowBox[{\\\"3\\\"}]\\), \
\\!\\(\\*RowBox[{\\\"3\\\"}]\\)\\)]\\) with \\!\\(\\*SubscriptBox[\\(p\\), \
\\(phys\\)]\\)=\\!\\(\\*RowBox[{\\\"\\\\\\\"0.0001\\\\\\\"\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(x\\)]\\)=\\!\\(\\*RowBox[{\\\"7\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(z\\)]\\)=\\!\\(\\*RowBox[{\\\"3\\\"}]\\) \
and \\!\\(\\*SubscriptBox[\\(d\\), \
\\(m\\)]\\)=\\!\\(\\*RowBox[{\\\"3\\\"}]\\)\"\>",
  StringForm[
  "(15-to-1\!\(\*SubscriptBox[\()\), \(`1`, `2`, `3`\)]\) with \
\!\(\*SubscriptBox[\(p\), \(phys\)]\)=`4`, \!\(\*SubscriptBox[\(d\), \
\(x\)]\)=`1`, \!\(\*SubscriptBox[\(d\), \(z\)]\)=`2` and \
\!\(\*SubscriptBox[\(d\), \(m\)]\)=`3`", 7, 3, 3, 
   NumberForm[0.0001]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7660892613429604`*^9, 3.766089288918813*^9}, {
   3.766089349727644*^9, 3.766089353866271*^9}, {3.766098313444398*^9, 
   3.766098337070055*^9}, 3.7660985664816756`*^9, 3.766139045422804*^9, 
   3.7662420282935905`*^9, 3.7662420993095865`*^9, 3.7662472687928133`*^9, 
   3.766247386213108*^9, {3.766248619759308*^9, 3.7662486505088944`*^9}, 
   3.766391825426694*^9, 3.7663918606541905`*^9, 3.7663932125284786`*^9, 
   3.766402568393053*^9, 3.7664028542585783`*^9, 3.766428887244052*^9, {
   3.7664297081727314`*^9, 3.7664297117664385`*^9}, 3.766497660770543*^9, 
   3.7665166675828805`*^9, 3.766521764630281*^9, 3.7666600610770817`*^9, 
   3.766690131658786*^9, 3.7666922737333155`*^9, {3.766704076281545*^9, 
   3.7667041562456217`*^9}, 3.7667042083407464`*^9, 3.7667057281485043`*^9, 
   3.7667072713359513`*^9, {3.772299929078843*^9, 3.7722999496057997`*^9}, 
   3.772308058574463*^9, 3.7727514531289597`*^9, {3.7727859515082564`*^9, 
   3.7727860567835083`*^9}, 3.7728106394434013`*^9, 3.7728923336775455`*^9, 
   3.7728924577942767`*^9, {3.772923113288162*^9, 3.7729231202582164`*^9}},
 CellLabel->
  "During evaluation of \
In[138]:=",ExpressionUUID->"7b5c4bda-e3eb-48c1-8f48-26e080c736f7"],

Cell[BoxData[
 InterpretationBox["\<\"Output error: \\!\\(\\*SubscriptBox[\\(p\\), \
\\(out\\)]\\) = \\!\\(\\*RowBox[{\\\"\\\\\\\"4.394\\\\\\\"\\\", \
\\\"\[Times]\\\", SuperscriptBox[\\\"10\\\", \\\"\\\\\\\"-8\\\\\\\"\\\"]}]\\)\
\"\>",
  StringForm["Output error: \!\(\*SubscriptBox[\(p\), \(out\)]\) = `1`", 
   NumberForm[
   4.39409194839256053430980087445870722033423989189935`38.81373668529183*^-8,
     4]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7660892613429604`*^9, 3.766089288918813*^9}, {
   3.766089349727644*^9, 3.766089353866271*^9}, {3.766098313444398*^9, 
   3.766098337070055*^9}, 3.7660985664816756`*^9, 3.766139045422804*^9, 
   3.7662420282935905`*^9, 3.7662420993095865`*^9, 3.7662472687928133`*^9, 
   3.766247386213108*^9, {3.766248619759308*^9, 3.7662486505088944`*^9}, 
   3.766391825426694*^9, 3.7663918606541905`*^9, 3.7663932125284786`*^9, 
   3.766402568393053*^9, 3.7664028542585783`*^9, 3.766428887244052*^9, {
   3.7664297081727314`*^9, 3.7664297117664385`*^9}, 3.766497660770543*^9, 
   3.7665166675828805`*^9, 3.766521764630281*^9, 3.7666600610770817`*^9, 
   3.766690131658786*^9, 3.7666922737333155`*^9, {3.766704076281545*^9, 
   3.7667041562456217`*^9}, 3.7667042083407464`*^9, 3.7667057281485043`*^9, 
   3.7667072713359513`*^9, {3.772299929078843*^9, 3.7722999496057997`*^9}, 
   3.772308058574463*^9, 3.7727514531289597`*^9, {3.7727859515082564`*^9, 
   3.7727860567835083`*^9}, 3.7728106394434013`*^9, 3.7728923336775455`*^9, 
   3.7728924577942767`*^9, {3.772923113288162*^9, 3.7729231202622194`*^9}},
 CellLabel->
  "During evaluation of \
In[138]:=",ExpressionUUID->"2d85b376-76ff-4e2a-8444-b28d43b58c4a"],

Cell[BoxData[
 InterpretationBox["\<\"Failure probability: \\!\\(\\*SubscriptBox[\\(p\\), \
\\(fail\\)]\\) = \\!\\(\\*RowBox[{\\\"\\\\\\\"0.003054\\\\\\\"\\\"}]\\)\"\>",
  StringForm[
  "Failure probability: \!\(\*SubscriptBox[\(p\), \(fail\)]\) = `1`", 
   NumberForm[
   0.0030537435699286760653916361107326619623212105203505889472`44.\
00112390188712, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7660892613429604`*^9, 3.766089288918813*^9}, {
   3.766089349727644*^9, 3.766089353866271*^9}, {3.766098313444398*^9, 
   3.766098337070055*^9}, 3.7660985664816756`*^9, 3.766139045422804*^9, 
   3.7662420282935905`*^9, 3.7662420993095865`*^9, 3.7662472687928133`*^9, 
   3.766247386213108*^9, {3.766248619759308*^9, 3.7662486505088944`*^9}, 
   3.766391825426694*^9, 3.7663918606541905`*^9, 3.7663932125284786`*^9, 
   3.766402568393053*^9, 3.7664028542585783`*^9, 3.766428887244052*^9, {
   3.7664297081727314`*^9, 3.7664297117664385`*^9}, 3.766497660770543*^9, 
   3.7665166675828805`*^9, 3.766521764630281*^9, 3.7666600610770817`*^9, 
   3.766690131658786*^9, 3.7666922737333155`*^9, {3.766704076281545*^9, 
   3.7667041562456217`*^9}, 3.7667042083407464`*^9, 3.7667057281485043`*^9, 
   3.7667072713359513`*^9, {3.772299929078843*^9, 3.7722999496057997`*^9}, 
   3.772308058574463*^9, 3.7727514531289597`*^9, {3.7727859515082564`*^9, 
   3.7727860567835083`*^9}, 3.7728106394434013`*^9, 3.7728923336775455`*^9, 
   3.7728924577942767`*^9, {3.772923113288162*^9, 3.772923120268264*^9}},
 CellLabel->
  "During evaluation of \
In[138]:=",ExpressionUUID->"5cf86f94-f807-4feb-b6bd-45f0f7e327ac"],

Cell[BoxData[
 InterpretationBox["\<\"Space cost: \\!\\(\\*RowBox[{\\\"810\\\"}]\\) \
qubits\"\>",
  StringForm["Space cost: `1` qubits", 810],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7660892613429604`*^9, 3.766089288918813*^9}, {
   3.766089349727644*^9, 3.766089353866271*^9}, {3.766098313444398*^9, 
   3.766098337070055*^9}, 3.7660985664816756`*^9, 3.766139045422804*^9, 
   3.7662420282935905`*^9, 3.7662420993095865`*^9, 3.7662472687928133`*^9, 
   3.766247386213108*^9, {3.766248619759308*^9, 3.7662486505088944`*^9}, 
   3.766391825426694*^9, 3.7663918606541905`*^9, 3.7663932125284786`*^9, 
   3.766402568393053*^9, 3.7664028542585783`*^9, 3.766428887244052*^9, {
   3.7664297081727314`*^9, 3.7664297117664385`*^9}, 3.766497660770543*^9, 
   3.7665166675828805`*^9, 3.766521764630281*^9, 3.7666600610770817`*^9, 
   3.766690131658786*^9, 3.7666922737333155`*^9, {3.766704076281545*^9, 
   3.7667041562456217`*^9}, 3.7667042083407464`*^9, 3.7667057281485043`*^9, 
   3.7667072713359513`*^9, {3.772299929078843*^9, 3.7722999496057997`*^9}, 
   3.772308058574463*^9, 3.7727514531289597`*^9, {3.7727859515082564`*^9, 
   3.7727860567835083`*^9}, 3.7728106394434013`*^9, 3.7728923336775455`*^9, 
   3.7728924577942767`*^9, {3.772923113288162*^9, 3.772923120268264*^9}},
 CellLabel->
  "During evaluation of \
In[138]:=",ExpressionUUID->"474b65d4-ad8e-47bd-87a8-69bb835cd8c2"],

Cell[BoxData[
 InterpretationBox["\<\"Time cost: \\!\\(\\*RowBox[{\\\"\\\\\\\"18.06\\\\\\\"\
\\\"}]\\) code cycles\"\>",
  StringForm["Time cost: `1` code cycles", 
   NumberForm[
   18.0551357547151507253873179216546728600738153103162583531685`46.\
51496308328309, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7660892613429604`*^9, 3.766089288918813*^9}, {
   3.766089349727644*^9, 3.766089353866271*^9}, {3.766098313444398*^9, 
   3.766098337070055*^9}, 3.7660985664816756`*^9, 3.766139045422804*^9, 
   3.7662420282935905`*^9, 3.7662420993095865`*^9, 3.7662472687928133`*^9, 
   3.766247386213108*^9, {3.766248619759308*^9, 3.7662486505088944`*^9}, 
   3.766391825426694*^9, 3.7663918606541905`*^9, 3.7663932125284786`*^9, 
   3.766402568393053*^9, 3.7664028542585783`*^9, 3.766428887244052*^9, {
   3.7664297081727314`*^9, 3.7664297117664385`*^9}, 3.766497660770543*^9, 
   3.7665166675828805`*^9, 3.766521764630281*^9, 3.7666600610770817`*^9, 
   3.766690131658786*^9, 3.7666922737333155`*^9, {3.766704076281545*^9, 
   3.7667041562456217`*^9}, 3.7667042083407464`*^9, 3.7667057281485043`*^9, 
   3.7667072713359513`*^9, {3.772299929078843*^9, 3.7722999496057997`*^9}, 
   3.772308058574463*^9, 3.7727514531289597`*^9, {3.7727859515082564`*^9, 
   3.7727860567835083`*^9}, 3.7728106394434013`*^9, 3.7728923336775455`*^9, 
   3.7728924577942767`*^9, {3.772923113288162*^9, 3.772923120278202*^9}},
 CellLabel->
  "During evaluation of \
In[138]:=",ExpressionUUID->"326cbce8-7630-45b3-986f-ad64a66e3eb1"],

Cell[BoxData[
 InterpretationBox["\<\"Spacetime cost: \\!\\(\\*RowBox[{\\\"\\\\\\\"14620.\\\
\\\\\"\\\"}]\\) qubitcycles\"\>",
  StringForm["Spacetime cost: `1` qubitcycles", 
   NumberForm[
   14624.6599613192720875637275165402850166597904013561692660664599`46.\
51496308328309, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7660892613429604`*^9, 3.766089288918813*^9}, {
   3.766089349727644*^9, 3.766089353866271*^9}, {3.766098313444398*^9, 
   3.766098337070055*^9}, 3.7660985664816756`*^9, 3.766139045422804*^9, 
   3.7662420282935905`*^9, 3.7662420993095865`*^9, 3.7662472687928133`*^9, 
   3.766247386213108*^9, {3.766248619759308*^9, 3.7662486505088944`*^9}, 
   3.766391825426694*^9, 3.7663918606541905`*^9, 3.7663932125284786`*^9, 
   3.766402568393053*^9, 3.7664028542585783`*^9, 3.766428887244052*^9, {
   3.7664297081727314`*^9, 3.7664297117664385`*^9}, 3.766497660770543*^9, 
   3.7665166675828805`*^9, 3.766521764630281*^9, 3.7666600610770817`*^9, 
   3.766690131658786*^9, 3.7666922737333155`*^9, {3.766704076281545*^9, 
   3.7667041562456217`*^9}, 3.7667042083407464`*^9, 3.7667057281485043`*^9, 
   3.7667072713359513`*^9, {3.772299929078843*^9, 3.7722999496057997`*^9}, 
   3.772308058574463*^9, 3.7727514531289597`*^9, {3.7727859515082564`*^9, 
   3.7727860567835083`*^9}, 3.7728106394434013`*^9, 3.7728923336775455`*^9, 
   3.7728924577942767`*^9, {3.772923113288162*^9, 3.772923120278202*^9}},
 CellLabel->
  "During evaluation of \
In[138]:=",ExpressionUUID->"bf8751e5-bc62-42d2-b748-1b33bba910b4"],

Cell[BoxData[
 InterpretationBox["\<\"For a 100-qubit computation: \\!\\(\\*SuperscriptBox[\
\\(\\!\\(\\*RowBox[{\\\"\\\\\\\"5.494\\\\\\\"\\\"}]\\)d\\), \\(3\\)]\\) \
(d=\\!\\(\\*RowBox[{\\\"11\\\"}]\\))\"\>",
  StringForm[
  "For a 100-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\)]\) \
(d=`2`)", 
   NumberForm[
   5.4938617435459324145618811106462377973928589035898457047582`46.\
51496308328309, 4], 11],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7660892613429604`*^9, 3.766089288918813*^9}, {
   3.766089349727644*^9, 3.766089353866271*^9}, {3.766098313444398*^9, 
   3.766098337070055*^9}, 3.7660985664816756`*^9, 3.766139045422804*^9, 
   3.7662420282935905`*^9, 3.7662420993095865`*^9, 3.7662472687928133`*^9, 
   3.766247386213108*^9, {3.766248619759308*^9, 3.7662486505088944`*^9}, 
   3.766391825426694*^9, 3.7663918606541905`*^9, 3.7663932125284786`*^9, 
   3.766402568393053*^9, 3.7664028542585783`*^9, 3.766428887244052*^9, {
   3.7664297081727314`*^9, 3.7664297117664385`*^9}, 3.766497660770543*^9, 
   3.7665166675828805`*^9, 3.766521764630281*^9, 3.7666600610770817`*^9, 
   3.766690131658786*^9, 3.7666922737333155`*^9, {3.766704076281545*^9, 
   3.7667041562456217`*^9}, 3.7667042083407464`*^9, 3.7667057281485043`*^9, 
   3.7667072713359513`*^9, {3.772299929078843*^9, 3.7722999496057997`*^9}, 
   3.772308058574463*^9, 3.7727514531289597`*^9, {3.7727859515082564`*^9, 
   3.7727860567835083`*^9}, 3.7728106394434013`*^9, 3.7728923336775455`*^9, 
   3.7728924577942767`*^9, {3.772923113288162*^9, 3.7729231202879715`*^9}},
 CellLabel->
  "During evaluation of \
In[138]:=",ExpressionUUID->"bc8fac42-cd41-48d1-8fed-d64268a74649"],

Cell[BoxData[
 InterpretationBox["\<\"For a 10000-qubit computation: \
\\!\\(\\*SuperscriptBox[\\(\\!\\(\\*RowBox[{\\\"\\\\\\\"3.328\\\\\\\"\\\"}]\\)\
d\\), \\(3\\)]\\) (d=\\!\\(\\*RowBox[{\\\"13\\\"}]\\))\"\>",
  StringForm[
  "For a 10000-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\)]\) \
(d=`2`)", 
   NumberForm[
   3.3283249798177678851988455886527731034728699138270753905476`46.\
51496308328309, 4], 13],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7660892613429604`*^9, 3.766089288918813*^9}, {
   3.766089349727644*^9, 3.766089353866271*^9}, {3.766098313444398*^9, 
   3.766098337070055*^9}, 3.7660985664816756`*^9, 3.766139045422804*^9, 
   3.7662420282935905`*^9, 3.7662420993095865`*^9, 3.7662472687928133`*^9, 
   3.766247386213108*^9, {3.766248619759308*^9, 3.7662486505088944`*^9}, 
   3.766391825426694*^9, 3.7663918606541905`*^9, 3.7663932125284786`*^9, 
   3.766402568393053*^9, 3.7664028542585783`*^9, 3.766428887244052*^9, {
   3.7664297081727314`*^9, 3.7664297117664385`*^9}, 3.766497660770543*^9, 
   3.7665166675828805`*^9, 3.766521764630281*^9, 3.7666600610770817`*^9, 
   3.766690131658786*^9, 3.7666922737333155`*^9, {3.766704076281545*^9, 
   3.7667041562456217`*^9}, 3.7667042083407464`*^9, 3.7667057281485043`*^9, 
   3.7667072713359513`*^9, {3.772299929078843*^9, 3.7722999496057997`*^9}, 
   3.772308058574463*^9, 3.7727514531289597`*^9, {3.7727859515082564`*^9, 
   3.7727860567835083`*^9}, 3.7728106394434013`*^9, 3.7728923336775455`*^9, 
   3.7728924577942767`*^9, {3.772923113288162*^9, 3.7729231202879715`*^9}},
 CellLabel->
  "During evaluation of \
In[138]:=",ExpressionUUID->"4fc4ce2d-cc5a-44e6-83f6-adb473365250"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CostOfOneLevel15to1", "[", 
  RowBox[{
   SuperscriptBox["10", 
    RowBox[{"-", "4"}]], ",", "9", ",", "3", ",", "3"}], "]"}]], "Input",
 CellChangeTimes->{{3.7660083574875345`*^9, 3.7660083660499163`*^9}, {
  3.7664297494534864`*^9, 3.7664297580940065`*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"47ac73b4-a629-47e9-8119-b7d721138c87"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox["\<\"(15-to-1\\!\\(\\*SubscriptBox[\\()\\), \
\\(\\!\\(\\*RowBox[{\\\"9\\\"}]\\), \\!\\(\\*RowBox[{\\\"3\\\"}]\\), \
\\!\\(\\*RowBox[{\\\"3\\\"}]\\)\\)]\\) with \\!\\(\\*SubscriptBox[\\(p\\), \
\\(phys\\)]\\)=\\!\\(\\*RowBox[{\\\"\\\\\\\"0.0001\\\\\\\"\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(x\\)]\\)=\\!\\(\\*RowBox[{\\\"9\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(z\\)]\\)=\\!\\(\\*RowBox[{\\\"3\\\"}]\\) \
and \\!\\(\\*SubscriptBox[\\(d\\), \
\\(m\\)]\\)=\\!\\(\\*RowBox[{\\\"3\\\"}]\\)\"\>",
  StringForm[
  "(15-to-1\!\(\*SubscriptBox[\()\), \(`1`, `2`, `3`\)]\) with \
\!\(\*SubscriptBox[\(p\), \(phys\)]\)=`4`, \!\(\*SubscriptBox[\(d\), \
\(x\)]\)=`1`, \!\(\*SubscriptBox[\(d\), \(z\)]\)=`2` and \
\!\(\*SubscriptBox[\(d\), \(m\)]\)=`3`", 9, 3, 3, 
   NumberForm[0.0001]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7662486270560856`*^9, 3.766248652008875*^9}, 
   3.7663918283329086`*^9, 3.7663918652478857`*^9, 3.766393214090961*^9, 
   3.766402571674264*^9, 3.766402855899184*^9, 3.766428897368929*^9, {
   3.766429752219075*^9, 3.7664297598283567`*^9}, 3.7664976731275606`*^9, 
   3.7665166708458033`*^9, 3.7665217678292265`*^9, 3.7666901335171723`*^9, 
   3.766692275578707*^9, 3.7667040781094584`*^9, 3.766704210157219*^9, 
   3.7667057316817737`*^9, 3.7667072731741886`*^9, 3.772299901787269*^9, 
   3.772308057088069*^9, 3.7727514601160903`*^9, 3.7728106486301975`*^9, 
   3.772892338013301*^9, 3.772892459329248*^9, {3.7729231148582315`*^9, 
   3.772923121722119*^9}},
 CellLabel->
  "During evaluation of \
In[139]:=",ExpressionUUID->"cd817c6f-eea1-4c05-ae82-6093c412f7dd"],

Cell[BoxData[
 InterpretationBox["\<\"Output error: \\!\\(\\*SubscriptBox[\\(p\\), \
\\(out\\)]\\) = \\!\\(\\*RowBox[{\\\"\\\\\\\"9.300\\\\\\\"\\\", \
\\\"\[Times]\\\", SuperscriptBox[\\\"10\\\", \
\\\"\\\\\\\"-10\\\\\\\"\\\"]}]\\)\"\>",
  StringForm["Output error: \!\(\*SubscriptBox[\(p\), \(out\)]\) = `1`", 
   NumberForm[
   9.299569800084688515005317766400747600861900797478`37.13907662752897*^-10, 
    4]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7662486270560856`*^9, 3.766248652008875*^9}, 
   3.7663918283329086`*^9, 3.7663918652478857`*^9, 3.766393214090961*^9, 
   3.766402571674264*^9, 3.766402855899184*^9, 3.766428897368929*^9, {
   3.766429752219075*^9, 3.7664297598283567`*^9}, 3.7664976731275606`*^9, 
   3.7665166708458033`*^9, 3.7665217678292265`*^9, 3.7666901335171723`*^9, 
   3.766692275578707*^9, 3.7667040781094584`*^9, 3.766704210157219*^9, 
   3.7667057316817737`*^9, 3.7667072731741886`*^9, 3.772299901787269*^9, 
   3.772308057088069*^9, 3.7727514601160903`*^9, 3.7728106486301975`*^9, 
   3.772892338013301*^9, 3.772892459329248*^9, {3.7729231148582315`*^9, 
   3.7729231217342043`*^9}},
 CellLabel->
  "During evaluation of \
In[139]:=",ExpressionUUID->"b8b398d6-cdac-4bee-a888-a9cbf0e0267e"],

Cell[BoxData[
 InterpretationBox["\<\"Failure probability: \\!\\(\\*SubscriptBox[\\(p\\), \
\\(fail\\)]\\) = \\!\\(\\*RowBox[{\\\"\\\\\\\"0.003648\\\\\\\"\\\"}]\\)\"\>",
  StringForm[
  "Failure probability: \!\(\*SubscriptBox[\(p\), \(fail\)]\) = `1`", 
   NumberForm[
   0.0036484234371035439732526849476808561866302033146788604996`44.\
07840186158952, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7662486270560856`*^9, 3.766248652008875*^9}, 
   3.7663918283329086`*^9, 3.7663918652478857`*^9, 3.766393214090961*^9, 
   3.766402571674264*^9, 3.766402855899184*^9, 3.766428897368929*^9, {
   3.766429752219075*^9, 3.7664297598283567`*^9}, 3.7664976731275606`*^9, 
   3.7665166708458033`*^9, 3.7665217678292265`*^9, 3.7666901335171723`*^9, 
   3.766692275578707*^9, 3.7667040781094584`*^9, 3.766704210157219*^9, 
   3.7667057316817737`*^9, 3.7667072731741886`*^9, 3.772299901787269*^9, 
   3.772308057088069*^9, 3.7727514601160903`*^9, 3.7728106486301975`*^9, 
   3.772892338013301*^9, 3.772892459329248*^9, {3.7729231148582315`*^9, 
   3.772923121737216*^9}},
 CellLabel->
  "During evaluation of \
In[139]:=",ExpressionUUID->"7b880c2a-a4dc-41f9-85a3-d9018bdc9ba5"],

Cell[BoxData[
 InterpretationBox["\<\"Space cost: \\!\\(\\*RowBox[{\\\"1146\\\"}]\\) qubits\
\"\>",
  StringForm["Space cost: `1` qubits", 1146],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7662486270560856`*^9, 3.766248652008875*^9}, 
   3.7663918283329086`*^9, 3.7663918652478857`*^9, 3.766393214090961*^9, 
   3.766402571674264*^9, 3.766402855899184*^9, 3.766428897368929*^9, {
   3.766429752219075*^9, 3.7664297598283567`*^9}, 3.7664976731275606`*^9, 
   3.7665166708458033`*^9, 3.7665217678292265`*^9, 3.7666901335171723`*^9, 
   3.766692275578707*^9, 3.7667040781094584`*^9, 3.766704210157219*^9, 
   3.7667057316817737`*^9, 3.7667072731741886`*^9, 3.772299901787269*^9, 
   3.772308057088069*^9, 3.7727514601160903`*^9, 3.7728106486301975`*^9, 
   3.772892338013301*^9, 3.772892459329248*^9, {3.7729231148582315`*^9, 
   3.772923121737216*^9}},
 CellLabel->
  "During evaluation of \
In[139]:=",ExpressionUUID->"3173d4e2-8ed5-4adc-9683-9fa6a3e304be"],

Cell[BoxData[
 InterpretationBox["\<\"Time cost: \\!\\(\\*RowBox[{\\\"\\\\\\\"18.07\\\\\\\"\
\\\"}]\\) code cycles\"\>",
  StringForm["Time cost: `1` code cycles", 
   NumberForm[
   18.0659120971077403160019796901343197866742087989185934080346`46.\
514709237000304, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7662486270560856`*^9, 3.766248652008875*^9}, 
   3.7663918283329086`*^9, 3.7663918652478857`*^9, 3.766393214090961*^9, 
   3.766402571674264*^9, 3.766402855899184*^9, 3.766428897368929*^9, {
   3.766429752219075*^9, 3.7664297598283567`*^9}, 3.7664976731275606`*^9, 
   3.7665166708458033`*^9, 3.7665217678292265`*^9, 3.7666901335171723`*^9, 
   3.766692275578707*^9, 3.7667040781094584`*^9, 3.766704210157219*^9, 
   3.7667057316817737`*^9, 3.7667072731741886`*^9, 3.772299901787269*^9, 
   3.772308057088069*^9, 3.7727514601160903`*^9, 3.7728106486301975`*^9, 
   3.772892338013301*^9, 3.772892459329248*^9, {3.7729231148582315`*^9, 
   3.772923121747987*^9}},
 CellLabel->
  "During evaluation of \
In[139]:=",ExpressionUUID->"bb741d8a-1fff-4c35-8345-09af79d046e8"],

Cell[BoxData[
 InterpretationBox["\<\"Spacetime cost: \\!\\(\\*RowBox[{\\\"\\\\\\\"20700.\\\
\\\\\"\\\"}]\\) qubitcycles\"\>",
  StringForm["Spacetime cost: `1` qubitcycles", 
   NumberForm[
   20703.5352632854704021382687248939304755286432835607080456076447`46.\
514709237000304, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7662486270560856`*^9, 3.766248652008875*^9}, 
   3.7663918283329086`*^9, 3.7663918652478857`*^9, 3.766393214090961*^9, 
   3.766402571674264*^9, 3.766402855899184*^9, 3.766428897368929*^9, {
   3.766429752219075*^9, 3.7664297598283567`*^9}, 3.7664976731275606`*^9, 
   3.7665166708458033`*^9, 3.7665217678292265`*^9, 3.7666901335171723`*^9, 
   3.766692275578707*^9, 3.7667040781094584`*^9, 3.766704210157219*^9, 
   3.7667057316817737`*^9, 3.7667072731741886`*^9, 3.772299901787269*^9, 
   3.772308057088069*^9, 3.7727514601160903`*^9, 3.7728106486301975`*^9, 
   3.772892338013301*^9, 3.772892459329248*^9, {3.7729231148582315`*^9, 
   3.772923121747987*^9}},
 CellLabel->
  "During evaluation of \
In[139]:=",ExpressionUUID->"cbc6b4f7-2417-4700-a640-9284ca8feb38"],

Cell[BoxData[
 InterpretationBox["\<\"For a 100-qubit computation: \\!\\(\\*SuperscriptBox[\
\\(\\!\\(\\*RowBox[{\\\"\\\\\\\"4.712\\\\\\\"\\\"}]\\)d\\), \\(3\\)]\\) \
(d=\\!\\(\\*RowBox[{\\\"13\\\"}]\\))\"\>",
  StringForm[
  "For a 100-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\)]\) \
(d=`2`)", 
   NumberForm[
   4.7117740699329700505549086765803210003478933280748083854364`46.\
514709237000304, 4], 13],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7662486270560856`*^9, 3.766248652008875*^9}, 
   3.7663918283329086`*^9, 3.7663918652478857`*^9, 3.766393214090961*^9, 
   3.766402571674264*^9, 3.766402855899184*^9, 3.766428897368929*^9, {
   3.766429752219075*^9, 3.7664297598283567`*^9}, 3.7664976731275606`*^9, 
   3.7665166708458033`*^9, 3.7665217678292265`*^9, 3.7666901335171723`*^9, 
   3.766692275578707*^9, 3.7667040781094584`*^9, 3.766704210157219*^9, 
   3.7667057316817737`*^9, 3.7667072731741886`*^9, 3.772299901787269*^9, 
   3.772308057088069*^9, 3.7727514601160903`*^9, 3.7728106486301975`*^9, 
   3.772892338013301*^9, 3.772892459329248*^9, {3.7729231148582315`*^9, 
   3.772923121747987*^9}},
 CellLabel->
  "During evaluation of \
In[139]:=",ExpressionUUID->"796b575f-17bf-4bd2-8259-6d3017a1043b"],

Cell[BoxData[
 InterpretationBox["\<\"For a 10000-qubit computation: \
\\!\\(\\*SuperscriptBox[\\(\\!\\(\\*RowBox[{\\\"\\\\\\\"3.067\\\\\\\"\\\"}]\\)\
d\\), \\(3\\)]\\) (d=\\!\\(\\*RowBox[{\\\"15\\\"}]\\))\"\>",
  StringForm[
  "For a 10000-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\)]\) \
(d=`2`)", 
   NumberForm[
   3.0671904093756252447612249962805822926709101160830678586086`46.\
514709237000304, 4], 15],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7662486270560856`*^9, 3.766248652008875*^9}, 
   3.7663918283329086`*^9, 3.7663918652478857`*^9, 3.766393214090961*^9, 
   3.766402571674264*^9, 3.766402855899184*^9, 3.766428897368929*^9, {
   3.766429752219075*^9, 3.7664297598283567`*^9}, 3.7664976731275606`*^9, 
   3.7665166708458033`*^9, 3.7665217678292265`*^9, 3.7666901335171723`*^9, 
   3.766692275578707*^9, 3.7667040781094584`*^9, 3.766704210157219*^9, 
   3.7667057316817737`*^9, 3.7667072731741886`*^9, 3.772299901787269*^9, 
   3.772308057088069*^9, 3.7727514601160903`*^9, 3.7728106486301975`*^9, 
   3.772892338013301*^9, 3.772892459329248*^9, {3.7729231148582315`*^9, 
   3.772923121757951*^9}},
 CellLabel->
  "During evaluation of \
In[139]:=",ExpressionUUID->"b6e06727-6907-4c65-bfbf-2b1c49c007a1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CostOfOneLevel15to1", "[", 
  RowBox[{
   SuperscriptBox["10", 
    RowBox[{"-", "4"}]], ",", "11", ",", "5", ",", "5"}], "]"}]], "Input",
 CellChangeTimes->{{3.7660983560083647`*^9, 3.766098369492546*^9}, {
  3.7660985885126133`*^9, 3.7660985888094864`*^9}, {3.766518491482669*^9, 
  3.7665184923283887`*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"ce8cd55d-f39a-47da-968a-997e0a12f08e"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox["\<\"(15-to-1\\!\\(\\*SubscriptBox[\\()\\), \
\\(\\!\\(\\*RowBox[{\\\"11\\\"}]\\), \\!\\(\\*RowBox[{\\\"5\\\"}]\\), \
\\!\\(\\*RowBox[{\\\"5\\\"}]\\)\\)]\\) with \\!\\(\\*SubscriptBox[\\(p\\), \
\\(phys\\)]\\)=\\!\\(\\*RowBox[{\\\"\\\\\\\"0.0001\\\\\\\"\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(x\\)]\\)=\\!\\(\\*RowBox[{\\\"11\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(z\\)]\\)=\\!\\(\\*RowBox[{\\\"5\\\"}]\\) \
and \\!\\(\\*SubscriptBox[\\(d\\), \
\\(m\\)]\\)=\\!\\(\\*RowBox[{\\\"5\\\"}]\\)\"\>",
  StringForm[
  "(15-to-1\!\(\*SubscriptBox[\()\), \(`1`, `2`, `3`\)]\) with \
\!\(\*SubscriptBox[\(p\), \(phys\)]\)=`4`, \!\(\*SubscriptBox[\(d\), \
\(x\)]\)=`1`, \!\(\*SubscriptBox[\(d\), \(z\)]\)=`2` and \
\!\(\*SubscriptBox[\(d\), \(m\)]\)=`3`", 11, 5, 5, 
   NumberForm[0.0001]],
  Editable->False]], "Print",
 CellChangeTimes->{3.7729231231591177`*^9},
 CellLabel->
  "During evaluation of \
In[140]:=",ExpressionUUID->"d0a66bc2-df82-41a2-8ce5-b73388623a6e"],

Cell[BoxData[
 InterpretationBox["\<\"Output error: \\!\\(\\*SubscriptBox[\\(p\\), \
\\(out\\)]\\) = \\!\\(\\*RowBox[{\\\"\\\\\\\"1.874\\\\\\\"\\\", \
\\\"\[Times]\\\", SuperscriptBox[\\\"10\\\", \
\\\"\\\\\\\"-11\\\\\\\"\\\"]}]\\)\"\>",
  StringForm["Output error: \!\(\*SubscriptBox[\(p\), \(out\)]\) = `1`", 
   NumberForm[
   1.87441183940608460859368069205603675550849988976`35.44460906857068*^-11, 
    4]],
  Editable->False]], "Print",
 CellChangeTimes->{3.7729231231591177`*^9},
 CellLabel->
  "During evaluation of \
In[140]:=",ExpressionUUID->"45d5502b-c367-4cf6-ab34-61bb29b3521e"],

Cell[BoxData[
 InterpretationBox["\<\"Failure probability: \\!\\(\\*SubscriptBox[\\(p\\), \
\\(fail\\)]\\) = \\!\\(\\*RowBox[{\\\"\\\\\\\"0.001032\\\\\\\"\\\"}]\\)\"\>",
  StringForm[
  "Failure probability: \!\(\*SubscriptBox[\(p\), \(fail\)]\) = `1`", 
   NumberForm[
   0.0010319110864230610615073013219591458915137462574857172692`43.\
529930492870996, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{3.772923123167173*^9},
 CellLabel->
  "During evaluation of \
In[140]:=",ExpressionUUID->"253f5931-27f4-4e80-bd7c-24237d2ecd64"],

Cell[BoxData[
 InterpretationBox["\<\"Space cost: \\!\\(\\*RowBox[{\\\"2066\\\"}]\\) qubits\
\"\>",
  StringForm["Space cost: `1` qubits", 2066],
  Editable->False]], "Print",
 CellChangeTimes->{3.772923123167173*^9},
 CellLabel->
  "During evaluation of \
In[140]:=",ExpressionUUID->"788df7f4-714c-4aec-8286-d0477d4ff11d"],

Cell[BoxData[
 InterpretationBox["\<\"Time cost: \\!\\(\\*RowBox[{\\\"\\\\\\\"30.03\\\\\\\"\
\\\"}]\\) code cycles\"\>",
  StringForm["Time cost: `1` code cycles", 
   NumberForm[
   30.0309893108060732287768466789906957112228457442133528240807`46.\
515839829836295, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{3.772923123178177*^9},
 CellLabel->
  "During evaluation of \
In[140]:=",ExpressionUUID->"1e240199-36b0-4e27-b725-40de096c79c7"],

Cell[BoxData[
 InterpretationBox["\<\"Spacetime cost: \\!\\(\\*RowBox[{\\\"\\\\\\\"62040.\\\
\\\\\"\\\"}]\\) qubitcycles\"\>",
  StringForm["Spacetime cost: `1` qubitcycles", 
   NumberForm[
   62044.0239161253472906529652387947773393863993075447869345508257`46.\
515839829836295, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{3.772923123178177*^9},
 CellLabel->
  "During evaluation of \
In[140]:=",ExpressionUUID->"64f300fe-2c43-451d-86a2-a811c135b207"],

Cell[BoxData[
 InterpretationBox["\<\"For a 100-qubit computation: \\!\\(\\*SuperscriptBox[\
\\(\\!\\(\\*RowBox[{\\\"\\\\\\\"9.192\\\\\\\"\\\"}]\\)d\\), \\(3\\)]\\) \
(d=\\!\\(\\*RowBox[{\\\"15\\\"}]\\))\"\>",
  StringForm[
  "For a 100-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\)]\) \
(d=`2`)", 
   NumberForm[
   9.1917072468333847838004392946362633095387258233399684347482`46.\
515839829836295, 4], 15],
  Editable->False]], "Print",
 CellChangeTimes->{3.772923123187987*^9},
 CellLabel->
  "During evaluation of \
In[140]:=",ExpressionUUID->"3fcc097c-219f-438f-bbbd-7975dc7c133b"],

Cell[BoxData[
 InterpretationBox["\<\"For a 10000-qubit computation: \
\\!\\(\\*SuperscriptBox[\\(\\!\\(\\*RowBox[{\\\"\\\\\\\"6.314\\\\\\\"\\\"}]\\)\
d\\), \\(3\\)]\\) (d=\\!\\(\\*RowBox[{\\\"17\\\"}]\\))\"\>",
  StringForm[
  "For a 10000-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\)]\) \
(d=`2`)", 
   NumberForm[
   6.3142707018242771515014212536937489659461021074236502070579`46.\
515839829836295, 4], 17],
  Editable->False]], "Print",
 CellChangeTimes->{3.772923123187987*^9},
 CellLabel->
  "During evaluation of \
In[140]:=",ExpressionUUID->"707ed62f-1407-4496-9e52-0e3170544c1c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CostOfTwoLevel20to4", "[", 
  RowBox[{
   SuperscriptBox["10", 
    RowBox[{"-", "4"}]], ",", "9", ",", "3", ",", "3", ",", "15", ",", "7", 
   ",", "9", ",", "4"}], "]"}]], "Input",
 CellChangeTimes->{{3.766183059585226*^9, 3.766183111731127*^9}, {
   3.7661833872934837`*^9, 3.7661834593171034`*^9}, {3.766183744920574*^9, 
   3.766183755311059*^9}, 3.766344034262905*^9, {3.7663444676105194`*^9, 
   3.766344480237499*^9}, {3.7666900889088783`*^9, 3.766690089463695*^9}, 
   3.772309270823765*^9},
 CellLabel->"In[59]:=",ExpressionUUID->"2961b85e-3821-4ff2-bb24-6ba4895a043b"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox["\<\"(15-to-1\\!\\(\\*SubscriptBox[SuperscriptBox[\\()\\), \
\\(\\!\\(\\*RowBox[{\\\"4\\\"}]\\)\\)], \\(\\!\\(\\*RowBox[{\\\"9\\\"}]\\), \
\\!\\(\\*RowBox[{\\\"3\\\"}]\\), \\!\\(\\*RowBox[{\\\"3\\\"}]\\)\\)]\\)\
\[Times](20-to-4\\!\\(\\*SubscriptBox[\\()\\), \
\\(\\!\\(\\*RowBox[{\\\"15\\\"}]\\), \\!\\(\\*RowBox[{\\\"7\\\"}]\\), \
\\!\\(\\*RowBox[{\\\"9\\\"}]\\)\\)]\\) with \\!\\(\\*SubscriptBox[\\(p\\), \
\\(phys\\)]\\)=\\!\\(\\*RowBox[{\\\"\\\\\\\"0.0001\\\\\\\"\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(x\\)]\\)=\\!\\(\\*RowBox[{\\\"9\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(z\\)]\\)=\\!\\(\\*RowBox[{\\\"3\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(m\\)]\\)=\\!\\(\\*RowBox[{\\\"3\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(x2\\)]\\)=\\!\\(\\*RowBox[{\\\"15\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(z2\\)]\\)=\\!\\(\\*RowBox[{\\\"7\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(m2\\)]\\)=\\!\\(\\*RowBox[{\\\"9\\\"}]\\) \
and \\!\\(\\*SubscriptBox[\\(n\\), \
\\(L1\\)]\\)=\\!\\(\\*RowBox[{\\\"4\\\"}]\\)\"\>",
  StringForm[
  "(15-to-1\!\(\*SubscriptBox[SuperscriptBox[\()\), \(`7`\)], \(`1`, `2`, `3`\
\)]\)\[Times](20-to-4\!\(\*SubscriptBox[\()\), \(`4`, `5`, `6`\)]\) with \!\(\
\*SubscriptBox[\(p\), \(phys\)]\)=`8`, \!\(\*SubscriptBox[\(d\), \
\(x\)]\)=`1`, \!\(\*SubscriptBox[\(d\), \(z\)]\)=`2`, \
\!\(\*SubscriptBox[\(d\), \(m\)]\)=`3`, \!\(\*SubscriptBox[\(d\), \
\(x2\)]\)=`4`, \!\(\*SubscriptBox[\(d\), \(z2\)]\)=`5`, \
\!\(\*SubscriptBox[\(d\), \(m2\)]\)=`6` and \!\(\*SubscriptBox[\(n\), \(L1\)]\
\)=`7`", 9, 3, 3, 15, 7, 9, 4, 
   NumberForm[0.0001]],
  Editable->False]], "Print",
 CellChangeTimes->{3.7728925338720665`*^9, 3.772923198162679*^9, 
  3.7729713530428057`*^9, 3.7729744476352367`*^9, 3.7729749436021624`*^9},
 CellLabel->
  "During evaluation of \
In[59]:=",ExpressionUUID->"e8f50537-a507-47bc-8ad8-b217affadd8b"],

Cell[BoxData[
 InterpretationBox["\<\"Output error: \\!\\(\\*SubscriptBox[\\(p\\), \
\\(out\\)]\\) = \\!\\(\\*RowBox[{\\\"\\\\\\\"2.391\\\\\\\"\\\", \
\\\"\[Times]\\\", SuperscriptBox[\\\"10\\\", \
\\\"\\\\\\\"-15\\\\\\\"\\\"]}]\\)\"\>",
  StringForm["Output error: \!\(\*SubscriptBox[\(p\), \(out\)]\) = `1`", 
   NumberForm[
   2.391070582299735915647257960518165878432314`30.990987776335434*^-15, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{3.7728925338720665`*^9, 3.772923198162679*^9, 
  3.7729713530428057`*^9, 3.7729744476352367`*^9, 3.7729749436127577`*^9},
 CellLabel->
  "During evaluation of \
In[59]:=",ExpressionUUID->"d4cf0d8a-1285-4a22-9dbf-bda778e2c6bf"],

Cell[BoxData[
 InterpretationBox["\<\"Failure probability: \\!\\(\\*SubscriptBox[\\(p\\), \
\\(fail\\)]\\) = \\!\\(\\*RowBox[{\\\"\\\\\\\"3.216\\\\\\\"\\\", \\\"\[Times]\
\\\", SuperscriptBox[\\\"10\\\", \\\"\\\\\\\"-7\\\\\\\"\\\"]}]\\)\"\>",
  StringForm[
  "Failure probability: \!\(\*SubscriptBox[\(p\), \(fail\)]\) = `1`", 
   NumberForm[
   3.215909259073315629862308087343308632515038596129067`38.863636537190885*^-\
7, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{3.7728925338720665`*^9, 3.772923198162679*^9, 
  3.7729713530428057`*^9, 3.7729744476352367`*^9, 3.772974943623731*^9},
 CellLabel->
  "During evaluation of \
In[59]:=",ExpressionUUID->"5505605b-2188-4ed3-a81b-574d2d5118ef"],

Cell[BoxData[
 InterpretationBox["\<\"Space cost: \\!\\(\\*RowBox[{\\\"16410\\\"}]\\) \
qubits\"\>",
  StringForm["Space cost: `1` qubits", 16410],
  Editable->False]], "Print",
 CellChangeTimes->{3.7728925338720665`*^9, 3.772923198162679*^9, 
  3.7729713530428057`*^9, 3.7729744476352367`*^9, 3.7729749436239634`*^9},
 CellLabel->
  "During evaluation of \
In[59]:=",ExpressionUUID->"52be35d0-be93-4240-b7a8-d61498b60952"],

Cell[BoxData[
 InterpretationBox["\<\"Time cost: \\!\\(\\*RowBox[{\\\"\\\\\\\"90.33\\\\\\\"\
\\\"}]\\) code cycles\"\>",
  StringForm["Time cost: `1` code cycles", 
   NumberForm[90.3295895347150368782`4., 4]],
  Editable->False]], "Print",
 CellChangeTimes->{3.7728925338720665`*^9, 3.772923198162679*^9, 
  3.7729713530428057`*^9, 3.7729744476352367`*^9, 3.7729749436239634`*^9},
 CellLabel->
  "During evaluation of \
In[59]:=",ExpressionUUID->"b9d327ed-b613-4818-9461-0fda46e58375"],

Cell[BoxData[
 InterpretationBox["\<\"Spacetime cost: \
\\!\\(\\*RowBox[{\\\"\\\\\\\"370600.\\\\\\\"\\\"}]\\) qubitcycles per output \
state\"\>",
  StringForm["Spacetime cost: `1` qubitcycles per output state", 
   NumberForm[
   370577.1410661684387929216561509875459786928570935824374079502949`45.\
32717530044391, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{3.7728925338720665`*^9, 3.772923198162679*^9, 
  3.7729713530428057`*^9, 3.7729744476352367`*^9, 3.772974943632015*^9},
 CellLabel->
  "During evaluation of \
In[59]:=",ExpressionUUID->"a0c1f8b8-b33f-4deb-ab9c-ae9fa9a9c398"],

Cell[BoxData[
 InterpretationBox["\<\"For a 100-qubit computation: \\!\\(\\*SuperscriptBox[\
\\(\\!\\(\\*RowBox[{\\\"\\\\\\\"27.01\\\\\\\"\\\"}]\\)d\\), \\(3\\)]\\) \
(d=\\!\\(\\*RowBox[{\\\"19\\\"}]\\))\"\>",
  StringForm[
  "For a 100-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\)]\) \
(d=`2`)", 
   NumberForm[
   27.0139335957259395533548371592788705335101951518867500661854`45.\
32717530044391, 4], 19],
  Editable->False]], "Print",
 CellChangeTimes->{3.7728925338720665`*^9, 3.772923198162679*^9, 
  3.7729713530428057`*^9, 3.7729744476352367`*^9, 3.772974943632015*^9},
 CellLabel->
  "During evaluation of \
In[59]:=",ExpressionUUID->"2b8cfd64-4d48-458a-8445-dddc07712c63"],

Cell[BoxData[
 InterpretationBox["\<\"For a 10000-qubit computation: \
\\!\\(\\*SuperscriptBox[\\(\\!\\(\\*RowBox[{\\\"\\\\\\\"20.01\\\\\\\"\\\"}]\\)\
d\\), \\(3\\)]\\) (d=\\!\\(\\*RowBox[{\\\"21\\\"}]\\))\"\>",
  StringForm[
  "For a 10000-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\)]\) \
(d=`2`)", 
   NumberForm[
   20.0074042255786869016802535444869639336298918633831355905408`45.\
32717530044391, 4], 21],
  Editable->False]], "Print",
 CellChangeTimes->{3.7728925338720665`*^9, 3.772923198162679*^9, 
  3.7729713530428057`*^9, 3.7729744476352367`*^9, 3.772974943642376*^9},
 CellLabel->
  "During evaluation of \
In[59]:=",ExpressionUUID->"bc555260-a56e-4561-8d5c-1078f608dac8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CostOfTwoLevel15to1", "[", 
  RowBox[{
   SuperscriptBox["10", 
    RowBox[{"-", "4"}]], ",", "9", ",", "3", ",", "3", ",", "25", ",", "9", 
   ",", "9", ",", "4"}], "]"}]], "Input",
 CellChangeTimes->{{3.766009147216848*^9, 3.7660091577948275`*^9}, {
   3.7661766282040415`*^9, 3.7661766538818016`*^9}, {3.766429818405778*^9, 
   3.7664298441242175`*^9}, {3.766431109589649*^9, 3.766431127511307*^9}, 
   3.7723093018446493`*^9},
 CellLabel->"In[48]:=",ExpressionUUID->"aded8002-718c-4220-aebc-077146646eb0"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox["\<\"(15-to-1\\!\\(\\*SubscriptBox[SuperscriptBox[\\()\\), \
\\(\\!\\(\\*RowBox[{\\\"4\\\"}]\\)\\)], \\(\\!\\(\\*RowBox[{\\\"9\\\"}]\\), \
\\!\\(\\*RowBox[{\\\"3\\\"}]\\), \\!\\(\\*RowBox[{\\\"3\\\"}]\\)\\)]\\)\
\[Times](15-to-1\\!\\(\\*SubscriptBox[\\()\\), \
\\(\\!\\(\\*RowBox[{\\\"25\\\"}]\\), \\!\\(\\*RowBox[{\\\"9\\\"}]\\), \
\\!\\(\\*RowBox[{\\\"9\\\"}]\\)\\)]\\) with \\!\\(\\*SubscriptBox[\\(p\\), \
\\(phys\\)]\\)=\\!\\(\\*RowBox[{\\\"\\\\\\\"0.0001\\\\\\\"\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(x\\)]\\)=\\!\\(\\*RowBox[{\\\"9\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(z\\)]\\)=\\!\\(\\*RowBox[{\\\"3\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(m\\)]\\)=\\!\\(\\*RowBox[{\\\"3\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(x2\\)]\\)=\\!\\(\\*RowBox[{\\\"25\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(z2\\)]\\)=\\!\\(\\*RowBox[{\\\"9\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(m2\\)]\\)=\\!\\(\\*RowBox[{\\\"9\\\"}]\\) \
and \\!\\(\\*SubscriptBox[\\(n\\), \
\\(L1\\)]\\)=\\!\\(\\*RowBox[{\\\"4\\\"}]\\)\"\>",
  StringForm[
  "(15-to-1\!\(\*SubscriptBox[SuperscriptBox[\()\), \(`7`\)], \(`1`, `2`, `3`\
\)]\)\[Times](15-to-1\!\(\*SubscriptBox[\()\), \(`4`, `5`, `6`\)]\) with \!\(\
\*SubscriptBox[\(p\), \(phys\)]\)=`8`, \!\(\*SubscriptBox[\(d\), \
\(x\)]\)=`1`, \!\(\*SubscriptBox[\(d\), \(z\)]\)=`2`, \
\!\(\*SubscriptBox[\(d\), \(m\)]\)=`3`, \!\(\*SubscriptBox[\(d\), \
\(x2\)]\)=`4`, \!\(\*SubscriptBox[\(d\), \(z2\)]\)=`5`, \
\!\(\*SubscriptBox[\(d\), \(m2\)]\)=`6` and \!\(\*SubscriptBox[\(n\), \(L1\)]\
\)=`7`", 9, 3, 3, 25, 9, 9, 4, 
   NumberForm[0.0001]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.765723437480502*^9, 3.7657243447056227`*^9, 3.765738806663923*^9, 
   3.765740514752411*^9, 3.7657405950467005`*^9, 3.765740633618956*^9, 
   3.765740796137394*^9, 3.766008809199894*^9, {3.766009149794937*^9, 
   3.7660091604666605`*^9}, 3.7661766572267523`*^9, 3.7661768675067887`*^9, 
   3.76618383987057*^9, 3.7662420664835544`*^9, 3.7662421929679637`*^9, 
   3.7662474651182966`*^9, 3.766248729617205*^9, 3.7662646184811563`*^9, 
   3.7662647346922255`*^9, 3.7663570040398884`*^9, 3.766391893872539*^9, 
   3.7663932920431447`*^9, 3.766402581877266*^9, 3.766402935195102*^9, 
   3.766428970883665*^9, {3.766429816265175*^9, 3.7664298475460467`*^9}, {
   3.7664311128708563`*^9, 3.766431131011262*^9}, 3.7664978879564514`*^9, 
   3.766690217834379*^9, 3.766692003977744*^9, 3.766692202668302*^9, 
   3.7666923795921183`*^9, 3.766704319859997*^9, 3.7667057372876616`*^9, 
   3.766707374453724*^9, 3.7723056682528024`*^9, 3.772308046970337*^9, 
   3.77230937328142*^9, 3.772748481213256*^9, 3.7727515468376665`*^9, 
   3.7728925374761486`*^9, 3.772923201425082*^9, 3.7729713558628516`*^9, 
   3.772972896764737*^9},
 CellLabel->
  "During evaluation of \
In[48]:=",ExpressionUUID->"97ae4f87-a0f1-4ec1-8fbb-f4bfef6fc2b4"],

Cell[BoxData[
 InterpretationBox["\<\"Output error: \\!\\(\\*SubscriptBox[\\(p\\), \
\\(out\\)]\\) = \\!\\(\\*RowBox[{\\\"\\\\\\\"6.332\\\\\\\"\\\", \
\\\"\[Times]\\\", SuperscriptBox[\\\"10\\\", \
\\\"\\\\\\\"-25\\\\\\\"\\\"]}]\\)\"\>",
  StringForm["Output error: \!\(\*SubscriptBox[\(p\), \(out\)]\) = `1`", 
   NumberForm[6.331747280951747004990962174621105`21.971535847699467*^-25, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.765723437480502*^9, 3.7657243447056227`*^9, 3.765738806663923*^9, 
   3.765740514752411*^9, 3.7657405950467005`*^9, 3.765740633618956*^9, 
   3.765740796137394*^9, 3.766008809199894*^9, {3.766009149794937*^9, 
   3.7660091604666605`*^9}, 3.7661766572267523`*^9, 3.7661768675067887`*^9, 
   3.76618383987057*^9, 3.7662420664835544`*^9, 3.7662421929679637`*^9, 
   3.7662474651182966`*^9, 3.766248729617205*^9, 3.7662646184811563`*^9, 
   3.7662647346922255`*^9, 3.7663570040398884`*^9, 3.766391893872539*^9, 
   3.7663932920431447`*^9, 3.766402581877266*^9, 3.766402935195102*^9, 
   3.766428970883665*^9, {3.766429816265175*^9, 3.7664298475460467`*^9}, {
   3.7664311128708563`*^9, 3.766431131011262*^9}, 3.7664978879564514`*^9, 
   3.766690217834379*^9, 3.766692003977744*^9, 3.766692202668302*^9, 
   3.7666923795921183`*^9, 3.766704319859997*^9, 3.7667057372876616`*^9, 
   3.766707374453724*^9, 3.7723056682528024`*^9, 3.772308046970337*^9, 
   3.77230937328142*^9, 3.772748481213256*^9, 3.7727515468376665`*^9, 
   3.7728925374761486`*^9, 3.772923201425082*^9, 3.7729713558628516`*^9, 
   3.7729728967707195`*^9},
 CellLabel->
  "During evaluation of \
In[48]:=",ExpressionUUID->"be3958af-6687-4208-8f19-6004f20e589e"],

Cell[BoxData[
 InterpretationBox["\<\"Failure probability: \\!\\(\\*SubscriptBox[\\(p\\), \
\\(fail\\)]\\) = \\!\\(\\*RowBox[{\\\"\\\\\\\"3.575\\\\\\\"\\\", \\\"\[Times]\
\\\", SuperscriptBox[\\\"10\\\", \\\"\\\\\\\"-8\\\\\\\"\\\"]}]\\)\"\>",
  StringForm[
  "Failure probability: \!\(\*SubscriptBox[\(p\), \(fail\)]\) = `1`", 
   NumberForm[
   3.5748739162103943222919926115686416097063653262441`39.06710096317156*^-8, 
    4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.765723437480502*^9, 3.7657243447056227`*^9, 3.765738806663923*^9, 
   3.765740514752411*^9, 3.7657405950467005`*^9, 3.765740633618956*^9, 
   3.765740796137394*^9, 3.766008809199894*^9, {3.766009149794937*^9, 
   3.7660091604666605`*^9}, 3.7661766572267523`*^9, 3.7661768675067887`*^9, 
   3.76618383987057*^9, 3.7662420664835544`*^9, 3.7662421929679637`*^9, 
   3.7662474651182966`*^9, 3.766248729617205*^9, 3.7662646184811563`*^9, 
   3.7662647346922255`*^9, 3.7663570040398884`*^9, 3.766391893872539*^9, 
   3.7663932920431447`*^9, 3.766402581877266*^9, 3.766402935195102*^9, 
   3.766428970883665*^9, {3.766429816265175*^9, 3.7664298475460467`*^9}, {
   3.7664311128708563`*^9, 3.766431131011262*^9}, 3.7664978879564514`*^9, 
   3.766690217834379*^9, 3.766692003977744*^9, 3.766692202668302*^9, 
   3.7666923795921183`*^9, 3.766704319859997*^9, 3.7667057372876616`*^9, 
   3.766707374453724*^9, 3.7723056682528024`*^9, 3.772308046970337*^9, 
   3.77230937328142*^9, 3.772748481213256*^9, 3.7727515468376665`*^9, 
   3.7728925374761486`*^9, 3.772923201425082*^9, 3.7729713558628516`*^9, 
   3.7729728967786975`*^9},
 CellLabel->
  "During evaluation of \
In[48]:=",ExpressionUUID->"78ae19c8-1d17-470b-8a46-a8db756edb3b"],

Cell[BoxData[
 InterpretationBox["\<\"Space cost: \\!\\(\\*RowBox[{\\\"18630\\\"}]\\) \
qubits\"\>",
  StringForm["Space cost: `1` qubits", 18630],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.765723437480502*^9, 3.7657243447056227`*^9, 3.765738806663923*^9, 
   3.765740514752411*^9, 3.7657405950467005`*^9, 3.765740633618956*^9, 
   3.765740796137394*^9, 3.766008809199894*^9, {3.766009149794937*^9, 
   3.7660091604666605`*^9}, 3.7661766572267523`*^9, 3.7661768675067887`*^9, 
   3.76618383987057*^9, 3.7662420664835544`*^9, 3.7662421929679637`*^9, 
   3.7662474651182966`*^9, 3.766248729617205*^9, 3.7662646184811563`*^9, 
   3.7662647346922255`*^9, 3.7663570040398884`*^9, 3.766391893872539*^9, 
   3.7663932920431447`*^9, 3.766402581877266*^9, 3.766402935195102*^9, 
   3.766428970883665*^9, {3.766429816265175*^9, 3.7664298475460467`*^9}, {
   3.7664311128708563`*^9, 3.766431131011262*^9}, 3.7664978879564514`*^9, 
   3.766690217834379*^9, 3.766692003977744*^9, 3.766692202668302*^9, 
   3.7666923795921183`*^9, 3.766704319859997*^9, 3.7667057372876616`*^9, 
   3.766707374453724*^9, 3.7723056682528024`*^9, 3.772308046970337*^9, 
   3.77230937328142*^9, 3.772748481213256*^9, 3.7727515468376665`*^9, 
   3.7728925374761486`*^9, 3.772923201425082*^9, 3.7729713558628516`*^9, 
   3.772972896781689*^9},
 CellLabel->
  "During evaluation of \
In[48]:=",ExpressionUUID->"28730148-58a9-4f69-bfd4-58b441a37599"],

Cell[BoxData[
 InterpretationBox["\<\"Time cost: \\!\\(\\*RowBox[{\\\"\\\\\\\"67.75\\\\\\\"\
\\\"}]\\) code cycles\"\>",
  StringForm["Time cost: `1` code cycles", 
   NumberForm[67.7471727860300350828`4., 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.765723437480502*^9, 3.7657243447056227`*^9, 3.765738806663923*^9, 
   3.765740514752411*^9, 3.7657405950467005`*^9, 3.765740633618956*^9, 
   3.765740796137394*^9, 3.766008809199894*^9, {3.766009149794937*^9, 
   3.7660091604666605`*^9}, 3.7661766572267523`*^9, 3.7661768675067887`*^9, 
   3.76618383987057*^9, 3.7662420664835544`*^9, 3.7662421929679637`*^9, 
   3.7662474651182966`*^9, 3.766248729617205*^9, 3.7662646184811563`*^9, 
   3.7662647346922255`*^9, 3.7663570040398884`*^9, 3.766391893872539*^9, 
   3.7663932920431447`*^9, 3.766402581877266*^9, 3.766402935195102*^9, 
   3.766428970883665*^9, {3.766429816265175*^9, 3.7664298475460467`*^9}, {
   3.7664311128708563`*^9, 3.766431131011262*^9}, 3.7664978879564514`*^9, 
   3.766690217834379*^9, 3.766692003977744*^9, 3.766692202668302*^9, 
   3.7666923795921183`*^9, 3.766704319859997*^9, 3.7667057372876616`*^9, 
   3.766707374453724*^9, 3.7723056682528024`*^9, 3.772308046970337*^9, 
   3.77230937328142*^9, 3.772748481213256*^9, 3.7727515468376665`*^9, 
   3.7728925374761486`*^9, 3.772923201425082*^9, 3.7729713558628516`*^9, 
   3.7729728967846813`*^9},
 CellLabel->
  "During evaluation of \
In[48]:=",ExpressionUUID->"a0b601b7-2e16-4a99-a03b-064c66849699"],

Cell[BoxData[
 InterpretationBox["\<\"Spacetime cost: \
\\!\\(\\*RowBox[{\\\"\\\\\\\"1.262\\\\\\\"\\\", \\\"\[Times]\\\", \
SuperscriptBox[\\\"10\\\", \\\"\\\\\\\"6\\\\\\\"\\\"]}]\\) qubitcycles\"\>",
  StringForm["Spacetime cost: `1` qubitcycles", 
   NumberForm[
   1.2621298290037395535922257722228320886411644901076754068886798013`46.\
2132445147545*^6, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.765723437480502*^9, 3.7657243447056227`*^9, 3.765738806663923*^9, 
   3.765740514752411*^9, 3.7657405950467005`*^9, 3.765740633618956*^9, 
   3.765740796137394*^9, 3.766008809199894*^9, {3.766009149794937*^9, 
   3.7660091604666605`*^9}, 3.7661766572267523`*^9, 3.7661768675067887`*^9, 
   3.76618383987057*^9, 3.7662420664835544`*^9, 3.7662421929679637`*^9, 
   3.7662474651182966`*^9, 3.766248729617205*^9, 3.7662646184811563`*^9, 
   3.7662647346922255`*^9, 3.7663570040398884`*^9, 3.766391893872539*^9, 
   3.7663932920431447`*^9, 3.766402581877266*^9, 3.766402935195102*^9, 
   3.766428970883665*^9, {3.766429816265175*^9, 3.7664298475460467`*^9}, {
   3.7664311128708563`*^9, 3.766431131011262*^9}, 3.7664978879564514`*^9, 
   3.766690217834379*^9, 3.766692003977744*^9, 3.766692202668302*^9, 
   3.7666923795921183`*^9, 3.766704319859997*^9, 3.7667057372876616`*^9, 
   3.766707374453724*^9, 3.7723056682528024`*^9, 3.772308046970337*^9, 
   3.77230937328142*^9, 3.772748481213256*^9, 3.7727515468376665`*^9, 
   3.7728925374761486`*^9, 3.772923201425082*^9, 3.7729713558628516`*^9, 
   3.772972896787674*^9},
 CellLabel->
  "During evaluation of \
In[48]:=",ExpressionUUID->"96abc3b1-cf96-4976-a37f-3e04e46df9a7"],

Cell[BoxData[
 InterpretationBox["\<\"For a 100-qubit computation: \\!\\(\\*SuperscriptBox[\
\\(\\!\\(\\*RowBox[{\\\"\\\\\\\"25.87\\\\\\\"\\\"}]\\)d\\), \\(3\\)]\\) \
(d=\\!\\(\\*RowBox[{\\\"29\\\"}]\\))\"\>",
  StringForm[
  "For a 100-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\)]\) \
(d=`2`)", 
   NumberForm[
   25.8749811186137101478581690971920146098889763850029809932528`46.\
2132445147545, 4], 29],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.765723437480502*^9, 3.7657243447056227`*^9, 3.765738806663923*^9, 
   3.765740514752411*^9, 3.7657405950467005`*^9, 3.765740633618956*^9, 
   3.765740796137394*^9, 3.766008809199894*^9, {3.766009149794937*^9, 
   3.7660091604666605`*^9}, 3.7661766572267523`*^9, 3.7661768675067887`*^9, 
   3.76618383987057*^9, 3.7662420664835544`*^9, 3.7662421929679637`*^9, 
   3.7662474651182966`*^9, 3.766248729617205*^9, 3.7662646184811563`*^9, 
   3.7662647346922255`*^9, 3.7663570040398884`*^9, 3.766391893872539*^9, 
   3.7663932920431447`*^9, 3.766402581877266*^9, 3.766402935195102*^9, 
   3.766428970883665*^9, {3.766429816265175*^9, 3.7664298475460467`*^9}, {
   3.7664311128708563`*^9, 3.766431131011262*^9}, 3.7664978879564514`*^9, 
   3.766690217834379*^9, 3.766692003977744*^9, 3.766692202668302*^9, 
   3.7666923795921183`*^9, 3.766704319859997*^9, 3.7667057372876616`*^9, 
   3.766707374453724*^9, 3.7723056682528024`*^9, 3.772308046970337*^9, 
   3.77230937328142*^9, 3.772748481213256*^9, 3.7727515468376665`*^9, 
   3.7728925374761486`*^9, 3.772923201425082*^9, 3.7729713558628516`*^9, 
   3.7729728967906666`*^9},
 CellLabel->
  "During evaluation of \
In[48]:=",ExpressionUUID->"63a4da7d-56c6-4c66-ab8a-7b33e9f587a2"],

Cell[BoxData[
 InterpretationBox["\<\"For a 10000-qubit computation: \
\\!\\(\\*SuperscriptBox[\\(\\!\\(\\*RowBox[{\\\"\\\\\\\"21.18\\\\\\\"\\\"}]\\)\
d\\), \\(3\\)]\\) (d=\\!\\(\\*RowBox[{\\\"31\\\"}]\\))\"\>",
  StringForm[
  "For a 10000-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\)]\) \
(d=`2`)", 
   NumberForm[
   21.1830725555325358932601418586625505797248244454310933988264`46.\
2132445147545, 4], 31],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.765723437480502*^9, 3.7657243447056227`*^9, 3.765738806663923*^9, 
   3.765740514752411*^9, 3.7657405950467005`*^9, 3.765740633618956*^9, 
   3.765740796137394*^9, 3.766008809199894*^9, {3.766009149794937*^9, 
   3.7660091604666605`*^9}, 3.7661766572267523`*^9, 3.7661768675067887`*^9, 
   3.76618383987057*^9, 3.7662420664835544`*^9, 3.7662421929679637`*^9, 
   3.7662474651182966`*^9, 3.766248729617205*^9, 3.7662646184811563`*^9, 
   3.7662647346922255`*^9, 3.7663570040398884`*^9, 3.766391893872539*^9, 
   3.7663932920431447`*^9, 3.766402581877266*^9, 3.766402935195102*^9, 
   3.766428970883665*^9, {3.766429816265175*^9, 3.7664298475460467`*^9}, {
   3.7664311128708563`*^9, 3.766431131011262*^9}, 3.7664978879564514`*^9, 
   3.766690217834379*^9, 3.766692003977744*^9, 3.766692202668302*^9, 
   3.7666923795921183`*^9, 3.766704319859997*^9, 3.7667057372876616`*^9, 
   3.766707374453724*^9, 3.7723056682528024`*^9, 3.772308046970337*^9, 
   3.77230937328142*^9, 3.772748481213256*^9, 3.7727515468376665`*^9, 
   3.7728925374761486`*^9, 3.772923201425082*^9, 3.7729713558628516`*^9, 
   3.7729728967936583`*^9},
 CellLabel->
  "During evaluation of \
In[48]:=",ExpressionUUID->"aafd3179-cd94-46f7-93b8-cadd5828009a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["p", "phys"], "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "3"}]]}], 
  TraditionalForm]], \
"Chapter",ExpressionUUID->"528dccfa-41c8-493e-ba0d-ad1001f3844c"]], "Chapter",
 CellChangeTimes->{{3.764790754263265*^9, 3.764790767012478*^9}, {
  3.764791547106655*^9, 
  3.7647915472225523`*^9}},ExpressionUUID->"fd8ade6d-11fc-418d-b51d-\
3fc59ad1ac0b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CostOfOneLevel15to1", "[", 
  RowBox[{
   SuperscriptBox["10", 
    RowBox[{"-", "3"}]], ",", "17", ",", "7", ",", "7"}], "]"}]], "Input",
 CellChangeTimes->{{3.76479155679858*^9, 3.764791566693867*^9}, 
   3.7657205585526204`*^9, {3.766183904037754*^9, 3.7661839918564615`*^9}, {
   3.7662244230509515`*^9, 3.7662244231759496`*^9}, {3.7664298546865897`*^9, 
   3.766429895045477*^9}, {3.772308079845626*^9, 3.7723080917062225`*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"aa224796-0311-490e-9e30-ab7b13101bbf"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox["\<\"(15-to-1\\!\\(\\*SubscriptBox[\\()\\), \
\\(\\!\\(\\*RowBox[{\\\"17\\\"}]\\), \\!\\(\\*RowBox[{\\\"7\\\"}]\\), \
\\!\\(\\*RowBox[{\\\"7\\\"}]\\)\\)]\\) with \\!\\(\\*SubscriptBox[\\(p\\), \
\\(phys\\)]\\)=\\!\\(\\*RowBox[{\\\"\\\\\\\"0.001\\\\\\\"\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(x\\)]\\)=\\!\\(\\*RowBox[{\\\"17\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(z\\)]\\)=\\!\\(\\*RowBox[{\\\"7\\\"}]\\) \
and \\!\\(\\*SubscriptBox[\\(d\\), \
\\(m\\)]\\)=\\!\\(\\*RowBox[{\\\"7\\\"}]\\)\"\>",
  StringForm[
  "(15-to-1\!\(\*SubscriptBox[\()\), \(`1`, `2`, `3`\)]\) with \
\!\(\*SubscriptBox[\(p\), \(phys\)]\)=`4`, \!\(\*SubscriptBox[\(d\), \
\(x\)]\)=`1`, \!\(\*SubscriptBox[\(d\), \(z\)]\)=`2` and \
\!\(\*SubscriptBox[\(d\), \(m\)]\)=`3`", 17, 7, 7, 
   NumberForm[0.001]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.764791568676465*^9, 3.7647940376785774`*^9, 3.7649451105090036`*^9, 
   3.765105952092574*^9, 3.7654101745794415`*^9, 3.765518226818023*^9, 
   3.765640750059136*^9, 3.7656586673833914`*^9, 3.7656631681298933`*^9, 
   3.7656634607075653`*^9, 3.765720571161493*^9, 3.7657243475886793`*^9, 
   3.7657274080334606`*^9, 3.76573881413839*^9, 3.766008810590499*^9, 
   3.7660091663259525`*^9, 3.766176876444168*^9, {3.7661839211653175`*^9, 
   3.7661839937470613`*^9}, 3.7662244250821705`*^9, 3.766242194764814*^9, 
   3.766247357463496*^9, 3.7662474666182747`*^9, 3.7662487311796837`*^9, 
   3.766391897763117*^9, 3.766393293574376*^9, 3.7664029368044567`*^9, 
   3.766428975211738*^9, {3.7664298528897333`*^9, 3.7664298972329473`*^9}, 
   3.766497946193357*^9, 3.766690219755746*^9, 3.7666923816806574`*^9, 
   3.766704321785917*^9, 3.7667057392691865`*^9, 3.7667073764876757`*^9, 
   3.7722999936877127`*^9, 3.7723080690123224`*^9, 3.7723093747497845`*^9, 
   3.7727515515579166`*^9, 3.772892539318263*^9, 3.7729232029483337`*^9},
 CellLabel->
  "During evaluation of \
In[143]:=",ExpressionUUID->"be04bac7-75d4-42a4-97a8-9e2b8e028930"],

Cell[BoxData[
 InterpretationBox["\<\"Output error: \\!\\(\\*SubscriptBox[\\(p\\), \
\\(out\\)]\\) = \\!\\(\\*RowBox[{\\\"\\\\\\\"4.507\\\\\\\"\\\", \
\\\"\[Times]\\\", SuperscriptBox[\\\"10\\\", \\\"\\\\\\\"-8\\\\\\\"\\\"]}]\\)\
\"\>",
  StringForm["Output error: \!\(\*SubscriptBox[\(p\), \(out\)]\) = `1`", 
   NumberForm[
   4.50653791271748025249351505727860245332436110909216`38.81913540084133*^-8,
     4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.764791568676465*^9, 3.7647940376785774`*^9, 3.7649451105090036`*^9, 
   3.765105952092574*^9, 3.7654101745794415`*^9, 3.765518226818023*^9, 
   3.765640750059136*^9, 3.7656586673833914`*^9, 3.7656631681298933`*^9, 
   3.7656634607075653`*^9, 3.765720571161493*^9, 3.7657243475886793`*^9, 
   3.7657274080334606`*^9, 3.76573881413839*^9, 3.766008810590499*^9, 
   3.7660091663259525`*^9, 3.766176876444168*^9, {3.7661839211653175`*^9, 
   3.7661839937470613`*^9}, 3.7662244250821705`*^9, 3.766242194764814*^9, 
   3.766247357463496*^9, 3.7662474666182747`*^9, 3.7662487311796837`*^9, 
   3.766391897763117*^9, 3.766393293574376*^9, 3.7664029368044567`*^9, 
   3.766428975211738*^9, {3.7664298528897333`*^9, 3.7664298972329473`*^9}, 
   3.766497946193357*^9, 3.766690219755746*^9, 3.7666923816806574`*^9, 
   3.766704321785917*^9, 3.7667057392691865`*^9, 3.7667073764876757`*^9, 
   3.7722999936877127`*^9, 3.7723080690123224`*^9, 3.7723093747497845`*^9, 
   3.7727515515579166`*^9, 3.772892539318263*^9, 3.7729232029579797`*^9},
 CellLabel->
  "During evaluation of \
In[143]:=",ExpressionUUID->"d43a4418-dc13-4cbb-9051-defb45f6f006"],

Cell[BoxData[
 InterpretationBox["\<\"Failure probability: \\!\\(\\*SubscriptBox[\\(p\\), \
\\(fail\\)]\\) = \\!\\(\\*RowBox[{\\\"\\\\\\\"0.01489\\\\\\\"\\\"}]\\)\"\>",
  StringForm[
  "Failure probability: \!\(\*SubscriptBox[\(p\), \(fail\)]\) = `1`", 
   NumberForm[
   0.0148872345614272868056849217618898769680094698970764338789`44.\
68871483836502, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.764791568676465*^9, 3.7647940376785774`*^9, 3.7649451105090036`*^9, 
   3.765105952092574*^9, 3.7654101745794415`*^9, 3.765518226818023*^9, 
   3.765640750059136*^9, 3.7656586673833914`*^9, 3.7656631681298933`*^9, 
   3.7656634607075653`*^9, 3.765720571161493*^9, 3.7657243475886793`*^9, 
   3.7657274080334606`*^9, 3.76573881413839*^9, 3.766008810590499*^9, 
   3.7660091663259525`*^9, 3.766176876444168*^9, {3.7661839211653175`*^9, 
   3.7661839937470613`*^9}, 3.7662244250821705`*^9, 3.766242194764814*^9, 
   3.766247357463496*^9, 3.7662474666182747`*^9, 3.7662487311796837`*^9, 
   3.766391897763117*^9, 3.766393293574376*^9, 3.7664029368044567`*^9, 
   3.766428975211738*^9, {3.7664298528897333`*^9, 3.7664298972329473`*^9}, 
   3.766497946193357*^9, 3.766690219755746*^9, 3.7666923816806574`*^9, 
   3.766704321785917*^9, 3.7667057392691865`*^9, 3.7667073764876757`*^9, 
   3.7722999936877127`*^9, 3.7723080690123224`*^9, 3.7723093747497845`*^9, 
   3.7727515515579166`*^9, 3.772892539318263*^9, 3.7729232029625206`*^9},
 CellLabel->
  "During evaluation of \
In[143]:=",ExpressionUUID->"c2c2ee86-1d78-4be7-a6c4-b935d626e25c"],

Cell[BoxData[
 InterpretationBox["\<\"Space cost: \\!\\(\\*RowBox[{\\\"4618\\\"}]\\) qubits\
\"\>",
  StringForm["Space cost: `1` qubits", 4618],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.764791568676465*^9, 3.7647940376785774`*^9, 3.7649451105090036`*^9, 
   3.765105952092574*^9, 3.7654101745794415`*^9, 3.765518226818023*^9, 
   3.765640750059136*^9, 3.7656586673833914`*^9, 3.7656631681298933`*^9, 
   3.7656634607075653`*^9, 3.765720571161493*^9, 3.7657243475886793`*^9, 
   3.7657274080334606`*^9, 3.76573881413839*^9, 3.766008810590499*^9, 
   3.7660091663259525`*^9, 3.766176876444168*^9, {3.7661839211653175`*^9, 
   3.7661839937470613`*^9}, 3.7662244250821705`*^9, 3.766242194764814*^9, 
   3.766247357463496*^9, 3.7662474666182747`*^9, 3.7662487311796837`*^9, 
   3.766391897763117*^9, 3.766393293574376*^9, 3.7664029368044567`*^9, 
   3.766428975211738*^9, {3.7664298528897333`*^9, 3.7664298972329473`*^9}, 
   3.766497946193357*^9, 3.766690219755746*^9, 3.7666923816806574`*^9, 
   3.766704321785917*^9, 3.7667057392691865`*^9, 3.7667073764876757`*^9, 
   3.7722999936877127`*^9, 3.7723080690123224`*^9, 3.7723093747497845`*^9, 
   3.7727515515579166`*^9, 3.772892539318263*^9, 3.7729232029680595`*^9},
 CellLabel->
  "During evaluation of \
In[143]:=",ExpressionUUID->"4903dec6-f3e5-4ce9-9394-751ef572ef60"],

Cell[BoxData[
 InterpretationBox["\<\"Time cost: \\!\\(\\*RowBox[{\\\"\\\\\\\"42.63\\\\\\\"\
\\\"}]\\) code cycles\"\>",
  StringForm["Time cost: `1` code cycles", 
   NumberForm[
   42.6347129724804431454082214875869128496153705883859894133536`46.\
50938675409935, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.764791568676465*^9, 3.7647940376785774`*^9, 3.7649451105090036`*^9, 
   3.765105952092574*^9, 3.7654101745794415`*^9, 3.765518226818023*^9, 
   3.765640750059136*^9, 3.7656586673833914`*^9, 3.7656631681298933`*^9, 
   3.7656634607075653`*^9, 3.765720571161493*^9, 3.7657243475886793`*^9, 
   3.7657274080334606`*^9, 3.76573881413839*^9, 3.766008810590499*^9, 
   3.7660091663259525`*^9, 3.766176876444168*^9, {3.7661839211653175`*^9, 
   3.7661839937470613`*^9}, 3.7662244250821705`*^9, 3.766242194764814*^9, 
   3.766247357463496*^9, 3.7662474666182747`*^9, 3.7662487311796837`*^9, 
   3.766391897763117*^9, 3.766393293574376*^9, 3.7664029368044567`*^9, 
   3.766428975211738*^9, {3.7664298528897333`*^9, 3.7664298972329473`*^9}, 
   3.766497946193357*^9, 3.766690219755746*^9, 3.7666923816806574`*^9, 
   3.766704321785917*^9, 3.7667057392691865`*^9, 3.7667073764876757`*^9, 
   3.7722999936877127`*^9, 3.7723080690123224`*^9, 3.7723093747497845`*^9, 
   3.7727515515579166`*^9, 3.772892539318263*^9, 3.7729232029680595`*^9},
 CellLabel->
  "During evaluation of \
In[143]:=",ExpressionUUID->"405d44e5-38b6-4ab3-950a-4c42e1880cfc"],

Cell[BoxData[
 InterpretationBox["\<\"Spacetime cost: \
\\!\\(\\*RowBox[{\\\"\\\\\\\"196900.\\\\\\\"\\\"}]\\) qubitcycles\"\>",
  StringForm["Spacetime cost: `1` qubitcycles", 
   NumberForm[
   196887.1045069146864454951668296763635395237813771664991108670743`46.\
50938675409935, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.764791568676465*^9, 3.7647940376785774`*^9, 3.7649451105090036`*^9, 
   3.765105952092574*^9, 3.7654101745794415`*^9, 3.765518226818023*^9, 
   3.765640750059136*^9, 3.7656586673833914`*^9, 3.7656631681298933`*^9, 
   3.7656634607075653`*^9, 3.765720571161493*^9, 3.7657243475886793`*^9, 
   3.7657274080334606`*^9, 3.76573881413839*^9, 3.766008810590499*^9, 
   3.7660091663259525`*^9, 3.766176876444168*^9, {3.7661839211653175`*^9, 
   3.7661839937470613`*^9}, 3.7662244250821705`*^9, 3.766242194764814*^9, 
   3.766247357463496*^9, 3.7662474666182747`*^9, 3.7662487311796837`*^9, 
   3.766391897763117*^9, 3.766393293574376*^9, 3.7664029368044567`*^9, 
   3.766428975211738*^9, {3.7664298528897333`*^9, 3.7664298972329473`*^9}, 
   3.766497946193357*^9, 3.766690219755746*^9, 3.7666923816806574`*^9, 
   3.766704321785917*^9, 3.7667057392691865`*^9, 3.7667073764876757`*^9, 
   3.7722999936877127`*^9, 3.7723080690123224`*^9, 3.7723093747497845`*^9, 
   3.7727515515579166`*^9, 3.772892539318263*^9, 3.7729232029680595`*^9},
 CellLabel->
  "During evaluation of \
In[143]:=",ExpressionUUID->"a465d2d6-50ac-4120-ac29-4970ac0d661a"],

Cell[BoxData[
 InterpretationBox["\<\"For a 100-qubit computation: \\!\\(\\*SuperscriptBox[\
\\(\\!\\(\\*RowBox[{\\\"\\\\\\\"6.300\\\\\\\"\\\"}]\\)d\\), \\(3\\)]\\) \
(d=\\!\\(\\*RowBox[{\\\"25\\\"}]\\))\"\>",
  StringForm[
  "For a 100-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\)]\) \
(d=`2`)", 
   NumberForm[
   6.3003873442212699662558453385496436332647610040693279715477`46.\
50938675409935, 4], 25],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.764791568676465*^9, 3.7647940376785774`*^9, 3.7649451105090036`*^9, 
   3.765105952092574*^9, 3.7654101745794415`*^9, 3.765518226818023*^9, 
   3.765640750059136*^9, 3.7656586673833914`*^9, 3.7656631681298933`*^9, 
   3.7656634607075653`*^9, 3.765720571161493*^9, 3.7657243475886793`*^9, 
   3.7657274080334606`*^9, 3.76573881413839*^9, 3.766008810590499*^9, 
   3.7660091663259525`*^9, 3.766176876444168*^9, {3.7661839211653175`*^9, 
   3.7661839937470613`*^9}, 3.7662244250821705`*^9, 3.766242194764814*^9, 
   3.766247357463496*^9, 3.7662474666182747`*^9, 3.7662487311796837`*^9, 
   3.766391897763117*^9, 3.766393293574376*^9, 3.7664029368044567`*^9, 
   3.766428975211738*^9, {3.7664298528897333`*^9, 3.7664298972329473`*^9}, 
   3.766497946193357*^9, 3.766690219755746*^9, 3.7666923816806574`*^9, 
   3.766704321785917*^9, 3.7667057392691865`*^9, 3.7667073764876757`*^9, 
   3.7722999936877127`*^9, 3.7723080690123224`*^9, 3.7723093747497845`*^9, 
   3.7727515515579166`*^9, 3.772892539318263*^9, 3.772923202978181*^9},
 CellLabel->
  "During evaluation of \
In[143]:=",ExpressionUUID->"647ab959-94a0-485b-a5e8-94f33e668fea"],

Cell[BoxData[
 InterpretationBox["\<\"For a 10000-qubit computation: \
\\!\\(\\*SuperscriptBox[\\(\\!\\(\\*RowBox[{\\\"\\\\\\\"4.036\\\\\\\"\\\"}]\\)\
d\\), \\(3\\)]\\) (d=\\!\\(\\*RowBox[{\\\"29\\\"}]\\))\"\>",
  StringForm[
  "For a 10000-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\)]\) \
(d=`2`)", 
   NumberForm[
   4.0363914983581673386669229330779524281340723559220652571009`46.\
50938675409935, 4], 29],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.764791568676465*^9, 3.7647940376785774`*^9, 3.7649451105090036`*^9, 
   3.765105952092574*^9, 3.7654101745794415`*^9, 3.765518226818023*^9, 
   3.765640750059136*^9, 3.7656586673833914`*^9, 3.7656631681298933`*^9, 
   3.7656634607075653`*^9, 3.765720571161493*^9, 3.7657243475886793`*^9, 
   3.7657274080334606`*^9, 3.76573881413839*^9, 3.766008810590499*^9, 
   3.7660091663259525`*^9, 3.766176876444168*^9, {3.7661839211653175`*^9, 
   3.7661839937470613`*^9}, 3.7662244250821705`*^9, 3.766242194764814*^9, 
   3.766247357463496*^9, 3.7662474666182747`*^9, 3.7662487311796837`*^9, 
   3.766391897763117*^9, 3.766393293574376*^9, 3.7664029368044567`*^9, 
   3.766428975211738*^9, {3.7664298528897333`*^9, 3.7664298972329473`*^9}, 
   3.766497946193357*^9, 3.766690219755746*^9, 3.7666923816806574`*^9, 
   3.766704321785917*^9, 3.7667057392691865`*^9, 3.7667073764876757`*^9, 
   3.7722999936877127`*^9, 3.7723080690123224`*^9, 3.7723093747497845`*^9, 
   3.7727515515579166`*^9, 3.772892539318263*^9, 3.772923202978181*^9},
 CellLabel->
  "During evaluation of \
In[143]:=",ExpressionUUID->"4f25109b-2332-4725-90a6-ebc413a9fe7d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CostOfTwoLevel20to4", "[", 
  RowBox[{
  "0.001", ",", "13", ",", "5", ",", "5", ",", "23", ",", "11", ",", "13", 
   ",", "6"}], "]"}]], "Input",
 CellChangeTimes->{{3.7664299094203033`*^9, 3.7664300265751348`*^9}, {
   3.7664430883438406`*^9, 3.7664430938125243`*^9}, 3.7666900842974*^9, 
   3.7723093096726165`*^9},
 CellLabel->"In[57]:=",ExpressionUUID->"19fb1c6f-1c94-42a5-a76b-172fabfe240f"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox["\<\"(15-to-1\\!\\(\\*SubscriptBox[SuperscriptBox[\\()\\), \
\\(\\!\\(\\*RowBox[{\\\"6\\\"}]\\)\\)], \\(\\!\\(\\*RowBox[{\\\"13\\\"}]\\), \
\\!\\(\\*RowBox[{\\\"5\\\"}]\\), \\!\\(\\*RowBox[{\\\"5\\\"}]\\)\\)]\\)\
\[Times](20-to-4\\!\\(\\*SubscriptBox[\\()\\), \
\\(\\!\\(\\*RowBox[{\\\"23\\\"}]\\), \\!\\(\\*RowBox[{\\\"11\\\"}]\\), \\!\\(\
\\*RowBox[{\\\"13\\\"}]\\)\\)]\\) with \\!\\(\\*SubscriptBox[\\(p\\), \\(phys\
\\)]\\)=\\!\\(\\*RowBox[{\\\"\\\\\\\"0.001\\\\\\\"\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(x\\)]\\)=\\!\\(\\*RowBox[{\\\"13\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(z\\)]\\)=\\!\\(\\*RowBox[{\\\"5\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(m\\)]\\)=\\!\\(\\*RowBox[{\\\"5\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(x2\\)]\\)=\\!\\(\\*RowBox[{\\\"23\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(z2\\)]\\)=\\!\\(\\*RowBox[{\\\"11\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(m2\\)]\\)=\\!\\(\\*RowBox[{\\\"13\\\"}]\\) \
and \\!\\(\\*SubscriptBox[\\(n\\), \
\\(L1\\)]\\)=\\!\\(\\*RowBox[{\\\"6\\\"}]\\)\"\>",
  StringForm[
  "(15-to-1\!\(\*SubscriptBox[SuperscriptBox[\()\), \(`7`\)], \(`1`, `2`, `3`\
\)]\)\[Times](20-to-4\!\(\*SubscriptBox[\()\), \(`4`, `5`, `6`\)]\) with \!\(\
\*SubscriptBox[\(p\), \(phys\)]\)=`8`, \!\(\*SubscriptBox[\(d\), \
\(x\)]\)=`1`, \!\(\*SubscriptBox[\(d\), \(z\)]\)=`2`, \
\!\(\*SubscriptBox[\(d\), \(m\)]\)=`3`, \!\(\*SubscriptBox[\(d\), \
\(x2\)]\)=`4`, \!\(\*SubscriptBox[\(d\), \(z2\)]\)=`5`, \
\!\(\*SubscriptBox[\(d\), \(m2\)]\)=`6` and \!\(\*SubscriptBox[\(n\), \(L1\)]\
\)=`7`", 13, 5, 5, 23, 11, 13, 6, 
   NumberForm[0.001]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.766407124438266*^9, 3.7664289825866475`*^9, {3.766429906904704*^9, 
   3.7664300298719673`*^9}, {3.7664430916562953`*^9, 3.766443097046855*^9}, 
   3.7664979972631435`*^9, 3.7666902228837147`*^9, 3.7666920108335133`*^9, 
   3.7666923850522704`*^9, 3.7666945283769007`*^9, 3.7667043250376663`*^9, 
   3.766707379689917*^9, 3.772309377609953*^9, 3.77275155637175*^9, 
   3.772892542203251*^9, 3.772923205898237*^9, 3.772923653071435*^9, 
   3.7729713590027504`*^9, 3.772974453686187*^9, 3.7729747792800436`*^9},
 CellLabel->
  "During evaluation of \
In[57]:=",ExpressionUUID->"1eeb1357-5b36-4856-8f8d-c07a0cf5ac41"],

Cell[BoxData[
 InterpretationBox["\<\"Output error: \\!\\(\\*SubscriptBox[\\(p\\), \
\\(out\\)]\\) = \\!\\(\\*RowBox[{\\\"\\\\\\\"1.443\\\\\\\"\\\", \
\\\"\[Times]\\\", SuperscriptBox[\\\"10\\\", \
\\\"\\\\\\\"-10\\\\\\\"\\\"]}]\\)\"\>",
  StringForm["Output error: \!\(\*SubscriptBox[\(p\), \(out\)]\) = `1`", 
   NumberForm[1.4427498085112234`*^-10, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.766407124438266*^9, 3.7664289825866475`*^9, {3.766429906904704*^9, 
   3.7664300298719673`*^9}, {3.7664430916562953`*^9, 3.766443097046855*^9}, 
   3.7664979972631435`*^9, 3.7666902228837147`*^9, 3.7666920108335133`*^9, 
   3.7666923850522704`*^9, 3.7666945283769007`*^9, 3.7667043250376663`*^9, 
   3.766707379689917*^9, 3.772309377609953*^9, 3.77275155637175*^9, 
   3.772892542203251*^9, 3.772923205898237*^9, 3.772923653071435*^9, 
   3.7729713590027504`*^9, 3.772974453686187*^9, 3.7729747792850533`*^9},
 CellLabel->
  "During evaluation of \
In[57]:=",ExpressionUUID->"7af19f18-2d54-4092-b492-a96c88f7f047"],

Cell[BoxData[
 InterpretationBox["\<\"Failure probability: \\!\\(\\*SubscriptBox[\\(p\\), \
\\(fail\\)]\\) = \\!\\(\\*RowBox[{\\\"\\\\\\\"0.0001128\\\\\\\"\\\"}]\\)\"\>",
  StringForm[
  "Failure probability: \!\(\*SubscriptBox[\(p\), \(fail\)]\) = `1`", 
   NumberForm[0.00011284318808835181`, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.766407124438266*^9, 3.7664289825866475`*^9, {3.766429906904704*^9, 
   3.7664300298719673`*^9}, {3.7664430916562953`*^9, 3.766443097046855*^9}, 
   3.7664979972631435`*^9, 3.7666902228837147`*^9, 3.7666920108335133`*^9, 
   3.7666923850522704`*^9, 3.7666945283769007`*^9, 3.7667043250376663`*^9, 
   3.766707379689917*^9, 3.772309377609953*^9, 3.77275155637175*^9, 
   3.772892542203251*^9, 3.772923205898237*^9, 3.772923653071435*^9, 
   3.7729713590027504`*^9, 3.772974453686187*^9, 3.772974779294073*^9},
 CellLabel->
  "During evaluation of \
In[57]:=",ExpressionUUID->"2cdfd685-900f-4d8e-8cc1-888cd3a588b1"],

Cell[BoxData[
 InterpretationBox["\<\"Space cost: \\!\\(\\*RowBox[{\\\"43344\\\"}]\\) \
qubits\"\>",
  StringForm["Space cost: `1` qubits", 43344],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.766407124438266*^9, 3.7664289825866475`*^9, {3.766429906904704*^9, 
   3.7664300298719673`*^9}, {3.7664430916562953`*^9, 3.766443097046855*^9}, 
   3.7664979972631435`*^9, 3.7666902228837147`*^9, 3.7666920108335133`*^9, 
   3.7666923850522704`*^9, 3.7666945283769007`*^9, 3.7667043250376663`*^9, 
   3.766707379689917*^9, 3.772309377609953*^9, 3.77275155637175*^9, 
   3.772892542203251*^9, 3.772923205898237*^9, 3.772923653071435*^9, 
   3.7729713590027504`*^9, 3.772974453686187*^9, 3.772974779302136*^9},
 CellLabel->
  "During evaluation of \
In[57]:=",ExpressionUUID->"24e4ca6f-f5da-4c37-b359-5c71190e5d77"],

Cell[BoxData[
 InterpretationBox["\<\"Time cost: \
\\!\\(\\*RowBox[{\\\"\\\\\\\"130.\\\\\\\"\\\"}]\\) code cycles\"\>",
  StringForm["Time cost: `1` code cycles", 
   NumberForm[130.01467127000436`, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.766407124438266*^9, 3.7664289825866475`*^9, {3.766429906904704*^9, 
   3.7664300298719673`*^9}, {3.7664430916562953`*^9, 3.766443097046855*^9}, 
   3.7664979972631435`*^9, 3.7666902228837147`*^9, 3.7666920108335133`*^9, 
   3.7666923850522704`*^9, 3.7666945283769007`*^9, 3.7667043250376663`*^9, 
   3.766707379689917*^9, 3.772309377609953*^9, 3.77275155637175*^9, 
   3.772892542203251*^9, 3.772923205898237*^9, 3.772923653071435*^9, 
   3.7729713590027504`*^9, 3.772974453686187*^9, 3.772974779302136*^9},
 CellLabel->
  "During evaluation of \
In[57]:=",ExpressionUUID->"96c2edfe-87cd-462e-b2e9-bf1ecac17776"],

Cell[BoxData[
 InterpretationBox["\<\"Spacetime cost: \
\\!\\(\\*RowBox[{\\\"\\\\\\\"1.409\\\\\\\"\\\", \\\"\[Times]\\\", \
SuperscriptBox[\\\"10\\\", \\\"\\\\\\\"6\\\\\\\"\\\"]}]\\) qubitcycles per \
output state\"\>",
  StringForm["Spacetime cost: `1` qubitcycles per output state", 
   NumberForm[1.4088389778817673`*^6, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.766407124438266*^9, 3.7664289825866475`*^9, {3.766429906904704*^9, 
   3.7664300298719673`*^9}, {3.7664430916562953`*^9, 3.766443097046855*^9}, 
   3.7664979972631435`*^9, 3.7666902228837147`*^9, 3.7666920108335133`*^9, 
   3.7666923850522704`*^9, 3.7666945283769007`*^9, 3.7667043250376663`*^9, 
   3.766707379689917*^9, 3.772309377609953*^9, 3.77275155637175*^9, 
   3.772892542203251*^9, 3.772923205898237*^9, 3.772923653071435*^9, 
   3.7729713590027504`*^9, 3.772974453686187*^9, 3.772974779302136*^9},
 CellLabel->
  "During evaluation of \
In[57]:=",ExpressionUUID->"cf100b7f-0c38-4b7d-964b-f9ca452cc909"],

Cell[BoxData[
 InterpretationBox["\<\"For a 100-qubit computation: \\!\\(\\*SuperscriptBox[\
\\(\\!\\(\\*RowBox[{\\\"\\\\\\\"28.88\\\\\\\"\\\"}]\\)d\\), \\(3\\)]\\) \
(d=\\!\\(\\*RowBox[{\\\"29\\\"}]\\))\"\>",
  StringForm[
  "For a 100-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\)]\) \
(d=`2`)", 
   NumberForm[28.882672062851434`, 4], 29],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.766407124438266*^9, 3.7664289825866475`*^9, {3.766429906904704*^9, 
   3.7664300298719673`*^9}, {3.7664430916562953`*^9, 3.766443097046855*^9}, 
   3.7664979972631435`*^9, 3.7666902228837147`*^9, 3.7666920108335133`*^9, 
   3.7666923850522704`*^9, 3.7666945283769007`*^9, 3.7667043250376663`*^9, 
   3.766707379689917*^9, 3.772309377609953*^9, 3.77275155637175*^9, 
   3.772892542203251*^9, 3.772923205898237*^9, 3.772923653071435*^9, 
   3.7729713590027504`*^9, 3.772974453686187*^9, 3.7729747793123045`*^9},
 CellLabel->
  "During evaluation of \
In[57]:=",ExpressionUUID->"6a377a8f-3363-44e9-911a-a94464d549d8"],

Cell[BoxData[
 InterpretationBox["\<\"For a 10000-qubit computation: \
\\!\\(\\*SuperscriptBox[\\(\\!\\(\\*RowBox[{\\\"\\\\\\\"19.6\\\\\\\"\\\"}]\\)\
d\\), \\(3\\)]\\) (d=\\!\\(\\*RowBox[{\\\"33\\\"}]\\))\"\>",
  StringForm[
  "For a 10000-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\)]\) \
(d=`2`)", 
   NumberForm[19.60151066980782, 4], 33],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.766407124438266*^9, 3.7664289825866475`*^9, {3.766429906904704*^9, 
   3.7664300298719673`*^9}, {3.7664430916562953`*^9, 3.766443097046855*^9}, 
   3.7664979972631435`*^9, 3.7666902228837147`*^9, 3.7666920108335133`*^9, 
   3.7666923850522704`*^9, 3.7666945283769007`*^9, 3.7667043250376663`*^9, 
   3.766707379689917*^9, 3.772309377609953*^9, 3.77275155637175*^9, 
   3.772892542203251*^9, 3.772923205898237*^9, 3.772923653071435*^9, 
   3.7729713590027504`*^9, 3.772974453686187*^9, 3.7729747793123045`*^9},
 CellLabel->
  "During evaluation of \
In[57]:=",ExpressionUUID->"e9842c8f-111a-4587-a810-f18982c0480e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CostOfTwoLevel20to4", "[", 
  RowBox[{
  "0.001", ",", "13", ",", "5", ",", "5", ",", "27", ",", "13", ",", "15", 
   ",", "4"}], "]"}]], "Input",
 CellChangeTimes->{{3.76618429049273*^9, 3.7661842944939685`*^9}, {
   3.766184376833353*^9, 3.7661843892718925`*^9}, {3.7661844272156057`*^9, 
   3.7661844361544156`*^9}, {3.7661845048237925`*^9, 3.76618450576128*^9}, {
   3.766184548018629*^9, 3.7661845715054183`*^9}, {3.766184629519802*^9, 
   3.766184630394789*^9}, 3.7663440431173563`*^9, {3.766344448467828*^9, 
   3.766344449155202*^9}, {3.7664300866525364`*^9, 3.766430260837929*^9}, {
   3.7664430779533415`*^9, 3.7664430846720095`*^9}, 3.766690081522315*^9, 
   3.7723093136713176`*^9, {3.7729199158602495`*^9, 3.7729199319085855`*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"1c73749d-5689-430f-a91d-2f115b7d9eb1"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox["\<\"(15-to-1\\!\\(\\*SubscriptBox[SuperscriptBox[\\()\\), \
\\(\\!\\(\\*RowBox[{\\\"4\\\"}]\\)\\)], \\(\\!\\(\\*RowBox[{\\\"13\\\"}]\\), \
\\!\\(\\*RowBox[{\\\"5\\\"}]\\), \\!\\(\\*RowBox[{\\\"5\\\"}]\\)\\)]\\)\
\[Times](20-to-4\\!\\(\\*SubscriptBox[\\()\\), \
\\(\\!\\(\\*RowBox[{\\\"27\\\"}]\\), \\!\\(\\*RowBox[{\\\"13\\\"}]\\), \\!\\(\
\\*RowBox[{\\\"15\\\"}]\\)\\)]\\) with \\!\\(\\*SubscriptBox[\\(p\\), \\(phys\
\\)]\\)=\\!\\(\\*RowBox[{\\\"\\\\\\\"0.001\\\\\\\"\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(x\\)]\\)=\\!\\(\\*RowBox[{\\\"13\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(z\\)]\\)=\\!\\(\\*RowBox[{\\\"5\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(m\\)]\\)=\\!\\(\\*RowBox[{\\\"5\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(x2\\)]\\)=\\!\\(\\*RowBox[{\\\"27\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(z2\\)]\\)=\\!\\(\\*RowBox[{\\\"13\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(m2\\)]\\)=\\!\\(\\*RowBox[{\\\"15\\\"}]\\) \
and \\!\\(\\*SubscriptBox[\\(n\\), \
\\(L1\\)]\\)=\\!\\(\\*RowBox[{\\\"4\\\"}]\\)\"\>",
  StringForm[
  "(15-to-1\!\(\*SubscriptBox[SuperscriptBox[\()\), \(`7`\)], \(`1`, `2`, `3`\
\)]\)\[Times](20-to-4\!\(\*SubscriptBox[\()\), \(`4`, `5`, `6`\)]\) with \!\(\
\*SubscriptBox[\(p\), \(phys\)]\)=`8`, \!\(\*SubscriptBox[\(d\), \
\(x\)]\)=`1`, \!\(\*SubscriptBox[\(d\), \(z\)]\)=`2`, \
\!\(\*SubscriptBox[\(d\), \(m\)]\)=`3`, \!\(\*SubscriptBox[\(d\), \
\(x2\)]\)=`4`, \!\(\*SubscriptBox[\(d\), \(z2\)]\)=`5`, \
\!\(\*SubscriptBox[\(d\), \(m2\)]\)=`6` and \!\(\*SubscriptBox[\(n\), \(L1\)]\
\)=`7`", 13, 5, 5, 27, 13, 15, 4, 
   NumberForm[0.001]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7664300929493303`*^9, 3.7664302349163656`*^9}, {
   3.766443081328295*^9, 3.7664430878282166`*^9}, 3.7664980247500153`*^9, 
   3.76669022602168*^9, 3.766692019755643*^9, 3.766692388377062*^9, 
   3.766694534888516*^9, 3.76670432833836*^9, 3.7667073829158707`*^9, 
   3.7723093804530745`*^9, 3.7727515606364107`*^9, 3.7728925450248747`*^9, {
   3.7729199209106884`*^9, 3.7729199350016184`*^9}, 3.772923208891242*^9, 
   3.7729713619628086`*^9, 3.7729744506882706`*^9, 3.7729747878164735`*^9},
 CellLabel->
  "During evaluation of \
In[58]:=",ExpressionUUID->"634b9f17-ab86-4d59-88d6-319e4e31759f"],

Cell[BoxData[
 InterpretationBox["\<\"Output error: \\!\\(\\*SubscriptBox[\\(p\\), \
\\(out\\)]\\) = \\!\\(\\*RowBox[{\\\"\\\\\\\"2.614\\\\\\\"\\\", \
\\\"\[Times]\\\", SuperscriptBox[\\\"10\\\", \
\\\"\\\\\\\"-11\\\\\\\"\\\"]}]\\)\"\>",
  StringForm["Output error: \!\(\*SubscriptBox[\(p\), \(out\)]\) = `1`", 
   NumberForm[2.6139590492135767`*^-11, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7664300929493303`*^9, 3.7664302349163656`*^9}, {
   3.766443081328295*^9, 3.7664430878282166`*^9}, 3.7664980247500153`*^9, 
   3.76669022602168*^9, 3.766692019755643*^9, 3.766692388377062*^9, 
   3.766694534888516*^9, 3.76670432833836*^9, 3.7667073829158707`*^9, 
   3.7723093804530745`*^9, 3.7727515606364107`*^9, 3.7728925450248747`*^9, {
   3.7729199209106884`*^9, 3.7729199350016184`*^9}, 3.772923208891242*^9, 
   3.7729713619628086`*^9, 3.7729744506882706`*^9, 3.772974787822033*^9},
 CellLabel->
  "During evaluation of \
In[58]:=",ExpressionUUID->"02fd3d83-ac8e-46a9-a5ab-32c0dd875c2d"],

Cell[BoxData[
 InterpretationBox["\<\"Failure probability: \\!\\(\\*SubscriptBox[\\(p\\), \
\\(fail\\)]\\) = \\!\\(\\*RowBox[{\\\"\\\\\\\"0.00004587\\\\\\\"\\\"}]\\)\"\>",
  StringForm[
  "Failure probability: \!\(\*SubscriptBox[\(p\), \(fail\)]\) = `1`", 
   NumberForm[0.00004587087474849927, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7664300929493303`*^9, 3.7664302349163656`*^9}, {
   3.766443081328295*^9, 3.7664430878282166`*^9}, 3.7664980247500153`*^9, 
   3.76669022602168*^9, 3.766692019755643*^9, 3.766692388377062*^9, 
   3.766694534888516*^9, 3.76670432833836*^9, 3.7667073829158707`*^9, 
   3.7723093804530745`*^9, 3.7727515606364107`*^9, 3.7728925450248747`*^9, {
   3.7729199209106884`*^9, 3.7729199350016184`*^9}, 3.772923208891242*^9, 
   3.7729713619628086`*^9, 3.7729744506882706`*^9, 3.7729747878322096`*^9},
 CellLabel->
  "During evaluation of \
In[58]:=",ExpressionUUID->"6d8970b1-9938-46e0-9add-75716bb7cf5d"],

Cell[BoxData[
 InterpretationBox["\<\"Space cost: \\!\\(\\*RowBox[{\\\"46790\\\"}]\\) \
qubits\"\>",
  StringForm["Space cost: `1` qubits", 46790],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7664300929493303`*^9, 3.7664302349163656`*^9}, {
   3.766443081328295*^9, 3.7664430878282166`*^9}, 3.7664980247500153`*^9, 
   3.76669022602168*^9, 3.766692019755643*^9, 3.766692388377062*^9, 
   3.766694534888516*^9, 3.76670432833836*^9, 3.7667073829158707`*^9, 
   3.7723093804530745`*^9, 3.7727515606364107`*^9, 3.7728925450248747`*^9, {
   3.7729199209106884`*^9, 3.7729199350016184`*^9}, 3.772923208891242*^9, 
   3.7729713619628086`*^9, 3.7729744506882706`*^9, 3.7729747878322096`*^9},
 CellLabel->
  "During evaluation of \
In[58]:=",ExpressionUUID->"892fa5ec-40ba-473b-a988-2611d887eda0"],

Cell[BoxData[
 InterpretationBox["\<\"Time cost: \\!\\(\\*RowBox[{\\\"\\\\\\\"157.4\\\\\\\"\
\\\"}]\\) code cycles\"\>",
  StringForm["Time cost: `1` code cycles", 
   NumberForm[157.41440773122392`, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7664300929493303`*^9, 3.7664302349163656`*^9}, {
   3.766443081328295*^9, 3.7664430878282166`*^9}, 3.7664980247500153`*^9, 
   3.76669022602168*^9, 3.766692019755643*^9, 3.766692388377062*^9, 
   3.766694534888516*^9, 3.76670432833836*^9, 3.7667073829158707`*^9, 
   3.7723093804530745`*^9, 3.7727515606364107`*^9, 3.7728925450248747`*^9, {
   3.7729199209106884`*^9, 3.7729199350016184`*^9}, 3.772923208891242*^9, 
   3.7729713619628086`*^9, 3.7729744506882706`*^9, 3.772974787842532*^9},
 CellLabel->
  "During evaluation of \
In[58]:=",ExpressionUUID->"501c2d0e-fa02-4a20-8c7a-5853cb0e62a2"],

Cell[BoxData[
 InterpretationBox["\<\"Spacetime cost: \
\\!\\(\\*RowBox[{\\\"\\\\\\\"1.841\\\\\\\"\\\", \\\"\[Times]\\\", \
SuperscriptBox[\\\"10\\\", \\\"\\\\\\\"6\\\\\\\"\\\"]}]\\) qubitcycles per \
output state\"\>",
  StringForm["Spacetime cost: `1` qubitcycles per output state", 
   NumberForm[1.841355034435992*^6, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7664300929493303`*^9, 3.7664302349163656`*^9}, {
   3.766443081328295*^9, 3.7664430878282166`*^9}, 3.7664980247500153`*^9, 
   3.76669022602168*^9, 3.766692019755643*^9, 3.766692388377062*^9, 
   3.766694534888516*^9, 3.76670432833836*^9, 3.7667073829158707`*^9, 
   3.7723093804530745`*^9, 3.7727515606364107`*^9, 3.7728925450248747`*^9, {
   3.7729199209106884`*^9, 3.7729199350016184`*^9}, 3.772923208891242*^9, 
   3.7729713619628086`*^9, 3.7729744506882706`*^9, 3.772974787842532*^9},
 CellLabel->
  "During evaluation of \
In[58]:=",ExpressionUUID->"226041b4-26c8-4bb0-9b6c-f9ff6011b619"],

Cell[BoxData[
 InterpretationBox["\<\"For a 100-qubit computation: \\!\\(\\*SuperscriptBox[\
\\(\\!\\(\\*RowBox[{\\\"\\\\\\\"30.9\\\\\\\"\\\"}]\\)d\\), \\(3\\)]\\) (d=\\!\
\\(\\*RowBox[{\\\"31\\\"}]\\))\"\>",
  StringForm[
  "For a 100-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\)]\) \
(d=`2`)", 
   NumberForm[30.90455228820771, 4], 31],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7664300929493303`*^9, 3.7664302349163656`*^9}, {
   3.766443081328295*^9, 3.7664430878282166`*^9}, 3.7664980247500153`*^9, 
   3.76669022602168*^9, 3.766692019755643*^9, 3.766692388377062*^9, 
   3.766694534888516*^9, 3.76670432833836*^9, 3.7667073829158707`*^9, 
   3.7723093804530745`*^9, 3.7727515606364107`*^9, 3.7728925450248747`*^9, {
   3.7729199209106884`*^9, 3.7729199350016184`*^9}, 3.772923208891242*^9, 
   3.7729713619628086`*^9, 3.7729744506882706`*^9, 3.772974787851906*^9},
 CellLabel->
  "During evaluation of \
In[58]:=",ExpressionUUID->"042a89d9-05e9-420b-b2cb-84b96d644363"],

Cell[BoxData[
 InterpretationBox["\<\"For a 10000-qubit computation: \
\\!\\(\\*SuperscriptBox[\\(\\!\\(\\*RowBox[{\\\"\\\\\\\"21.47\\\\\\\"\\\"}]\\)\
d\\), \\(3\\)]\\) (d=\\!\\(\\*RowBox[{\\\"35\\\"}]\\))\"\>",
  StringForm[
  "For a 10000-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\)]\) \
(d=`2`)", 
   NumberForm[21.473528098378914`, 4], 35],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7664300929493303`*^9, 3.7664302349163656`*^9}, {
   3.766443081328295*^9, 3.7664430878282166`*^9}, 3.7664980247500153`*^9, 
   3.76669022602168*^9, 3.766692019755643*^9, 3.766692388377062*^9, 
   3.766694534888516*^9, 3.76670432833836*^9, 3.7667073829158707`*^9, 
   3.7723093804530745`*^9, 3.7727515606364107`*^9, 3.7728925450248747`*^9, {
   3.7729199209106884`*^9, 3.7729199350016184`*^9}, 3.772923208891242*^9, 
   3.7729713619628086`*^9, 3.7729744506882706`*^9, 3.772974787851906*^9},
 CellLabel->
  "During evaluation of \
In[58]:=",ExpressionUUID->"0557f0d8-4a58-4dc8-839b-09593eb93df8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CostOfTwoLevel15to1", "[", 
  RowBox[{
   SuperscriptBox["10", 
    RowBox[{"-", "3"}]], ",", "11", ",", "5", ",", "5", ",", "25", ",", "11", 
   ",", "11", ",", "6"}], "]"}]], "Input",
 CellChangeTimes->{{3.7643478025754137`*^9, 3.764347847273678*^9}, {
   3.76434787869788*^9, 3.764347969507951*^9}, {3.7643480358302374`*^9, 
   3.764348036752102*^9}, {3.7643485823368015`*^9, 3.7643486817935243`*^9}, {
   3.7643506889422235`*^9, 3.764350748514061*^9}, {3.7643510050203266`*^9, 
   3.7643510784627066`*^9}, {3.764782827275008*^9, 3.764782828774988*^9}, {
   3.764782922778527*^9, 3.7647829427131677`*^9}, {3.7647873848013387`*^9, 
   3.7647874003971653`*^9}, {3.764787680164606*^9, 3.7647876803117495`*^9}, {
   3.7647916493426027`*^9, 3.7647916840624447`*^9}, {3.7657234983355913`*^9, 
   3.7657235065429025`*^9}, {3.7657296819003673`*^9, 
   3.7657297216283655`*^9}, {3.766177371603348*^9, 3.7661773718064737`*^9}, {
   3.7661849541136665`*^9, 3.7661850226512833`*^9}, {3.7664302894625854`*^9, 
   3.766430289837581*^9}, 3.772309319968013*^9},
 CellLabel->"In[49]:=",ExpressionUUID->"d41d8a30-bcca-4918-8c83-a3deb5c8194e"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox["\<\"(15-to-1\\!\\(\\*SubscriptBox[SuperscriptBox[\\()\\), \
\\(\\!\\(\\*RowBox[{\\\"6\\\"}]\\)\\)], \\(\\!\\(\\*RowBox[{\\\"11\\\"}]\\), \
\\!\\(\\*RowBox[{\\\"5\\\"}]\\), \\!\\(\\*RowBox[{\\\"5\\\"}]\\)\\)]\\)\
\[Times](15-to-1\\!\\(\\*SubscriptBox[\\()\\), \
\\(\\!\\(\\*RowBox[{\\\"25\\\"}]\\), \\!\\(\\*RowBox[{\\\"11\\\"}]\\), \\!\\(\
\\*RowBox[{\\\"11\\\"}]\\)\\)]\\) with \\!\\(\\*SubscriptBox[\\(p\\), \\(phys\
\\)]\\)=\\!\\(\\*RowBox[{\\\"\\\\\\\"0.001\\\\\\\"\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(x\\)]\\)=\\!\\(\\*RowBox[{\\\"11\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(z\\)]\\)=\\!\\(\\*RowBox[{\\\"5\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(m\\)]\\)=\\!\\(\\*RowBox[{\\\"5\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(x2\\)]\\)=\\!\\(\\*RowBox[{\\\"25\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(z2\\)]\\)=\\!\\(\\*RowBox[{\\\"11\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(m2\\)]\\)=\\!\\(\\*RowBox[{\\\"11\\\"}]\\) \
and \\!\\(\\*SubscriptBox[\\(n\\), \
\\(L1\\)]\\)=\\!\\(\\*RowBox[{\\\"6\\\"}]\\)\"\>",
  StringForm[
  "(15-to-1\!\(\*SubscriptBox[SuperscriptBox[\()\), \(`7`\)], \(`1`, `2`, `3`\
\)]\)\[Times](15-to-1\!\(\*SubscriptBox[\()\), \(`4`, `5`, `6`\)]\) with \!\(\
\*SubscriptBox[\(p\), \(phys\)]\)=`8`, \!\(\*SubscriptBox[\(d\), \
\(x\)]\)=`1`, \!\(\*SubscriptBox[\(d\), \(z\)]\)=`2`, \
\!\(\*SubscriptBox[\(d\), \(m\)]\)=`3`, \!\(\*SubscriptBox[\(d\), \
\(x2\)]\)=`4`, \!\(\*SubscriptBox[\(d\), \(z2\)]\)=`5`, \
\!\(\*SubscriptBox[\(d\), \(m2\)]\)=`6` and \!\(\*SubscriptBox[\(n\), \(L1\)]\
\)=`7`", 11, 5, 5, 25, 11, 11, 6, 
   NumberForm[0.001]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7647918685525165`*^9, 3.764794145604302*^9, 3.7649452793218317`*^9, 
   3.7651061047469406`*^9, 3.7654102865810127`*^9, 3.7655183389923773`*^9, 
   3.7655225189950457`*^9, {3.76572347159134*^9, 3.7657235084762697`*^9}, 
   3.7657243546453705`*^9, 3.7657275827702804`*^9, {3.765729684553496*^9, 
   3.7657297240835605`*^9}, 3.765738828462371*^9, 3.766008874045676*^9, 
   3.7661773754172297`*^9, {3.7661849572854986`*^9, 3.7661850259637394`*^9}, 
   3.766242463466384*^9, 3.766247618084988*^9, 3.7662488817245345`*^9, 
   3.766264745840491*^9, 3.7663570142485228`*^9, 3.7663919129035597`*^9, 
   3.7663933025117674`*^9, 3.7664028136022043`*^9, 3.7664029466480875`*^9, 
   3.7664289910396724`*^9, 3.7664982378773856`*^9, 3.766690229661482*^9, 
   3.7666923922792006`*^9, 3.7667043320684557`*^9, 3.7667073865896626`*^9, 
   3.7723057145161996`*^9, 3.772309383361255*^9, 3.7727484913563304`*^9, 
   3.772751565778178*^9, 3.7728925479017305`*^9, 3.77292321194808*^9, 
   3.772971365232644*^9, 3.77297294092283*^9},
 CellLabel->
  "During evaluation of \
In[49]:=",ExpressionUUID->"1f514d8d-0a24-41a9-929d-70d0b0651343"],

Cell[BoxData[
 InterpretationBox["\<\"Output error: \\!\\(\\*SubscriptBox[\\(p\\), \
\\(out\\)]\\) = \\!\\(\\*RowBox[{\\\"\\\\\\\"2.656\\\\\\\"\\\", \
\\\"\[Times]\\\", SuperscriptBox[\\\"10\\\", \
\\\"\\\\\\\"-12\\\\\\\"\\\"]}]\\)\"\>",
  StringForm["Output error: \!\(\*SubscriptBox[\(p\), \(out\)]\) = `1`", 
   NumberForm[
   2.6555735380807925304570519643412142252143144195`34.59398995679098*^-12, 
    4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7647918685525165`*^9, 3.764794145604302*^9, 3.7649452793218317`*^9, 
   3.7651061047469406`*^9, 3.7654102865810127`*^9, 3.7655183389923773`*^9, 
   3.7655225189950457`*^9, {3.76572347159134*^9, 3.7657235084762697`*^9}, 
   3.7657243546453705`*^9, 3.7657275827702804`*^9, {3.765729684553496*^9, 
   3.7657297240835605`*^9}, 3.765738828462371*^9, 3.766008874045676*^9, 
   3.7661773754172297`*^9, {3.7661849572854986`*^9, 3.7661850259637394`*^9}, 
   3.766242463466384*^9, 3.766247618084988*^9, 3.7662488817245345`*^9, 
   3.766264745840491*^9, 3.7663570142485228`*^9, 3.7663919129035597`*^9, 
   3.7663933025117674`*^9, 3.7664028136022043`*^9, 3.7664029466480875`*^9, 
   3.7664289910396724`*^9, 3.7664982378773856`*^9, 3.766690229661482*^9, 
   3.7666923922792006`*^9, 3.7667043320684557`*^9, 3.7667073865896626`*^9, 
   3.7723057145161996`*^9, 3.772309383361255*^9, 3.7727484913563304`*^9, 
   3.772751565778178*^9, 3.7728925479017305`*^9, 3.77292321194808*^9, 
   3.772971365232644*^9, 3.772972940928855*^9},
 CellLabel->
  "During evaluation of \
In[49]:=",ExpressionUUID->"5429866f-bd33-4b9e-9d00-d482099d44f7"],

Cell[BoxData[
 InterpretationBox["\<\"Failure probability: \\!\\(\\*SubscriptBox[\\(p\\), \
\\(fail\\)]\\) = \\!\\(\\*RowBox[{\\\"\\\\\\\"0.0003875\\\\\\\"\\\"}]\\)\"\>",
  StringForm[
  "Failure probability: \!\(\*SubscriptBox[\(p\), \(fail\)]\) = `1`", 
   NumberForm[
   0.0003875174920335635367641420083143732941191384533545902192`43.\
102119216109756, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7647918685525165`*^9, 3.764794145604302*^9, 3.7649452793218317`*^9, 
   3.7651061047469406`*^9, 3.7654102865810127`*^9, 3.7655183389923773`*^9, 
   3.7655225189950457`*^9, {3.76572347159134*^9, 3.7657235084762697`*^9}, 
   3.7657243546453705`*^9, 3.7657275827702804`*^9, {3.765729684553496*^9, 
   3.7657297240835605`*^9}, 3.765738828462371*^9, 3.766008874045676*^9, 
   3.7661773754172297`*^9, {3.7661849572854986`*^9, 3.7661850259637394`*^9}, 
   3.766242463466384*^9, 3.766247618084988*^9, 3.7662488817245345`*^9, 
   3.766264745840491*^9, 3.7663570142485228`*^9, 3.7663919129035597`*^9, 
   3.7663933025117674`*^9, 3.7664028136022043`*^9, 3.7664029466480875`*^9, 
   3.7664289910396724`*^9, 3.7664982378773856`*^9, 3.766690229661482*^9, 
   3.7666923922792006`*^9, 3.7667043320684557`*^9, 3.7667073865896626`*^9, 
   3.7723057145161996`*^9, 3.772309383361255*^9, 3.7727484913563304`*^9, 
   3.772751565778178*^9, 3.7728925479017305`*^9, 3.77292321194808*^9, 
   3.772971365232644*^9, 3.772972940937791*^9},
 CellLabel->
  "During evaluation of \
In[49]:=",ExpressionUUID->"5e057fbc-8aa2-42d7-85c7-c55c1434bb41"],

Cell[BoxData[
 InterpretationBox["\<\"Space cost: \\!\\(\\*RowBox[{\\\"30732\\\"}]\\) \
qubits\"\>",
  StringForm["Space cost: `1` qubits", 30732],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7647918685525165`*^9, 3.764794145604302*^9, 3.7649452793218317`*^9, 
   3.7651061047469406`*^9, 3.7654102865810127`*^9, 3.7655183389923773`*^9, 
   3.7655225189950457`*^9, {3.76572347159134*^9, 3.7657235084762697`*^9}, 
   3.7657243546453705`*^9, 3.7657275827702804`*^9, {3.765729684553496*^9, 
   3.7657297240835605`*^9}, 3.765738828462371*^9, 3.766008874045676*^9, 
   3.7661773754172297`*^9, {3.7661849572854986`*^9, 3.7661850259637394`*^9}, 
   3.766242463466384*^9, 3.766247618084988*^9, 3.7662488817245345`*^9, 
   3.766264745840491*^9, 3.7663570142485228`*^9, 3.7663919129035597`*^9, 
   3.7663933025117674`*^9, 3.7664028136022043`*^9, 3.7664029466480875`*^9, 
   3.7664289910396724`*^9, 3.7664982378773856`*^9, 3.766690229661482*^9, 
   3.7666923922792006`*^9, 3.7667043320684557`*^9, 3.7667073865896626`*^9, 
   3.7723057145161996`*^9, 3.772309383361255*^9, 3.7727484913563304`*^9, 
   3.772751565778178*^9, 3.7728925479017305`*^9, 3.77292321194808*^9, 
   3.772971365232644*^9, 3.77297294094178*^9},
 CellLabel->
  "During evaluation of \
In[49]:=",ExpressionUUID->"9fe14288-12b9-4a8a-80ed-49ed6ded52d3"],

Cell[BoxData[
 InterpretationBox["\<\"Time cost: \\!\\(\\*RowBox[{\\\"\\\\\\\"82.53\\\\\\\"\
\\\"}]\\) code cycles\"\>",
  StringForm["Time cost: `1` code cycles", 
   NumberForm[82.5319825869046350214`4., 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7647918685525165`*^9, 3.764794145604302*^9, 3.7649452793218317`*^9, 
   3.7651061047469406`*^9, 3.7654102865810127`*^9, 3.7655183389923773`*^9, 
   3.7655225189950457`*^9, {3.76572347159134*^9, 3.7657235084762697`*^9}, 
   3.7657243546453705`*^9, 3.7657275827702804`*^9, {3.765729684553496*^9, 
   3.7657297240835605`*^9}, 3.765738828462371*^9, 3.766008874045676*^9, 
   3.7661773754172297`*^9, {3.7661849572854986`*^9, 3.7661850259637394`*^9}, 
   3.766242463466384*^9, 3.766247618084988*^9, 3.7662488817245345`*^9, 
   3.766264745840491*^9, 3.7663570142485228`*^9, 3.7663919129035597`*^9, 
   3.7663933025117674`*^9, 3.7664028136022043`*^9, 3.7664029466480875`*^9, 
   3.7664289910396724`*^9, 3.7664982378773856`*^9, 3.766690229661482*^9, 
   3.7666923922792006`*^9, 3.7667043320684557`*^9, 3.7667073865896626`*^9, 
   3.7723057145161996`*^9, 3.772309383361255*^9, 3.7727484913563304`*^9, 
   3.772751565778178*^9, 3.7728925479017305`*^9, 3.77292321194808*^9, 
   3.772971365232644*^9, 3.7729729409447737`*^9},
 CellLabel->
  "During evaluation of \
In[49]:=",ExpressionUUID->"9e1a605d-c8a0-490d-a24f-71aadba2a585"],

Cell[BoxData[
 InterpretationBox["\<\"Spacetime cost: \
\\!\\(\\*RowBox[{\\\"\\\\\\\"2.536\\\\\\\"\\\", \\\"\[Times]\\\", \
SuperscriptBox[\\\"10\\\", \\\"\\\\\\\"6\\\\\\\"\\\"]}]\\) qubitcycles\"\>",
  StringForm["Spacetime cost: `1` qubitcycles", 
   NumberForm[
   2.5363728888607532434788466389681883855814195977018435268758819241`46.\
51365957601335*^6, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7647918685525165`*^9, 3.764794145604302*^9, 3.7649452793218317`*^9, 
   3.7651061047469406`*^9, 3.7654102865810127`*^9, 3.7655183389923773`*^9, 
   3.7655225189950457`*^9, {3.76572347159134*^9, 3.7657235084762697`*^9}, 
   3.7657243546453705`*^9, 3.7657275827702804`*^9, {3.765729684553496*^9, 
   3.7657297240835605`*^9}, 3.765738828462371*^9, 3.766008874045676*^9, 
   3.7661773754172297`*^9, {3.7661849572854986`*^9, 3.7661850259637394`*^9}, 
   3.766242463466384*^9, 3.766247618084988*^9, 3.7662488817245345`*^9, 
   3.766264745840491*^9, 3.7663570142485228`*^9, 3.7663919129035597`*^9, 
   3.7663933025117674`*^9, 3.7664028136022043`*^9, 3.7664029466480875`*^9, 
   3.7664289910396724`*^9, 3.7664982378773856`*^9, 3.766690229661482*^9, 
   3.7666923922792006`*^9, 3.7667043320684557`*^9, 3.7667073865896626`*^9, 
   3.7723057145161996`*^9, 3.772309383361255*^9, 3.7727484913563304`*^9, 
   3.772751565778178*^9, 3.7728925479017305`*^9, 3.77292321194808*^9, 
   3.772971365232644*^9, 3.772972940948762*^9},
 CellLabel->
  "During evaluation of \
In[49]:=",ExpressionUUID->"388f06dd-8fc1-4898-b7c4-a95739a2aba1"],

Cell[BoxData[
 InterpretationBox["\<\"For a 100-qubit computation: \\!\\(\\*SuperscriptBox[\
\\(\\!\\(\\*RowBox[{\\\"\\\\\\\"35.29\\\\\\\"\\\"}]\\)d\\), \\(3\\)]\\) \
(d=\\!\\(\\*RowBox[{\\\"33\\\"}]\\))\"\>",
  StringForm[
  "For a 100-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\)]\) \
(d=`2`)", 
   NumberForm[
   35.28915725938104521076949437860962775943205606619700485399`46.\
51365957601335, 4], 33],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7647918685525165`*^9, 3.764794145604302*^9, 3.7649452793218317`*^9, 
   3.7651061047469406`*^9, 3.7654102865810127`*^9, 3.7655183389923773`*^9, 
   3.7655225189950457`*^9, {3.76572347159134*^9, 3.7657235084762697`*^9}, 
   3.7657243546453705`*^9, 3.7657275827702804`*^9, {3.765729684553496*^9, 
   3.7657297240835605`*^9}, 3.765738828462371*^9, 3.766008874045676*^9, 
   3.7661773754172297`*^9, {3.7661849572854986`*^9, 3.7661850259637394`*^9}, 
   3.766242463466384*^9, 3.766247618084988*^9, 3.7662488817245345`*^9, 
   3.766264745840491*^9, 3.7663570142485228`*^9, 3.7663919129035597`*^9, 
   3.7663933025117674`*^9, 3.7664028136022043`*^9, 3.7664029466480875`*^9, 
   3.7664289910396724`*^9, 3.7664982378773856`*^9, 3.766690229661482*^9, 
   3.7666923922792006`*^9, 3.7667043320684557`*^9, 3.7667073865896626`*^9, 
   3.7723057145161996`*^9, 3.772309383361255*^9, 3.7727484913563304`*^9, 
   3.772751565778178*^9, 3.7728925479017305`*^9, 3.77292321194808*^9, 
   3.772971365232644*^9, 3.772972940951754*^9},
 CellLabel->
  "During evaluation of \
In[49]:=",ExpressionUUID->"d78ae4ca-101e-4114-98b7-5ce8f9c20230"],

Cell[BoxData[
 InterpretationBox["\<\"For a 10000-qubit computation: \
\\!\\(\\*SuperscriptBox[\\(\\!\\(\\*RowBox[{\\\"\\\\\\\"25.04\\\\\\\"\\\"}]\\)\
d\\), \\(3\\)]\\) (d=\\!\\(\\*RowBox[{\\\"37\\\"}]\\))\"\>",
  StringForm[
  "For a 10000-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\)]\) \
(d=`2`)", 
   NumberForm[
   25.0367489473550751532865441234298894989578070173715626604196`46.\
51365957601335, 4], 37],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7647918685525165`*^9, 3.764794145604302*^9, 3.7649452793218317`*^9, 
   3.7651061047469406`*^9, 3.7654102865810127`*^9, 3.7655183389923773`*^9, 
   3.7655225189950457`*^9, {3.76572347159134*^9, 3.7657235084762697`*^9}, 
   3.7657243546453705`*^9, 3.7657275827702804`*^9, {3.765729684553496*^9, 
   3.7657297240835605`*^9}, 3.765738828462371*^9, 3.766008874045676*^9, 
   3.7661773754172297`*^9, {3.7661849572854986`*^9, 3.7661850259637394`*^9}, 
   3.766242463466384*^9, 3.766247618084988*^9, 3.7662488817245345`*^9, 
   3.766264745840491*^9, 3.7663570142485228`*^9, 3.7663919129035597`*^9, 
   3.7663933025117674`*^9, 3.7664028136022043`*^9, 3.7664029466480875`*^9, 
   3.7664289910396724`*^9, 3.7664982378773856`*^9, 3.766690229661482*^9, 
   3.7666923922792006`*^9, 3.7667043320684557`*^9, 3.7667073865896626`*^9, 
   3.7723057145161996`*^9, 3.772309383361255*^9, 3.7727484913563304`*^9, 
   3.772751565778178*^9, 3.7728925479017305`*^9, 3.77292321194808*^9, 
   3.772971365232644*^9, 3.772972940955742*^9},
 CellLabel->
  "During evaluation of \
In[49]:=",ExpressionUUID->"00d9a962-1277-4bfd-925f-282357da5801"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CostOfTwoLevel15to1", "[", 
  RowBox[{
   SuperscriptBox["10", 
    RowBox[{"-", "3"}]], ",", "13", ",", "5", ",", "5", ",", "29", ",", "11", 
   ",", "13", ",", "6"}], "]"}]], "Input",
 CellChangeTimes->{{3.766184320495881*^9, 3.766184326542672*^9}, {
   3.766185379807597*^9, 3.766185492863949*^9}, {3.7664303063373823`*^9, 
   3.76643030649363*^9}, {3.7664303803052387`*^9, 3.7664304189453964`*^9}, {
   3.7666896659203095`*^9, 3.766689683339568*^9}, 3.772309324288467*^9},
 CellLabel->"In[50]:=",ExpressionUUID->"dfda2e5c-4b85-455d-9069-0ddfb370b78d"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox["\<\"(15-to-1\\!\\(\\*SubscriptBox[SuperscriptBox[\\()\\), \
\\(\\!\\(\\*RowBox[{\\\"6\\\"}]\\)\\)], \\(\\!\\(\\*RowBox[{\\\"13\\\"}]\\), \
\\!\\(\\*RowBox[{\\\"5\\\"}]\\), \\!\\(\\*RowBox[{\\\"5\\\"}]\\)\\)]\\)\
\[Times](15-to-1\\!\\(\\*SubscriptBox[\\()\\), \
\\(\\!\\(\\*RowBox[{\\\"29\\\"}]\\), \\!\\(\\*RowBox[{\\\"11\\\"}]\\), \\!\\(\
\\*RowBox[{\\\"13\\\"}]\\)\\)]\\) with \\!\\(\\*SubscriptBox[\\(p\\), \\(phys\
\\)]\\)=\\!\\(\\*RowBox[{\\\"\\\\\\\"0.001\\\\\\\"\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(x\\)]\\)=\\!\\(\\*RowBox[{\\\"13\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(z\\)]\\)=\\!\\(\\*RowBox[{\\\"5\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(m\\)]\\)=\\!\\(\\*RowBox[{\\\"5\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(x2\\)]\\)=\\!\\(\\*RowBox[{\\\"29\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(z2\\)]\\)=\\!\\(\\*RowBox[{\\\"11\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(m2\\)]\\)=\\!\\(\\*RowBox[{\\\"13\\\"}]\\) \
and \\!\\(\\*SubscriptBox[\\(n\\), \
\\(L1\\)]\\)=\\!\\(\\*RowBox[{\\\"6\\\"}]\\)\"\>",
  StringForm[
  "(15-to-1\!\(\*SubscriptBox[SuperscriptBox[\()\), \(`7`\)], \(`1`, `2`, `3`\
\)]\)\[Times](15-to-1\!\(\*SubscriptBox[\()\), \(`4`, `5`, `6`\)]\) with \!\(\
\*SubscriptBox[\(p\), \(phys\)]\)=`8`, \!\(\*SubscriptBox[\(d\), \
\(x\)]\)=`1`, \!\(\*SubscriptBox[\(d\), \(z\)]\)=`2`, \
\!\(\*SubscriptBox[\(d\), \(m\)]\)=`3`, \!\(\*SubscriptBox[\(d\), \
\(x2\)]\)=`4`, \!\(\*SubscriptBox[\(d\), \(z2\)]\)=`5`, \
\!\(\*SubscriptBox[\(d\), \(m2\)]\)=`6` and \!\(\*SubscriptBox[\(n\), \(L1\)]\
\)=`7`", 13, 5, 5, 29, 11, 13, 6, 
   NumberForm[0.001]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.766184329825152*^9, {3.766185384699402*^9, 3.766185496082651*^9}, 
   3.766242466466343*^9, 3.766247621194321*^9, 3.766248884693243*^9, 
   3.7662647530590706`*^9, 3.766357022314864*^9, 3.766391920106598*^9, 
   3.7663933054804816`*^9, 3.76640284522744*^9, 3.7664029497886734`*^9, 
   3.766428994024009*^9, 3.7664303096810884`*^9, {3.766430383664572*^9, 
   3.766430423195343*^9}, 3.7664982469411173`*^9, 3.766690233336269*^9, 
   3.76669239615826*^9, 3.766704335843392*^9, 3.7667073903140287`*^9, 
   3.7723057389846215`*^9, 3.7723093862499676`*^9, 3.772748496845391*^9, 
   3.772751579044993*^9, 3.7728925508245134`*^9, 3.7729232149519835`*^9, 
   3.7729713682028813`*^9, 3.772972986637667*^9},
 CellLabel->
  "During evaluation of \
In[50]:=",ExpressionUUID->"0861c888-0e8b-4c15-ac47-56638373155e"],

Cell[BoxData[
 InterpretationBox["\<\"Output error: \\!\\(\\*SubscriptBox[\\(p\\), \
\\(out\\)]\\) = \\!\\(\\*RowBox[{\\\"\\\\\\\"3.257\\\\\\\"\\\", \
\\\"\[Times]\\\", SuperscriptBox[\\\"10\\\", \
\\\"\\\\\\\"-14\\\\\\\"\\\"]}]\\)\"\>",
  StringForm["Output error: \!\(\*SubscriptBox[\(p\), \(out\)]\) = `1`", 
   NumberForm[
   3.25731759171974749739757273961034649041602459`32.68282624006336*^-14, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.766184329825152*^9, {3.766185384699402*^9, 3.766185496082651*^9}, 
   3.766242466466343*^9, 3.766247621194321*^9, 3.766248884693243*^9, 
   3.7662647530590706`*^9, 3.766357022314864*^9, 3.766391920106598*^9, 
   3.7663933054804816`*^9, 3.76640284522744*^9, 3.7664029497886734`*^9, 
   3.766428994024009*^9, 3.7664303096810884`*^9, {3.766430383664572*^9, 
   3.766430423195343*^9}, 3.7664982469411173`*^9, 3.766690233336269*^9, 
   3.76669239615826*^9, 3.766704335843392*^9, 3.7667073903140287`*^9, 
   3.7723057389846215`*^9, 3.7723093862499676`*^9, 3.772748496845391*^9, 
   3.772751579044993*^9, 3.7728925508245134`*^9, 3.7729232149519835`*^9, 
   3.7729713682028813`*^9, 3.7729729866446476`*^9},
 CellLabel->
  "During evaluation of \
In[50]:=",ExpressionUUID->"bafa1add-108e-46c7-9d15-2790f6bdf8c8"],

Cell[BoxData[
 InterpretationBox["\<\"Failure probability: \\!\\(\\*SubscriptBox[\\(p\\), \
\\(fail\\)]\\) = \\!\\(\\*RowBox[{\\\"\\\\\\\"0.0001035\\\\\\\"\\\"}]\\)\"\>",
  StringForm[
  "Failure probability: \!\(\*SubscriptBox[\(p\), \(fail\)]\) = `1`", 
   NumberForm[
   0.0001034967340034380836959359726357583810291768341789065776`42.\
52876567603167, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.766184329825152*^9, {3.766185384699402*^9, 3.766185496082651*^9}, 
   3.766242466466343*^9, 3.766247621194321*^9, 3.766248884693243*^9, 
   3.7662647530590706`*^9, 3.766357022314864*^9, 3.766391920106598*^9, 
   3.7663933054804816`*^9, 3.76640284522744*^9, 3.7664029497886734`*^9, 
   3.766428994024009*^9, 3.7664303096810884`*^9, {3.766430383664572*^9, 
   3.766430423195343*^9}, 3.7664982469411173`*^9, 3.766690233336269*^9, 
   3.76669239615826*^9, 3.766704335843392*^9, 3.7667073903140287`*^9, 
   3.7723057389846215`*^9, 3.7723093862499676`*^9, 3.772748496845391*^9, 
   3.772751579044993*^9, 3.7728925508245134`*^9, 3.7729232149519835`*^9, 
   3.7729713682028813`*^9, 3.772972986652627*^9},
 CellLabel->
  "During evaluation of \
In[50]:=",ExpressionUUID->"0bf457f8-a839-4b45-9963-949f0b80e9e2"],

Cell[BoxData[
 InterpretationBox["\<\"Space cost: \\!\\(\\*RowBox[{\\\"39108\\\"}]\\) \
qubits\"\>",
  StringForm["Space cost: `1` qubits", 39108],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.766184329825152*^9, {3.766185384699402*^9, 3.766185496082651*^9}, 
   3.766242466466343*^9, 3.766247621194321*^9, 3.766248884693243*^9, 
   3.7662647530590706`*^9, 3.766357022314864*^9, 3.766391920106598*^9, 
   3.7663933054804816`*^9, 3.76640284522744*^9, 3.7664029497886734`*^9, 
   3.766428994024009*^9, 3.7664303096810884`*^9, {3.766430383664572*^9, 
   3.766430423195343*^9}, 3.7664982469411173`*^9, 3.766690233336269*^9, 
   3.76669239615826*^9, 3.766704335843392*^9, 3.7667073903140287`*^9, 
   3.7723057389846215`*^9, 3.7723093862499676`*^9, 3.772748496845391*^9, 
   3.772751579044993*^9, 3.7728925508245134`*^9, 3.7729232149519835`*^9, 
   3.7729713682028813`*^9, 3.7729729866556187`*^9},
 CellLabel->
  "During evaluation of \
In[50]:=",ExpressionUUID->"b3b76423-59be-4ecb-8305-e956db93cad2"],

Cell[BoxData[
 InterpretationBox["\<\"Time cost: \\!\\(\\*RowBox[{\\\"\\\\\\\"97.51\\\\\\\"\
\\\"}]\\) code cycles\"\>",
  StringForm["Time cost: `1` code cycles", 
   NumberForm[97.5100919760518962253`4., 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.766184329825152*^9, {3.766185384699402*^9, 3.766185496082651*^9}, 
   3.766242466466343*^9, 3.766247621194321*^9, 3.766248884693243*^9, 
   3.7662647530590706`*^9, 3.766357022314864*^9, 3.766391920106598*^9, 
   3.7663933054804816`*^9, 3.76640284522744*^9, 3.7664029497886734`*^9, 
   3.766428994024009*^9, 3.7664303096810884`*^9, {3.766430383664572*^9, 
   3.766430423195343*^9}, 3.7664982469411173`*^9, 3.766690233336269*^9, 
   3.76669239615826*^9, 3.766704335843392*^9, 3.7667073903140287`*^9, 
   3.7723057389846215`*^9, 3.7723093862499676`*^9, 3.772748496845391*^9, 
   3.772751579044993*^9, 3.7728925508245134`*^9, 3.7729232149519835`*^9, 
   3.7729713682028813`*^9, 3.7729729866586094`*^9},
 CellLabel->
  "During evaluation of \
In[50]:=",ExpressionUUID->"9c8cfe40-609e-4660-9381-4962a5396060"],

Cell[BoxData[
 InterpretationBox["\<\"Spacetime cost: \
\\!\\(\\*RowBox[{\\\"\\\\\\\"3.813\\\\\\\"\\\", \\\"\[Times]\\\", \
SuperscriptBox[\\\"10\\\", \\\"\\\\\\\"6\\\\\\\"\\\"]}]\\) qubitcycles\"\>",
  StringForm["Spacetime cost: `1` qubitcycles", 
   NumberForm[
   3.8134246769994375575802541649178959841244024690890726052209172048`46.\
513794080457565*^6, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.766184329825152*^9, {3.766185384699402*^9, 3.766185496082651*^9}, 
   3.766242466466343*^9, 3.766247621194321*^9, 3.766248884693243*^9, 
   3.7662647530590706`*^9, 3.766357022314864*^9, 3.766391920106598*^9, 
   3.7663933054804816`*^9, 3.76640284522744*^9, 3.7664029497886734`*^9, 
   3.766428994024009*^9, 3.7664303096810884`*^9, {3.766430383664572*^9, 
   3.766430423195343*^9}, 3.7664982469411173`*^9, 3.766690233336269*^9, 
   3.76669239615826*^9, 3.766704335843392*^9, 3.7667073903140287`*^9, 
   3.7723057389846215`*^9, 3.7723093862499676`*^9, 3.772748496845391*^9, 
   3.772751579044993*^9, 3.7728925508245134`*^9, 3.7729232149519835`*^9, 
   3.7729713682028813`*^9, 3.7729729866626005`*^9},
 CellLabel->
  "During evaluation of \
In[50]:=",ExpressionUUID->"abdd5086-5233-469c-991e-2a94b6c4916c"],

Cell[BoxData[
 InterpretationBox["\<\"For a 100-qubit computation: \\!\\(\\*SuperscriptBox[\
\\(\\!\\(\\*RowBox[{\\\"\\\\\\\"37.64\\\\\\\"\\\"}]\\)d\\), \\(3\\)]\\) \
(d=\\!\\(\\*RowBox[{\\\"37\\\"}]\\))\"\>",
  StringForm[
  "For a 100-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\)]\) \
(d=`2`)", 
   NumberForm[
   37.6426339703417128065490115582284956875644331933851164316067`46.\
513794080457565, 4], 37],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.766184329825152*^9, {3.766185384699402*^9, 3.766185496082651*^9}, 
   3.766242466466343*^9, 3.766247621194321*^9, 3.766248884693243*^9, 
   3.7662647530590706`*^9, 3.766357022314864*^9, 3.766391920106598*^9, 
   3.7663933054804816`*^9, 3.76640284522744*^9, 3.7664029497886734`*^9, 
   3.766428994024009*^9, 3.7664303096810884`*^9, {3.766430383664572*^9, 
   3.766430423195343*^9}, 3.7664982469411173`*^9, 3.766690233336269*^9, 
   3.76669239615826*^9, 3.766704335843392*^9, 3.7667073903140287`*^9, 
   3.7723057389846215`*^9, 3.7723093862499676`*^9, 3.772748496845391*^9, 
   3.772751579044993*^9, 3.7728925508245134`*^9, 3.7729232149519835`*^9, 
   3.7729713682028813`*^9, 3.7729729866655927`*^9},
 CellLabel->
  "During evaluation of \
In[50]:=",ExpressionUUID->"d9b9562c-3f71-4ec3-89a1-770717186c9c"],

Cell[BoxData[
 InterpretationBox["\<\"For a 10000-qubit computation: \
\\!\\(\\*SuperscriptBox[\\(\\!\\(\\*RowBox[{\\\"\\\\\\\"27.67\\\\\\\"\\\"}]\\)\
d\\), \\(3\\)]\\) (d=\\!\\(\\*RowBox[{\\\"41\\\"}]\\))\"\>",
  StringForm[
  "For a 10000-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\)]\) \
(d=`2`)", 
   NumberForm[
   27.6651867863164895864849187106824914331219981507020545640799`46.\
513794080457565, 4], 41],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.766184329825152*^9, {3.766185384699402*^9, 3.766185496082651*^9}, 
   3.766242466466343*^9, 3.766247621194321*^9, 3.766248884693243*^9, 
   3.7662647530590706`*^9, 3.766357022314864*^9, 3.766391920106598*^9, 
   3.7663933054804816`*^9, 3.76640284522744*^9, 3.7664029497886734`*^9, 
   3.766428994024009*^9, 3.7664303096810884`*^9, {3.766430383664572*^9, 
   3.766430423195343*^9}, 3.7664982469411173`*^9, 3.766690233336269*^9, 
   3.76669239615826*^9, 3.766704335843392*^9, 3.7667073903140287`*^9, 
   3.7723057389846215`*^9, 3.7723093862499676`*^9, 3.772748496845391*^9, 
   3.772751579044993*^9, 3.7728925508245134`*^9, 3.7729232149519835`*^9, 
   3.7729713682028813`*^9, 3.7729729866695814`*^9},
 CellLabel->
  "During evaluation of \
In[50]:=",ExpressionUUID->"bae1fa99-5da5-4749-ba7d-33408b2aef1b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CostOfTwoLevel15to1", "[", 
  RowBox[{
   SuperscriptBox["10", 
    RowBox[{"-", "3"}]], ",", "17", ",", "7", ",", "7", ",", "41", ",", "17", 
   ",", "17", ",", "6"}], "]"}]], "Input",
 CellChangeTimes->{{3.7643478025754137`*^9, 3.764347847273678*^9}, {
   3.76434787869788*^9, 3.764347969507951*^9}, {3.7643480358302374`*^9, 
   3.764348036752102*^9}, {3.7643485823368015`*^9, 3.7643486817935243`*^9}, {
   3.7643506889422235`*^9, 3.764350748514061*^9}, {3.7643510050203266`*^9, 
   3.7643510784627066`*^9}, {3.764782827275008*^9, 3.764782828774988*^9}, {
   3.764782922778527*^9, 3.7647829427131677`*^9}, {3.7647873848013387`*^9, 
   3.7647874003971653`*^9}, {3.764787680164606*^9, 3.7647876803117495`*^9}, {
   3.7647916493426027`*^9, 3.764791716784655*^9}, {3.7648329545748253`*^9, 
   3.764833049771697*^9}, {3.7648331801897717`*^9, 3.7648331909499955`*^9}, {
   3.7657300143055897`*^9, 3.765730070827095*^9}, {3.766185737009604*^9, 
   3.766185830468605*^9}, {3.7664304344764585`*^9, 3.7664305486469536`*^9}, 
   3.7664313413680935`*^9, 3.7723093279980307`*^9},
 CellLabel->"In[51]:=",ExpressionUUID->"35d0f932-d4b7-4290-a6ef-c16c9fa56ef9"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox["\<\"(15-to-1\\!\\(\\*SubscriptBox[SuperscriptBox[\\()\\), \
\\(\\!\\(\\*RowBox[{\\\"6\\\"}]\\)\\)], \\(\\!\\(\\*RowBox[{\\\"17\\\"}]\\), \
\\!\\(\\*RowBox[{\\\"7\\\"}]\\), \\!\\(\\*RowBox[{\\\"7\\\"}]\\)\\)]\\)\
\[Times](15-to-1\\!\\(\\*SubscriptBox[\\()\\), \
\\(\\!\\(\\*RowBox[{\\\"41\\\"}]\\), \\!\\(\\*RowBox[{\\\"17\\\"}]\\), \\!\\(\
\\*RowBox[{\\\"17\\\"}]\\)\\)]\\) with \\!\\(\\*SubscriptBox[\\(p\\), \\(phys\
\\)]\\)=\\!\\(\\*RowBox[{\\\"\\\\\\\"0.001\\\\\\\"\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(x\\)]\\)=\\!\\(\\*RowBox[{\\\"17\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(z\\)]\\)=\\!\\(\\*RowBox[{\\\"7\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(m\\)]\\)=\\!\\(\\*RowBox[{\\\"7\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(x2\\)]\\)=\\!\\(\\*RowBox[{\\\"41\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(z2\\)]\\)=\\!\\(\\*RowBox[{\\\"17\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(m2\\)]\\)=\\!\\(\\*RowBox[{\\\"17\\\"}]\\) \
and \\!\\(\\*SubscriptBox[\\(n\\), \
\\(L1\\)]\\)=\\!\\(\\*RowBox[{\\\"6\\\"}]\\)\"\>",
  StringForm[
  "(15-to-1\!\(\*SubscriptBox[SuperscriptBox[\()\), \(`7`\)], \(`1`, `2`, `3`\
\)]\)\[Times](15-to-1\!\(\*SubscriptBox[\()\), \(`4`, `5`, `6`\)]\) with \!\(\
\*SubscriptBox[\(p\), \(phys\)]\)=`8`, \!\(\*SubscriptBox[\(d\), \
\(x\)]\)=`1`, \!\(\*SubscriptBox[\(d\), \(z\)]\)=`2`, \
\!\(\*SubscriptBox[\(d\), \(m\)]\)=`3`, \!\(\*SubscriptBox[\(d\), \
\(x2\)]\)=`4`, \!\(\*SubscriptBox[\(d\), \(z2\)]\)=`5`, \
\!\(\*SubscriptBox[\(d\), \(m2\)]\)=`6` and \!\(\*SubscriptBox[\(n\), \(L1\)]\
\)=`7`", 17, 7, 7, 41, 17, 17, 6, 
   NumberForm[0.001]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.764832969212282*^9, 3.764833052171226*^9}, {
   3.764833183130451*^9, 3.7648331933299465`*^9}, 3.764945284963627*^9, 
   3.7651061101843734`*^9, 3.7654102910809565`*^9, 3.765518343711069*^9, 
   3.765522521354392*^9, 3.765724366225581*^9, 3.765727587567711*^9, {
   3.765730016083007*^9, 3.7657300725345345`*^9}, 3.765738839756568*^9, 
   3.7660088819361897`*^9, {3.766185741759537*^9, 3.7661858339216805`*^9}, 
   3.7662424694975524`*^9, 3.766247624272405*^9, 3.766248887708827*^9, 
   3.7662647790215793`*^9, 3.7663570271452713`*^9, 3.766391925794029*^9, 
   3.766393308511695*^9, 3.766402849711759*^9, 3.7664029529761357`*^9, 
   3.766428997117724*^9, {3.7664305290846853`*^9, 3.766430551787538*^9}, 
   3.7664982856127367`*^9, 3.7666902370780354`*^9, 3.766692400021699*^9, 
   3.766704339648393*^9, 3.7667073940591264`*^9, 3.772305748905322*^9, 
   3.772309389518072*^9, 3.7727484997941446`*^9, 3.772751583108983*^9, 
   3.772892553816717*^9, 3.7729232179520054`*^9, 3.7729713711466475`*^9, 
   3.772972996489149*^9},
 CellLabel->
  "During evaluation of \
In[51]:=",ExpressionUUID->"c57210c1-635f-4398-9c44-43a6a8fb4cb3"],

Cell[BoxData[
 InterpretationBox["\<\"Output error: \\!\\(\\*SubscriptBox[\\(p\\), \
\\(out\\)]\\) = \\!\\(\\*RowBox[{\\\"\\\\\\\"4.479\\\\\\\"\\\", \
\\\"\[Times]\\\", SuperscriptBox[\\\"10\\\", \
\\\"\\\\\\\"-20\\\\\\\"\\\"]}]\\)\"\>",
  StringForm["Output error: \!\(\*SubscriptBox[\(p\), \(out\)]\) = `1`", 
   NumberForm[
   4.47852324848321439476712896370380827155`26.821146876972126*^-20, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.764832969212282*^9, 3.764833052171226*^9}, {
   3.764833183130451*^9, 3.7648331933299465`*^9}, 3.764945284963627*^9, 
   3.7651061101843734`*^9, 3.7654102910809565`*^9, 3.765518343711069*^9, 
   3.765522521354392*^9, 3.765724366225581*^9, 3.765727587567711*^9, {
   3.765730016083007*^9, 3.7657300725345345`*^9}, 3.765738839756568*^9, 
   3.7660088819361897`*^9, {3.766185741759537*^9, 3.7661858339216805`*^9}, 
   3.7662424694975524`*^9, 3.766247624272405*^9, 3.766248887708827*^9, 
   3.7662647790215793`*^9, 3.7663570271452713`*^9, 3.766391925794029*^9, 
   3.766393308511695*^9, 3.766402849711759*^9, 3.7664029529761357`*^9, 
   3.766428997117724*^9, {3.7664305290846853`*^9, 3.766430551787538*^9}, 
   3.7664982856127367`*^9, 3.7666902370780354`*^9, 3.766692400021699*^9, 
   3.766704339648393*^9, 3.7667073940591264`*^9, 3.772305748905322*^9, 
   3.772309389518072*^9, 3.7727484997941446`*^9, 3.772751583108983*^9, 
   3.772892553816717*^9, 3.7729232179520054`*^9, 3.7729713711466475`*^9, 
   3.7729729964951334`*^9},
 CellLabel->
  "During evaluation of \
In[51]:=",ExpressionUUID->"7d544555-d0ff-4caf-976e-45661b94e3a3"],

Cell[BoxData[
 InterpretationBox["\<\"Failure probability: \\!\\(\\*SubscriptBox[\\(p\\), \
\\(fail\\)]\\) = \\!\\(\\*RowBox[{\\\"\\\\\\\"1.092\\\\\\\"\\\", \\\"\[Times]\
\\\", SuperscriptBox[\\\"10\\\", \\\"\\\\\\\"-6\\\\\\\"\\\"]}]\\)\"\>",
  StringForm[
  "Failure probability: \!\(\*SubscriptBox[\(p\), \(fail\)]\) = `1`", 
   NumberForm[
   1.0919132102438580830112694713401095028702436408465117`40.55202858184781*^-\
6, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.764832969212282*^9, 3.764833052171226*^9}, {
   3.764833183130451*^9, 3.7648331933299465`*^9}, 3.764945284963627*^9, 
   3.7651061101843734`*^9, 3.7654102910809565`*^9, 3.765518343711069*^9, 
   3.765522521354392*^9, 3.765724366225581*^9, 3.765727587567711*^9, {
   3.765730016083007*^9, 3.7657300725345345`*^9}, 3.765738839756568*^9, 
   3.7660088819361897`*^9, {3.766185741759537*^9, 3.7661858339216805`*^9}, 
   3.7662424694975524`*^9, 3.766247624272405*^9, 3.766248887708827*^9, 
   3.7662647790215793`*^9, 3.7663570271452713`*^9, 3.766391925794029*^9, 
   3.766393308511695*^9, 3.766402849711759*^9, 3.7664029529761357`*^9, 
   3.766428997117724*^9, {3.7664305290846853`*^9, 3.766430551787538*^9}, 
   3.7664982856127367`*^9, 3.7666902370780354`*^9, 3.766692400021699*^9, 
   3.766704339648393*^9, 3.7667073940591264`*^9, 3.772305748905322*^9, 
   3.772309389518072*^9, 3.7727484997941446`*^9, 3.772751583108983*^9, 
   3.772892553816717*^9, 3.7729232179520054`*^9, 3.7729713711466475`*^9, 
   3.7729729965041094`*^9},
 CellLabel->
  "During evaluation of \
In[51]:=",ExpressionUUID->"ad462e2d-9e6b-445d-bb3d-8f15c278d308"],

Cell[BoxData[
 InterpretationBox["\<\"Space cost: \\!\\(\\*RowBox[{\\\"73460\\\"}]\\) \
qubits\"\>",
  StringForm["Space cost: `1` qubits", 73460],
  Editable->False]], "Print",
 CellChangeTimes->{{3.764832969212282*^9, 3.764833052171226*^9}, {
   3.764833183130451*^9, 3.7648331933299465`*^9}, 3.764945284963627*^9, 
   3.7651061101843734`*^9, 3.7654102910809565`*^9, 3.765518343711069*^9, 
   3.765522521354392*^9, 3.765724366225581*^9, 3.765727587567711*^9, {
   3.765730016083007*^9, 3.7657300725345345`*^9}, 3.765738839756568*^9, 
   3.7660088819361897`*^9, {3.766185741759537*^9, 3.7661858339216805`*^9}, 
   3.7662424694975524`*^9, 3.766247624272405*^9, 3.766248887708827*^9, 
   3.7662647790215793`*^9, 3.7663570271452713`*^9, 3.766391925794029*^9, 
   3.766393308511695*^9, 3.766402849711759*^9, 3.7664029529761357`*^9, 
   3.766428997117724*^9, {3.7664305290846853`*^9, 3.766430551787538*^9}, 
   3.7664982856127367`*^9, 3.7666902370780354`*^9, 3.766692400021699*^9, 
   3.766704339648393*^9, 3.7667073940591264`*^9, 3.772305748905322*^9, 
   3.772309389518072*^9, 3.7727484997941446`*^9, 3.772751583108983*^9, 
   3.772892553816717*^9, 3.7729232179520054`*^9, 3.7729713711466475`*^9, 
   3.772972996507102*^9},
 CellLabel->
  "During evaluation of \
In[51]:=",ExpressionUUID->"4c3a83a1-6dde-47b7-95e0-1462a634ad00"],

Cell[BoxData[
 InterpretationBox["\<\"Time cost: \\!\\(\\*RowBox[{\\\"\\\\\\\"127.5\\\\\\\"\
\\\"}]\\) code cycles\"\>",
  StringForm["Time cost: `1` code cycles", 
   NumberForm[127.5001392190863212514`4., 4]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.764832969212282*^9, 3.764833052171226*^9}, {
   3.764833183130451*^9, 3.7648331933299465`*^9}, 3.764945284963627*^9, 
   3.7651061101843734`*^9, 3.7654102910809565`*^9, 3.765518343711069*^9, 
   3.765522521354392*^9, 3.765724366225581*^9, 3.765727587567711*^9, {
   3.765730016083007*^9, 3.7657300725345345`*^9}, 3.765738839756568*^9, 
   3.7660088819361897`*^9, {3.766185741759537*^9, 3.7661858339216805`*^9}, 
   3.7662424694975524`*^9, 3.766247624272405*^9, 3.766248887708827*^9, 
   3.7662647790215793`*^9, 3.7663570271452713`*^9, 3.766391925794029*^9, 
   3.766393308511695*^9, 3.766402849711759*^9, 3.7664029529761357`*^9, 
   3.766428997117724*^9, {3.7664305290846853`*^9, 3.766430551787538*^9}, 
   3.7664982856127367`*^9, 3.7666902370780354`*^9, 3.766692400021699*^9, 
   3.766704339648393*^9, 3.7667073940591264`*^9, 3.772305748905322*^9, 
   3.772309389518072*^9, 3.7727484997941446`*^9, 3.772751583108983*^9, 
   3.772892553816717*^9, 3.7729232179520054`*^9, 3.7729713711466475`*^9, 
   3.7729729965100937`*^9},
 CellLabel->
  "During evaluation of \
In[51]:=",ExpressionUUID->"71c0efe6-dec1-494d-9a7b-0b8b3a4a4571"],

Cell[BoxData[
 InterpretationBox["\<\"Spacetime cost: \
\\!\\(\\*RowBox[{\\\"\\\\\\\"9.366\\\\\\\"\\\", \\\"\[Times]\\\", \
SuperscriptBox[\\\"10\\\", \\\"\\\\\\\"6\\\\\\\"\\\"]}]\\) qubitcycles\"\>",
  StringForm["Spacetime cost: `1` qubitcycles", 
   NumberForm[
   9.3661602270340811591262160029547923161078445431581645389692653543`46.\
51383998740807*^6, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.764832969212282*^9, 3.764833052171226*^9}, {
   3.764833183130451*^9, 3.7648331933299465`*^9}, 3.764945284963627*^9, 
   3.7651061101843734`*^9, 3.7654102910809565`*^9, 3.765518343711069*^9, 
   3.765522521354392*^9, 3.765724366225581*^9, 3.765727587567711*^9, {
   3.765730016083007*^9, 3.7657300725345345`*^9}, 3.765738839756568*^9, 
   3.7660088819361897`*^9, {3.766185741759537*^9, 3.7661858339216805`*^9}, 
   3.7662424694975524`*^9, 3.766247624272405*^9, 3.766248887708827*^9, 
   3.7662647790215793`*^9, 3.7663570271452713`*^9, 3.766391925794029*^9, 
   3.766393308511695*^9, 3.766402849711759*^9, 3.7664029529761357`*^9, 
   3.766428997117724*^9, {3.7664305290846853`*^9, 3.766430551787538*^9}, 
   3.7664982856127367`*^9, 3.7666902370780354`*^9, 3.766692400021699*^9, 
   3.766704339648393*^9, 3.7667073940591264`*^9, 3.772305748905322*^9, 
   3.772309389518072*^9, 3.7727484997941446`*^9, 3.772751583108983*^9, 
   3.772892553816717*^9, 3.7729232179520054`*^9, 3.7729713711466475`*^9, 
   3.7729729965130854`*^9},
 CellLabel->
  "During evaluation of \
In[51]:=",ExpressionUUID->"5278ca77-2bcd-435d-9728-af8f9a2e9172"],

Cell[BoxData[
 InterpretationBox["\<\"For a 100-qubit computation: \\!\\(\\*SuperscriptBox[\
\\(\\!\\(\\*RowBox[{\\\"\\\\\\\"39.81\\\\\\\"\\\"}]\\)d\\), \\(3\\)]\\) \
(d=\\!\\(\\*RowBox[{\\\"49\\\"}]\\))\"\>",
  StringForm[
  "For a 100-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\)]\) \
(d=`2`)", 
   NumberForm[
   39.8055241737459781176474768291901857053942003041171813571321`46.\
51383998740807, 4], 49],
  Editable->False]], "Print",
 CellChangeTimes->{{3.764832969212282*^9, 3.764833052171226*^9}, {
   3.764833183130451*^9, 3.7648331933299465`*^9}, 3.764945284963627*^9, 
   3.7651061101843734`*^9, 3.7654102910809565`*^9, 3.765518343711069*^9, 
   3.765522521354392*^9, 3.765724366225581*^9, 3.765727587567711*^9, {
   3.765730016083007*^9, 3.7657300725345345`*^9}, 3.765738839756568*^9, 
   3.7660088819361897`*^9, {3.766185741759537*^9, 3.7661858339216805`*^9}, 
   3.7662424694975524`*^9, 3.766247624272405*^9, 3.766248887708827*^9, 
   3.7662647790215793`*^9, 3.7663570271452713`*^9, 3.766391925794029*^9, 
   3.766393308511695*^9, 3.766402849711759*^9, 3.7664029529761357`*^9, 
   3.766428997117724*^9, {3.7664305290846853`*^9, 3.766430551787538*^9}, 
   3.7664982856127367`*^9, 3.7666902370780354`*^9, 3.766692400021699*^9, 
   3.766704339648393*^9, 3.7667073940591264`*^9, 3.772305748905322*^9, 
   3.772309389518072*^9, 3.7727484997941446`*^9, 3.772751583108983*^9, 
   3.772892553816717*^9, 3.7729232179520054`*^9, 3.7729713711466475`*^9, 
   3.772972996516078*^9},
 CellLabel->
  "During evaluation of \
In[51]:=",ExpressionUUID->"04c7e3e6-266d-4a6a-a145-24b10c6923fe"],

Cell[BoxData[
 InterpretationBox["\<\"For a 10000-qubit computation: \
\\!\\(\\*SuperscriptBox[\\(\\!\\(\\*RowBox[{\\\"\\\\\\\"31.46\\\\\\\"\\\"}]\\)\
d\\), \\(3\\)]\\) (d=\\!\\(\\*RowBox[{\\\"53\\\"}]\\))\"\>",
  StringForm[
  "For a 10000-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\)]\) \
(d=`2`)", 
   NumberForm[
   31.4560349383520663337057302436064412773895381528314129750342`46.\
51383998740807, 4], 53],
  Editable->False]], "Print",
 CellChangeTimes->{{3.764832969212282*^9, 3.764833052171226*^9}, {
   3.764833183130451*^9, 3.7648331933299465`*^9}, 3.764945284963627*^9, 
   3.7651061101843734`*^9, 3.7654102910809565`*^9, 3.765518343711069*^9, 
   3.765522521354392*^9, 3.765724366225581*^9, 3.765727587567711*^9, {
   3.765730016083007*^9, 3.7657300725345345`*^9}, 3.765738839756568*^9, 
   3.7660088819361897`*^9, {3.766185741759537*^9, 3.7661858339216805`*^9}, 
   3.7662424694975524`*^9, 3.766247624272405*^9, 3.766248887708827*^9, 
   3.7662647790215793`*^9, 3.7663570271452713`*^9, 3.766391925794029*^9, 
   3.766393308511695*^9, 3.766402849711759*^9, 3.7664029529761357`*^9, 
   3.766428997117724*^9, {3.7664305290846853`*^9, 3.766430551787538*^9}, 
   3.7664982856127367`*^9, 3.7666902370780354`*^9, 3.766692400021699*^9, 
   3.766704339648393*^9, 3.7667073940591264`*^9, 3.772305748905322*^9, 
   3.772309389518072*^9, 3.7727484997941446`*^9, 3.772751583108983*^9, 
   3.772892553816717*^9, 3.7729232179520054`*^9, 3.7729713711466475`*^9, 
   3.7729729965190697`*^9},
 CellLabel->
  "During evaluation of \
In[51]:=",ExpressionUUID->"f7a6f48c-4e4a-4500-a8ed-8828326d3029"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["CCZ synthillation", "Chapter",
 CellChangeTimes->{{3.764790754263265*^9, 3.764790767012478*^9}, {
  3.764791547106655*^9, 3.7647915472225523`*^9}, {3.7648390210533533`*^9, 
  3.7648390242329545`*^9}},ExpressionUUID->"db33e2a9-363c-4ff3-a1fc-\
cab48fee6344"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CostOfTwoLevel8toCCZ", "[", 
  RowBox[{
   SuperscriptBox["10", 
    RowBox[{"-", "4"}]], ",", "7", ",", "3", ",", "3", ",", "15", ",", "7", 
   ",", "9", ",", "4"}], "]"}]], "Input",
 CellChangeTimes->{{3.76479155679858*^9, 3.764791566693867*^9}, {
   3.7648390333826694`*^9, 3.7648390653521676`*^9}, {3.7657321670031443`*^9, 
   3.765732244023938*^9}, {3.76573231874449*^9, 3.7657323907039423`*^9}, 
   3.765732591776144*^9, {3.7661858739576855`*^9, 3.766186027410612*^9}, {
   3.7666901205374546`*^9, 3.7666901210232944`*^9}, {3.772975478956696*^9, 
   3.772975480502579*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"66a4cc80-2583-4b09-bd35-e9f56a5beaec"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox["\<\"(15-to-1\\!\\(\\*SubscriptBox[SuperscriptBox[\\()\\), \
\\(\\!\\(\\*RowBox[{\\\"4\\\"}]\\)\\)], \\(\\!\\(\\*RowBox[{\\\"7\\\"}]\\), \
\\!\\(\\*RowBox[{\\\"3\\\"}]\\), \\!\\(\\*RowBox[{\\\"3\\\"}]\\)\\)]\\)\
\[Times](8-to-CCZ\\!\\(\\*SubscriptBox[\\()\\), \
\\(\\!\\(\\*RowBox[{\\\"15\\\"}]\\), \\!\\(\\*RowBox[{\\\"7\\\"}]\\), \
\\!\\(\\*RowBox[{\\\"9\\\"}]\\)\\)]\\) with \\!\\(\\*SubscriptBox[\\(p\\), \
\\(phys\\)]\\)=\\!\\(\\*RowBox[{\\\"\\\\\\\"0.0001\\\\\\\"\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(x\\)]\\)=\\!\\(\\*RowBox[{\\\"7\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(z\\)]\\)=\\!\\(\\*RowBox[{\\\"3\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(m\\)]\\)=\\!\\(\\*RowBox[{\\\"3\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(x2\\)]\\)=\\!\\(\\*RowBox[{\\\"15\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(z2\\)]\\)=\\!\\(\\*RowBox[{\\\"7\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(m2\\)]\\)=\\!\\(\\*RowBox[{\\\"9\\\"}]\\) \
and \\!\\(\\*SubscriptBox[\\(n\\), \
\\(L1\\)]\\)=\\!\\(\\*RowBox[{\\\"4\\\"}]\\)\"\>",
  StringForm[
  "(15-to-1\!\(\*SubscriptBox[SuperscriptBox[\()\), \(`7`\)], \(`1`, `2`, `3`\
\)]\)\[Times](8-to-CCZ\!\(\*SubscriptBox[\()\), \(`4`, `5`, `6`\)]\) with \
\!\(\*SubscriptBox[\(p\), \(phys\)]\)=`8`, \!\(\*SubscriptBox[\(d\), \
\(x\)]\)=`1`, \!\(\*SubscriptBox[\(d\), \(z\)]\)=`2`, \
\!\(\*SubscriptBox[\(d\), \(m\)]\)=`3`, \!\(\*SubscriptBox[\(d\), \
\(x2\)]\)=`4`, \!\(\*SubscriptBox[\(d\), \(z2\)]\)=`5`, \
\!\(\*SubscriptBox[\(d\), \(m2\)]\)=`6` and \!\(\*SubscriptBox[\(n\), \(L1\)]\
\)=`7`", 7, 3, 3, 15, 7, 9, 4, 
   NumberForm[0.0001]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.765732047262329*^9, {3.7657321676669254`*^9, 3.765732245084591*^9}, {
   3.7657323217864914`*^9, 3.765732391698613*^9}, 3.7657326024596467`*^9, 
   3.766008910232664*^9, {3.7661858785044947`*^9, 3.76618602920747*^9}, 
   3.7662424711069064`*^9, 3.7662476259442577`*^9, 3.766248889318181*^9, {
   3.7663604432342277`*^9, 3.7663604710940437`*^9}, 3.766391931590834*^9, 
   3.7663933100898013`*^9, 3.766402954616742*^9, 3.7664290364609966`*^9, 
   3.7664305787247133`*^9, 3.766498351522602*^9, 3.76669023903639*^9, 
   3.766692401968685*^9, 3.7667043416383724`*^9, 3.766707396038685*^9, 
   3.7727485680567226`*^9, 3.772751588204112*^9, 3.772786877933279*^9, 
   3.7728925554049892`*^9, 3.7729232195283623`*^9, {3.7729754644019938`*^9, 
   3.772975486181821*^9}},
 CellLabel->
  "During evaluation of \
In[63]:=",ExpressionUUID->"fb96e8b9-4b24-4a9b-9d03-1a87e4d4f7cd"],

Cell[BoxData[
 InterpretationBox["\<\"Output error: \\!\\(\\*SubscriptBox[\\(p\\), \
\\(out\\)]\\) = \\!\\(\\*RowBox[{\\\"\\\\\\\"7.226\\\\\\\"\\\", \
\\\"\[Times]\\\", SuperscriptBox[\\\"10\\\", \
\\\"\\\\\\\"-14\\\\\\\"\\\"]}]\\)\"\>",
  StringForm["Output error: \!\(\*SubscriptBox[\(p\), \(out\)]\) = `1`", 
   NumberForm[
   7.2257079419088758345791021585740884565038372`34.70879465487516*^-14, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.765732047262329*^9, {3.7657321676669254`*^9, 3.765732245084591*^9}, {
   3.7657323217864914`*^9, 3.765732391698613*^9}, 3.7657326024596467`*^9, 
   3.766008910232664*^9, {3.7661858785044947`*^9, 3.76618602920747*^9}, 
   3.7662424711069064`*^9, 3.7662476259442577`*^9, 3.766248889318181*^9, {
   3.7663604432342277`*^9, 3.7663604710940437`*^9}, 3.766391931590834*^9, 
   3.7663933100898013`*^9, 3.766402954616742*^9, 3.7664290364609966`*^9, 
   3.7664305787247133`*^9, 3.766498351522602*^9, 3.76669023903639*^9, 
   3.766692401968685*^9, 3.7667043416383724`*^9, 3.766707396038685*^9, 
   3.7727485680567226`*^9, 3.772751588204112*^9, 3.772786877933279*^9, 
   3.7728925554049892`*^9, 3.7729232195283623`*^9, {3.7729754644019938`*^9, 
   3.7729754861921897`*^9}},
 CellLabel->
  "During evaluation of \
In[63]:=",ExpressionUUID->"ae5db285-a504-40a2-ae23-7c774348647f"],

Cell[BoxData[
 InterpretationBox["\<\"Failure probability: \\!\\(\\*SubscriptBox[\\(p\\), \
\\(fail\\)]\\) = \\!\\(\\*RowBox[{\\\"\\\\\\\"3.984\\\\\\\"\\\", \\\"\[Times]\
\\\", SuperscriptBox[\\\"10\\\", \\\"\\\\\\\"-7\\\\\\\"\\\"]}]\\)\"\>",
  StringForm[
  "Failure probability: \!\(\*SubscriptBox[\(p\), \(fail\)]\) = `1`", 
   NumberForm[
   3.984151238038800874100550543359256227731687925665536`41.75585175144661*^-\
7, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.765732047262329*^9, {3.7657321676669254`*^9, 3.765732245084591*^9}, {
   3.7657323217864914`*^9, 3.765732391698613*^9}, 3.7657326024596467`*^9, 
   3.766008910232664*^9, {3.7661858785044947`*^9, 3.76618602920747*^9}, 
   3.7662424711069064`*^9, 3.7662476259442577`*^9, 3.766248889318181*^9, {
   3.7663604432342277`*^9, 3.7663604710940437`*^9}, 3.766391931590834*^9, 
   3.7663933100898013`*^9, 3.766402954616742*^9, 3.7664290364609966`*^9, 
   3.7664305787247133`*^9, 3.766498351522602*^9, 3.76669023903639*^9, 
   3.766692401968685*^9, 3.7667043416383724`*^9, 3.766707396038685*^9, 
   3.7727485680567226`*^9, 3.772751588204112*^9, 3.772786877933279*^9, 
   3.7728925554049892`*^9, 3.7729232195283623`*^9, {3.7729754644019938`*^9, 
   3.7729754862117605`*^9}},
 CellLabel->
  "During evaluation of \
In[63]:=",ExpressionUUID->"03d623f1-edfb-45dd-8b20-12afdeea31e8"],

Cell[BoxData[
 InterpretationBox["\<\"Space cost: \\!\\(\\*RowBox[{\\\"12384\\\"}]\\) \
qubits\"\>",
  StringForm["Space cost: `1` qubits", 12384],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.765732047262329*^9, {3.7657321676669254`*^9, 3.765732245084591*^9}, {
   3.7657323217864914`*^9, 3.765732391698613*^9}, 3.7657326024596467`*^9, 
   3.766008910232664*^9, {3.7661858785044947`*^9, 3.76618602920747*^9}, 
   3.7662424711069064`*^9, 3.7662476259442577`*^9, 3.766248889318181*^9, {
   3.7663604432342277`*^9, 3.7663604710940437`*^9}, 3.766391931590834*^9, 
   3.7663933100898013`*^9, 3.766402954616742*^9, 3.7664290364609966`*^9, 
   3.7664305787247133`*^9, 3.766498351522602*^9, 3.76669023903639*^9, 
   3.766692401968685*^9, 3.7667043416383724`*^9, 3.766707396038685*^9, 
   3.7727485680567226`*^9, 3.772751588204112*^9, 3.772786877933279*^9, 
   3.7728925554049892`*^9, 3.7729232195283623`*^9, {3.7729754644019938`*^9, 
   3.772975486223632*^9}},
 CellLabel->
  "During evaluation of \
In[63]:=",ExpressionUUID->"2b33f05d-2b13-4feb-a1a7-790f2855dffd"],

Cell[BoxData[
 InterpretationBox["\<\"Time cost: \\!\\(\\*RowBox[{\\\"\\\\\\\"36.11\\\\\\\"\
\\\"}]\\) code cycles\"\>",
  StringForm["Time cost: `1` code cycles", 
   NumberForm[36.1102858963143274243`4., 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.765732047262329*^9, {3.7657321676669254`*^9, 3.765732245084591*^9}, {
   3.7657323217864914`*^9, 3.765732391698613*^9}, 3.7657326024596467`*^9, 
   3.766008910232664*^9, {3.7661858785044947`*^9, 3.76618602920747*^9}, 
   3.7662424711069064`*^9, 3.7662476259442577`*^9, 3.766248889318181*^9, {
   3.7663604432342277`*^9, 3.7663604710940437`*^9}, 3.766391931590834*^9, 
   3.7663933100898013`*^9, 3.766402954616742*^9, 3.7664290364609966`*^9, 
   3.7664305787247133`*^9, 3.766498351522602*^9, 3.76669023903639*^9, 
   3.766692401968685*^9, 3.7667043416383724`*^9, 3.766707396038685*^9, 
   3.7727485680567226`*^9, 3.772751588204112*^9, 3.772786877933279*^9, 
   3.7728925554049892`*^9, 3.7729232195283623`*^9, {3.7729754644019938`*^9, 
   3.7729754862311916`*^9}},
 CellLabel->
  "During evaluation of \
In[63]:=",ExpressionUUID->"53c9b71d-5503-4230-8199-030e8e4adbe8"],

Cell[BoxData[
 InterpretationBox["\<\"Spacetime cost: \
\\!\\(\\*RowBox[{\\\"\\\\\\\"447200.\\\\\\\"\\\"}]\\) qubitcycles per output \
state\"\>",
  StringForm["Spacetime cost: `1` qubitcycles per output state", 
   NumberForm[
   447189.780539956630823180443710243789557411676136512964907565115`46.\
505138590781655, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.765732047262329*^9, {3.7657321676669254`*^9, 3.765732245084591*^9}, {
   3.7657323217864914`*^9, 3.765732391698613*^9}, 3.7657326024596467`*^9, 
   3.766008910232664*^9, {3.7661858785044947`*^9, 3.76618602920747*^9}, 
   3.7662424711069064`*^9, 3.7662476259442577`*^9, 3.766248889318181*^9, {
   3.7663604432342277`*^9, 3.7663604710940437`*^9}, 3.766391931590834*^9, 
   3.7663933100898013`*^9, 3.766402954616742*^9, 3.7664290364609966`*^9, 
   3.7664305787247133`*^9, 3.766498351522602*^9, 3.76669023903639*^9, 
   3.766692401968685*^9, 3.7667043416383724`*^9, 3.766707396038685*^9, 
   3.7727485680567226`*^9, 3.772751588204112*^9, 3.772786877933279*^9, 
   3.7728925554049892`*^9, 3.7729232195283623`*^9, {3.7729754644019938`*^9, 
   3.7729754862421412`*^9}},
 CellLabel->
  "During evaluation of \
In[63]:=",ExpressionUUID->"d3ebbb44-25e9-406a-acc8-24c2e7af9c05"],

Cell[BoxData[
 InterpretationBox["\<\"For a 100-qubit computation: \\!\\(\\*SuperscriptBox[\
\\(\\!\\(\\*RowBox[{\\\"\\\\\\\"32.60\\\\\\\"\\\"}]\\)d\\), \\(3\\)]\\) \
(d=\\!\\(\\*RowBox[{\\\"19\\\"}]\\))\"\>",
  StringForm[
  "For a 100-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\)]\) \
(d=`2`)", 
   NumberForm[
   32.5987593337189554470899871490190836534051374935495673500194`46.\
505138590781655, 4], 19],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.765732047262329*^9, {3.7657321676669254`*^9, 3.765732245084591*^9}, {
   3.7657323217864914`*^9, 3.765732391698613*^9}, 3.7657326024596467`*^9, 
   3.766008910232664*^9, {3.7661858785044947`*^9, 3.76618602920747*^9}, 
   3.7662424711069064`*^9, 3.7662476259442577`*^9, 3.766248889318181*^9, {
   3.7663604432342277`*^9, 3.7663604710940437`*^9}, 3.766391931590834*^9, 
   3.7663933100898013`*^9, 3.766402954616742*^9, 3.7664290364609966`*^9, 
   3.7664305787247133`*^9, 3.766498351522602*^9, 3.76669023903639*^9, 
   3.766692401968685*^9, 3.7667043416383724`*^9, 3.766707396038685*^9, 
   3.7727485680567226`*^9, 3.772751588204112*^9, 3.772786877933279*^9, 
   3.7728925554049892`*^9, 3.7729232195283623`*^9, {3.7729754644019938`*^9, 
   3.7729754862421412`*^9}},
 CellLabel->
  "During evaluation of \
In[63]:=",ExpressionUUID->"7f79753e-e005-4c69-a027-32bece865507"],

Cell[BoxData[
 InterpretationBox["\<\"For a 10000-qubit computation: \
\\!\\(\\*SuperscriptBox[\\(\\!\\(\\*RowBox[{\\\"\\\\\\\"24.14\\\\\\\"\\\"}]\\)\
d\\), \\(3\\)]\\) (d=\\!\\(\\*RowBox[{\\\"21\\\"}]\\))\"\>",
  StringForm[
  "For a 10000-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\)]\) \
(d=`2`)", 
   NumberForm[
   24.1437091318408719805194063119665149312931473996605639189918`46.\
505138590781655, 4], 21],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.765732047262329*^9, {3.7657321676669254`*^9, 3.765732245084591*^9}, {
   3.7657323217864914`*^9, 3.765732391698613*^9}, 3.7657326024596467`*^9, 
   3.766008910232664*^9, {3.7661858785044947`*^9, 3.76618602920747*^9}, 
   3.7662424711069064`*^9, 3.7662476259442577`*^9, 3.766248889318181*^9, {
   3.7663604432342277`*^9, 3.7663604710940437`*^9}, 3.766391931590834*^9, 
   3.7663933100898013`*^9, 3.766402954616742*^9, 3.7664290364609966`*^9, 
   3.7664305787247133`*^9, 3.766498351522602*^9, 3.76669023903639*^9, 
   3.766692401968685*^9, 3.7667043416383724`*^9, 3.766707396038685*^9, 
   3.7727485680567226`*^9, 3.772751588204112*^9, 3.772786877933279*^9, 
   3.7728925554049892`*^9, 3.7729232195283623`*^9, {3.7729754644019938`*^9, 
   3.7729754862522182`*^9}},
 CellLabel->
  "During evaluation of \
In[63]:=",ExpressionUUID->"41a4b6d9-a27a-4794-8c2d-5d58ff478410"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CostOfTwoLevel8toCCZ", "[", 
  RowBox[{
   SuperscriptBox["10", 
    RowBox[{"-", "3"}]], ",", "13", ",", "7", ",", "7", ",", "25", ",", "15", 
   ",", "15", ",", "6"}], "]"}]], "Input",
 CellChangeTimes->{{3.76479155679858*^9, 3.764791566693867*^9}, {
  3.7648390333826694`*^9, 3.7648390653521676`*^9}, {3.7648391413635426`*^9, 
  3.764839196631301*^9}, {3.7648392417306356`*^9, 3.7648393539400387`*^9}, {
  3.7648395302485867`*^9, 3.764839545067649*^9}, {3.76573773979482*^9, 
  3.7657377422146463`*^9}, {3.7657377915661383`*^9, 3.7657378565715103`*^9}, {
  3.7657379792127867`*^9, 3.7657379984464216`*^9}, {3.7660099188778105`*^9, 
  3.7660099262995777`*^9}, {3.7661860692115173`*^9, 3.7661861233140287`*^9}, {
  3.76618617381946*^9, 3.7661862245419393`*^9}, {3.7664087341004505`*^9, 
  3.766408738772272*^9}, {3.7666901240902824`*^9, 3.7666901243102074`*^9}, {
  3.7727485701031294`*^9, 3.772748666341859*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"4ac8b07f-0c00-4dd0-8dab-62081c6d2e0b"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox["\<\"(15-to-1\\!\\(\\*SubscriptBox[SuperscriptBox[\\()\\), \
\\(\\!\\(\\*RowBox[{\\\"6\\\"}]\\)\\)], \\(\\!\\(\\*RowBox[{\\\"13\\\"}]\\), \
\\!\\(\\*RowBox[{\\\"7\\\"}]\\), \\!\\(\\*RowBox[{\\\"7\\\"}]\\)\\)]\\)\
\[Times](8-to-CCZ\\!\\(\\*SubscriptBox[\\()\\), \
\\(\\!\\(\\*RowBox[{\\\"25\\\"}]\\), \\!\\(\\*RowBox[{\\\"15\\\"}]\\), \\!\\(\
\\*RowBox[{\\\"15\\\"}]\\)\\)]\\) with \\!\\(\\*SubscriptBox[\\(p\\), \\(phys\
\\)]\\)=\\!\\(\\*RowBox[{\\\"\\\\\\\"0.001\\\\\\\"\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(x\\)]\\)=\\!\\(\\*RowBox[{\\\"13\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(z\\)]\\)=\\!\\(\\*RowBox[{\\\"7\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(m\\)]\\)=\\!\\(\\*RowBox[{\\\"7\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(x2\\)]\\)=\\!\\(\\*RowBox[{\\\"25\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(z2\\)]\\)=\\!\\(\\*RowBox[{\\\"15\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(m2\\)]\\)=\\!\\(\\*RowBox[{\\\"15\\\"}]\\) \
and \\!\\(\\*SubscriptBox[\\(n\\), \
\\(L1\\)]\\)=\\!\\(\\*RowBox[{\\\"6\\\"}]\\)\"\>",
  StringForm[
  "(15-to-1\!\(\*SubscriptBox[SuperscriptBox[\()\), \(`7`\)], \(`1`, `2`, `3`\
\)]\)\[Times](8-to-CCZ\!\(\*SubscriptBox[\()\), \(`4`, `5`, `6`\)]\) with \
\!\(\*SubscriptBox[\(p\), \(phys\)]\)=`8`, \!\(\*SubscriptBox[\(d\), \
\(x\)]\)=`1`, \!\(\*SubscriptBox[\(d\), \(z\)]\)=`2`, \
\!\(\*SubscriptBox[\(d\), \(m\)]\)=`3`, \!\(\*SubscriptBox[\(d\), \
\(x2\)]\)=`4`, \!\(\*SubscriptBox[\(d\), \(z2\)]\)=`5`, \
\!\(\*SubscriptBox[\(d\), \(m2\)]\)=`6` and \!\(\*SubscriptBox[\(n\), \(L1\)]\
\)=`7`", 13, 7, 7, 25, 15, 15, 6, 
   NumberForm[0.001]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7727485723369646`*^9, {3.772748610250141*^9, 3.7727486689526625`*^9}, 
   3.7727515899068356`*^9, 3.7728925571251183`*^9, 3.772923221202285*^9, 
   3.7729754676521435`*^9},
 CellLabel->
  "During evaluation of \
In[61]:=",ExpressionUUID->"d165bddd-a4b9-413c-9c97-dd97a5a7fc39"],

Cell[BoxData[
 InterpretationBox["\<\"Output error: \\!\\(\\*SubscriptBox[\\(p\\), \
\\(out\\)]\\) = \\!\\(\\*RowBox[{\\\"\\\\\\\"5.245\\\\\\\"\\\", \
\\\"\[Times]\\\", SuperscriptBox[\\\"10\\\", \
\\\"\\\\\\\"-11\\\\\\\"\\\"]}]\\)\"\>",
  StringForm["Output error: \!\(\*SubscriptBox[\(p\), \(out\)]\) = `1`", 
   NumberForm[
   5.24455880521879093893824443666991500087359219105`37.56962526440614*^-11, 
    4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7727485723369646`*^9, {3.772748610250141*^9, 3.7727486689526625`*^9}, 
   3.7727515899068356`*^9, 3.7728925571251183`*^9, 3.772923221202285*^9, 
   3.7729754676561513`*^9},
 CellLabel->
  "During evaluation of \
In[61]:=",ExpressionUUID->"8e6fedaf-dd1f-4d79-b184-97dee22e1c5c"],

Cell[BoxData[
 InterpretationBox["\<\"Failure probability: \\!\\(\\*SubscriptBox[\\(p\\), \
\\(fail\\)]\\) = \\!\\(\\*RowBox[{\\\"\\\\\\\"0.00001032\\\\\\\"\\\"}]\\)\"\>",
  StringForm[
  "Failure probability: \!\(\*SubscriptBox[\(p\), \(fail\)]\) = `1`", 
   NumberForm[
   0.0000103151486349360574275544370680406397365711667216325905`43.\
168997186907575, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7727485723369646`*^9, {3.772748610250141*^9, 3.7727486689526625`*^9}, 
   3.7727515899068356`*^9, 3.7728925571251183`*^9, 3.772923221202285*^9, 
   3.7729754676652737`*^9},
 CellLabel->
  "During evaluation of \
In[61]:=",ExpressionUUID->"3b9fc894-c0bf-4fb3-99c8-e16c8a00f18b"],

Cell[BoxData[
 InterpretationBox["\<\"Space cost: \\!\\(\\*RowBox[{\\\"47046\\\"}]\\) \
qubits\"\>",
  StringForm["Space cost: `1` qubits", 47046],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7727485723369646`*^9, {3.772748610250141*^9, 3.7727486689526625`*^9}, 
   3.7727515899068356`*^9, 3.7728925571251183`*^9, 3.772923221202285*^9, 
   3.7729754676713505`*^9},
 CellLabel->
  "During evaluation of \
In[61]:=",ExpressionUUID->"e0ca3ad5-48da-4d58-8c0b-7e501afc42c4"],

Cell[BoxData[
 InterpretationBox["\<\"Time cost: \\!\\(\\*RowBox[{\\\"\\\\\\\"60.00\\\\\\\"\
\\\"}]\\) code cycles\"\>",
  StringForm["Time cost: `1` code cycles", 
   NumberForm[60.0006189153022994991`4., 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7727485723369646`*^9, {3.772748610250141*^9, 3.7727486689526625`*^9}, 
   3.7727515899068356`*^9, 3.7728925571251183`*^9, 3.772923221202285*^9, 
   3.7729754676713505`*^9},
 CellLabel->
  "During evaluation of \
In[61]:=",ExpressionUUID->"730cd929-da7c-45ca-b52b-cad4798bce7b"],

Cell[BoxData[
 InterpretationBox["\<\"Spacetime cost: \
\\!\\(\\*RowBox[{\\\"\\\\\\\"2.823\\\\\\\"\\\", \\\"\[Times]\\\", \
SuperscriptBox[\\\"10\\\", \\\"\\\\\\\"6\\\\\\\"\\\"]}]\\) qubitcycles per \
output state\"\>",
  StringForm["Spacetime cost: `1` qubitcycles per output state", 
   NumberForm[
   2.8227891174893119822347229940401554304030078264422097637705068359`48.\
155517216802195*^6, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7727485723369646`*^9, {3.772748610250141*^9, 3.7727486689526625`*^9}, 
   3.7727515899068356`*^9, 3.7728925571251183`*^9, 3.772923221202285*^9, 
   3.7729754676713505`*^9},
 CellLabel->
  "During evaluation of \
In[61]:=",ExpressionUUID->"9cd518a6-accf-492b-8877-aac048cdb701"],

Cell[BoxData[
 InterpretationBox["\<\"For a 100-qubit computation: \\!\\(\\*SuperscriptBox[\
\\(\\!\\(\\*RowBox[{\\\"\\\\\\\"47.38\\\\\\\"\\\"}]\\)d\\), \\(3\\)]\\) \
(d=\\!\\(\\*RowBox[{\\\"31\\\"}]\\))\"\>",
  StringForm[
  "For a 100-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\)]\) \
(d=`2`)", 
   NumberForm[
   47.3765418664917589579860191675364276191300699278676406258687`48.\
155517216802195, 4], 31],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7727485723369646`*^9, {3.772748610250141*^9, 3.7727486689526625`*^9}, 
   3.7727515899068356`*^9, 3.7728925571251183`*^9, 3.772923221202285*^9, 
   3.7729754676713505`*^9},
 CellLabel->
  "During evaluation of \
In[61]:=",ExpressionUUID->"3d8c0dcc-59c2-4c19-ac6f-065db0490a7b"],

Cell[BoxData[
 InterpretationBox["\<\"For a 10000-qubit computation: \
\\!\\(\\*SuperscriptBox[\\(\\!\\(\\*RowBox[{\\\"\\\\\\\"32.92\\\\\\\"\\\"}]\\)\
d\\), \\(3\\)]\\) (d=\\!\\(\\*RowBox[{\\\"35\\\"}]\\))\"\>",
  StringForm[
  "For a 10000-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\)]\) \
(d=`2`)", 
   NumberForm[
   32.9188235275721513963233002220426289259825985590928252334753`48.\
155517216802195, 4], 35],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7727485723369646`*^9, {3.772748610250141*^9, 3.7727486689526625`*^9}, 
   3.7727515899068356`*^9, 3.7728925571251183`*^9, 3.772923221202285*^9, 
   3.772975467681861*^9},
 CellLabel->
  "During evaluation of \
In[61]:=",ExpressionUUID->"9783da00-090f-4dde-95b9-0ed9f0cf65be"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Small footprint", "Chapter",
 CellChangeTimes->{{3.764790754263265*^9, 3.764790767012478*^9}, {
  3.764791547106655*^9, 3.7647915472225523`*^9}, {3.7648390210533533`*^9, 
  3.7648390242329545`*^9}, {3.7664071418755603`*^9, 
  3.766407144047408*^9}},ExpressionUUID->"e3e334fc-58f4-4906-8766-\
d825a241219b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CostOfOneLevel15to1SmallFootprint", "[", 
  RowBox[{
   SuperscriptBox["10", 
    RowBox[{"-", "4"}]], ",", "9", ",", "3", ",", "3"}], "]"}]], "Input",
 CellChangeTimes->{{3.7663943698967094`*^9, 3.76639437566226*^9}, {
  3.766394421974205*^9, 3.76639446766115*^9}, {3.7663945051763215`*^9, 
  3.766394505316945*^9}, {3.766394675424266*^9, 3.766394697845871*^9}, {
  3.766401150083827*^9, 3.7664011526169634`*^9}, {3.7664066082080684`*^9, 
  3.766406628489073*^9}, {3.766430779284792*^9, 3.7664307873940687`*^9}, {
  3.7664309509702177`*^9, 3.7664309881416426`*^9}, {3.766699352797697*^9, 
  3.7666993535350885`*^9}, {3.7729771092690353`*^9, 3.7729771106802673`*^9}, {
  3.7729778119778805`*^9, 3.772977838022105*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"c1f85ee1-5c17-4c0b-aac1-70137c2c4cda"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox["\<\"Small-footprint \
(15-to-1\\!\\(\\*SubscriptBox[\\()\\), \\(\\!\\(\\*RowBox[{\\\"9\\\"}]\\), \
\\!\\(\\*RowBox[{\\\"3\\\"}]\\), \\!\\(\\*RowBox[{\\\"3\\\"}]\\)\\)]\\) with \
\\!\\(\\*SubscriptBox[\\(p\\), \
\\(phys\\)]\\)=\\!\\(\\*RowBox[{\\\"\\\\\\\"0.0001\\\\\\\"\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(x\\)]\\)=\\!\\(\\*RowBox[{\\\"9\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(z\\)]\\)=\\!\\(\\*RowBox[{\\\"3\\\"}]\\) \
and \\!\\(\\*SubscriptBox[\\(d\\), \
\\(m\\)]\\)=\\!\\(\\*RowBox[{\\\"3\\\"}]\\)\"\>",
  StringForm[
  "Small-footprint (15-to-1\!\(\*SubscriptBox[\()\), \(`1`, `2`, `3`\)]\) \
with \!\(\*SubscriptBox[\(p\), \(phys\)]\)=`4`, \!\(\*SubscriptBox[\(d\), \(x\
\)]\)=`1`, \!\(\*SubscriptBox[\(d\), \(z\)]\)=`2` and \
\!\(\*SubscriptBox[\(d\), \(m\)]\)=`3`", 9, 3, 3, 
   NumberForm[0.0001]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7663943780841055`*^9, {3.7663944244741726`*^9, 3.7663944697548733`*^9}, 
   3.7663945075200415`*^9, {3.7663946591119614`*^9, 3.7663947000177155`*^9}, 
   3.766401154960682*^9, {3.766406610723663*^9, 3.766406630770295*^9}, {
   3.766407279644719*^9, 3.766407289769596*^9}, {3.766430955032665*^9, 
   3.766430990313489*^9}, 3.7664843671264668`*^9, 3.766498376494238*^9, 
   3.76669024322701*^9, 3.766692406188982*^9, 3.7666993565840807`*^9, 
   3.7667003076125445`*^9, 3.7667043463044004`*^9, 3.7667044874796357`*^9, {
   3.7667057430386715`*^9, 3.7667057888429537`*^9}, 3.766707400638065*^9, 
   3.7727508102459564`*^9, 3.7727516179140015`*^9, 3.7728925591303015`*^9, 
   3.7729216044299974`*^9, 3.772923223282447*^9, {3.7729766128083277`*^9, 
   3.772976625075656*^9}, 3.7729768665122566`*^9, 3.7729771071562133`*^9, {
   3.7729777972015543`*^9, 3.772977844367676*^9}},
 CellLabel->
  "During evaluation of \
In[108]:=",ExpressionUUID->"19d61e60-4ece-42df-a48c-733cdef1e289"],

Cell[BoxData[
 InterpretationBox["\<\"Output error: \\!\\(\\*SubscriptBox[\\(p\\), \
\\(out\\)]\\) = \\!\\(\\*RowBox[{\\\"\\\\\\\"1.515\\\\\\\"\\\", \
\\\"\[Times]\\\", SuperscriptBox[\\\"10\\\", \\\"\\\\\\\"-9\\\\\\\"\\\"]}]\\)\
\"\>",
  StringForm["Output error: \!\(\*SubscriptBox[\(p\), \(out\)]\) = `1`", 
   NumberForm[
   1.5148400696478130291810766501176736150315596260796`37.350568166941194*^-9,
     4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7663943780841055`*^9, {3.7663944244741726`*^9, 3.7663944697548733`*^9}, 
   3.7663945075200415`*^9, {3.7663946591119614`*^9, 3.7663947000177155`*^9}, 
   3.766401154960682*^9, {3.766406610723663*^9, 3.766406630770295*^9}, {
   3.766407279644719*^9, 3.766407289769596*^9}, {3.766430955032665*^9, 
   3.766430990313489*^9}, 3.7664843671264668`*^9, 3.766498376494238*^9, 
   3.76669024322701*^9, 3.766692406188982*^9, 3.7666993565840807`*^9, 
   3.7667003076125445`*^9, 3.7667043463044004`*^9, 3.7667044874796357`*^9, {
   3.7667057430386715`*^9, 3.7667057888429537`*^9}, 3.766707400638065*^9, 
   3.7727508102459564`*^9, 3.7727516179140015`*^9, 3.7728925591303015`*^9, 
   3.7729216044299974`*^9, 3.772923223282447*^9, {3.7729766128083277`*^9, 
   3.772976625075656*^9}, 3.7729768665122566`*^9, 3.7729771071562133`*^9, {
   3.7729777972015543`*^9, 3.7729778443776407`*^9}},
 CellLabel->
  "During evaluation of \
In[108]:=",ExpressionUUID->"79d9a50d-4225-4543-8e8a-6fe171e02847"],

Cell[BoxData[
 InterpretationBox["\<\"Failure probability: \\!\\(\\*SubscriptBox[\\(p\\), \
\\(fail\\)]\\) = \\!\\(\\*RowBox[{\\\"\\\\\\\"0.004634\\\\\\\"\\\"}]\\)\"\>",
  StringForm[
  "Failure probability: \!\(\*SubscriptBox[\(p\), \(fail\)]\) = `1`", 
   NumberForm[
   0.0046339045634253090698980769087062398009155236497330112143`44.\
18226099671334, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7663943780841055`*^9, {3.7663944244741726`*^9, 3.7663944697548733`*^9}, 
   3.7663945075200415`*^9, {3.7663946591119614`*^9, 3.7663947000177155`*^9}, 
   3.766401154960682*^9, {3.766406610723663*^9, 3.766406630770295*^9}, {
   3.766407279644719*^9, 3.766407289769596*^9}, {3.766430955032665*^9, 
   3.766430990313489*^9}, 3.7664843671264668`*^9, 3.766498376494238*^9, 
   3.76669024322701*^9, 3.766692406188982*^9, 3.7666993565840807`*^9, 
   3.7667003076125445`*^9, 3.7667043463044004`*^9, 3.7667044874796357`*^9, {
   3.7667057430386715`*^9, 3.7667057888429537`*^9}, 3.766707400638065*^9, 
   3.7727508102459564`*^9, 3.7727516179140015`*^9, 3.7728925591303015`*^9, 
   3.7729216044299974`*^9, 3.772923223282447*^9, {3.7729766128083277`*^9, 
   3.772976625075656*^9}, 3.7729768665122566`*^9, 3.7729771071562133`*^9, {
   3.7729777972015543`*^9, 3.7729778443891745`*^9}},
 CellLabel->
  "During evaluation of \
In[108]:=",ExpressionUUID->"198677b1-43e8-479b-b0e1-156a96516520"],

Cell[BoxData[
 InterpretationBox["\<\"Space cost: \\!\\(\\*RowBox[{\\\"762\\\"}]\\) \
qubits\"\>",
  StringForm["Space cost: `1` qubits", 762],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7663943780841055`*^9, {3.7663944244741726`*^9, 3.7663944697548733`*^9}, 
   3.7663945075200415`*^9, {3.7663946591119614`*^9, 3.7663947000177155`*^9}, 
   3.766401154960682*^9, {3.766406610723663*^9, 3.766406630770295*^9}, {
   3.766407279644719*^9, 3.766407289769596*^9}, {3.766430955032665*^9, 
   3.766430990313489*^9}, 3.7664843671264668`*^9, 3.766498376494238*^9, 
   3.76669024322701*^9, 3.766692406188982*^9, 3.7666993565840807`*^9, 
   3.7667003076125445`*^9, 3.7667043463044004`*^9, 3.7667044874796357`*^9, {
   3.7667057430386715`*^9, 3.7667057888429537`*^9}, 3.766707400638065*^9, 
   3.7727508102459564`*^9, 3.7727516179140015`*^9, 3.7728925591303015`*^9, 
   3.7729216044299974`*^9, 3.772923223282447*^9, {3.7729766128083277`*^9, 
   3.772976625075656*^9}, 3.7729768665122566`*^9, 3.7729771071562133`*^9, {
   3.7729777972015543`*^9, 3.7729778443891745`*^9}},
 CellLabel->
  "During evaluation of \
In[108]:=",ExpressionUUID->"add4e0df-2047-4a2d-ad73-9626e05602eb"],

Cell[BoxData[
 InterpretationBox["\<\"Time cost: \\!\\(\\*RowBox[{\\\"\\\\\\\"36.17\\\\\\\"\
\\\"}]\\) code cycles\"\>",
  StringForm["Time cost: `1` code cycles", 
   NumberForm[
   36.1675971936839404133842956069460723560668861363072404950051`46.\
514296755130175, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7663943780841055`*^9, {3.7663944244741726`*^9, 3.7663944697548733`*^9}, 
   3.7663945075200415`*^9, {3.7663946591119614`*^9, 3.7663947000177155`*^9}, 
   3.766401154960682*^9, {3.766406610723663*^9, 3.766406630770295*^9}, {
   3.766407279644719*^9, 3.766407289769596*^9}, {3.766430955032665*^9, 
   3.766430990313489*^9}, 3.7664843671264668`*^9, 3.766498376494238*^9, 
   3.76669024322701*^9, 3.766692406188982*^9, 3.7666993565840807`*^9, 
   3.7667003076125445`*^9, 3.7667043463044004`*^9, 3.7667044874796357`*^9, {
   3.7667057430386715`*^9, 3.7667057888429537`*^9}, 3.766707400638065*^9, 
   3.7727508102459564`*^9, 3.7727516179140015`*^9, 3.7728925591303015`*^9, 
   3.7729216044299974`*^9, 3.772923223282447*^9, {3.7729766128083277`*^9, 
   3.772976625075656*^9}, 3.7729768665122566`*^9, 3.7729771071562133`*^9, {
   3.7729777972015543`*^9, 3.772977844396683*^9}},
 CellLabel->
  "During evaluation of \
In[108]:=",ExpressionUUID->"b272e77b-451d-4822-b951-448f691912e9"],

Cell[BoxData[
 InterpretationBox["\<\"Spacetime cost: \\!\\(\\*RowBox[{\\\"\\\\\\\"27560.\\\
\\\\\"\\\"}]\\) qubitcycles\"\>",
  StringForm["Spacetime cost: `1` qubitcycles", 
   NumberForm[
   27559.7090615871625949988332524929071353229672358661172571938906`46.\
514296755130175, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7663943780841055`*^9, {3.7663944244741726`*^9, 3.7663944697548733`*^9}, 
   3.7663945075200415`*^9, {3.7663946591119614`*^9, 3.7663947000177155`*^9}, 
   3.766401154960682*^9, {3.766406610723663*^9, 3.766406630770295*^9}, {
   3.766407279644719*^9, 3.766407289769596*^9}, {3.766430955032665*^9, 
   3.766430990313489*^9}, 3.7664843671264668`*^9, 3.766498376494238*^9, 
   3.76669024322701*^9, 3.766692406188982*^9, 3.7666993565840807`*^9, 
   3.7667003076125445`*^9, 3.7667043463044004`*^9, 3.7667044874796357`*^9, {
   3.7667057430386715`*^9, 3.7667057888429537`*^9}, 3.766707400638065*^9, 
   3.7727508102459564`*^9, 3.7727516179140015`*^9, 3.7728925591303015`*^9, 
   3.7729216044299974`*^9, 3.772923223282447*^9, {3.7729766128083277`*^9, 
   3.772976625075656*^9}, 3.7729768665122566`*^9, 3.7729771071562133`*^9, {
   3.7729777972015543`*^9, 3.7729778443967285`*^9}},
 CellLabel->
  "During evaluation of \
In[108]:=",ExpressionUUID->"4f3e2c38-6e14-42f7-881b-3e40b5246fb2"],

Cell[BoxData[
 InterpretationBox["\<\"For a 100-qubit computation: \\!\\(\\*SuperscriptBox[\
\\(\\!\\(\\*RowBox[{\\\"\\\\\\\"6.272\\\\\\\"\\\"}]\\)d\\), \\(3\\)]\\) \
(d=\\!\\(\\*RowBox[{\\\"13\\\"}]\\))\"\>",
  StringForm[
  "For a 100-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\)]\) \
(d=`2`)", 
   NumberForm[
   6.2721231364558858887116143041631559251986725616445419338175`46.\
514296755130175, 4], 13],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7663943780841055`*^9, {3.7663944244741726`*^9, 3.7663944697548733`*^9}, 
   3.7663945075200415`*^9, {3.7663946591119614`*^9, 3.7663947000177155`*^9}, 
   3.766401154960682*^9, {3.766406610723663*^9, 3.766406630770295*^9}, {
   3.766407279644719*^9, 3.766407289769596*^9}, {3.766430955032665*^9, 
   3.766430990313489*^9}, 3.7664843671264668`*^9, 3.766498376494238*^9, 
   3.76669024322701*^9, 3.766692406188982*^9, 3.7666993565840807`*^9, 
   3.7667003076125445`*^9, 3.7667043463044004`*^9, 3.7667044874796357`*^9, {
   3.7667057430386715`*^9, 3.7667057888429537`*^9}, 3.766707400638065*^9, 
   3.7727508102459564`*^9, 3.7727516179140015`*^9, 3.7728925591303015`*^9, 
   3.7729216044299974`*^9, 3.772923223282447*^9, {3.7729766128083277`*^9, 
   3.772976625075656*^9}, 3.7729768665122566`*^9, 3.7729771071562133`*^9, {
   3.7729777972015543`*^9, 3.7729778443967285`*^9}},
 CellLabel->
  "During evaluation of \
In[108]:=",ExpressionUUID->"68d155f0-f76b-4b8c-a8dc-8fb63f20aa8b"],

Cell[BoxData[
 InterpretationBox["\<\"For a 10000-qubit computation: \
\\!\\(\\*SuperscriptBox[\\(\\!\\(\\*RowBox[{\\\"\\\\\\\"4.083\\\\\\\"\\\"}]\\)\
d\\), \\(3\\)]\\) (d=\\!\\(\\*RowBox[{\\\"15\\\"}]\\))\"\>",
  StringForm[
  "For a 10000-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\)]\) \
(d=`2`)", 
   NumberForm[
   4.0829198609758759399998271485174677237515507016097951492138`46.\
514296755130175, 4], 15],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7663943780841055`*^9, {3.7663944244741726`*^9, 3.7663944697548733`*^9}, 
   3.7663945075200415`*^9, {3.7663946591119614`*^9, 3.7663947000177155`*^9}, 
   3.766401154960682*^9, {3.766406610723663*^9, 3.766406630770295*^9}, {
   3.766407279644719*^9, 3.766407289769596*^9}, {3.766430955032665*^9, 
   3.766430990313489*^9}, 3.7664843671264668`*^9, 3.766498376494238*^9, 
   3.76669024322701*^9, 3.766692406188982*^9, 3.7666993565840807`*^9, 
   3.7667003076125445`*^9, 3.7667043463044004`*^9, 3.7667044874796357`*^9, {
   3.7667057430386715`*^9, 3.7667057888429537`*^9}, 3.766707400638065*^9, 
   3.7727508102459564`*^9, 3.7727516179140015`*^9, 3.7728925591303015`*^9, 
   3.7729216044299974`*^9, 3.772923223282447*^9, {3.7729766128083277`*^9, 
   3.772976625075656*^9}, 3.7729768665122566`*^9, 3.7729771071562133`*^9, {
   3.7729777972015543`*^9, 3.7729778443967285`*^9}},
 CellLabel->
  "During evaluation of \
In[108]:=",ExpressionUUID->"662e78ce-3013-41b4-9e24-3684ef39a4e2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CostOfTwoLevel15to1SmallFootprint", "[", 
  RowBox[{
   SuperscriptBox["10", 
    RowBox[{"-", "3"}]], ",", "9", ",", "5", ",", "5", ",", "21", ",", "9", 
   ",", "11"}], "]"}]], "Input",
 CellChangeTimes->{{3.766396990630665*^9, 3.7663970041461267`*^9}, {
  3.7664010230820847`*^9, 3.7664010287226424`*^9}, {3.7664011155061216`*^9, 
  3.7664011231466556`*^9}, {3.7664011648668118`*^9, 3.766401185804063*^9}, {
  3.766403766893633*^9, 3.7664037674092536`*^9}, {3.76640384748882*^9, 
  3.7664038679900937`*^9}, {3.7664039091302223`*^9, 3.7664039566321287`*^9}, {
  3.7664306761922884`*^9, 3.766430684192191*^9}, {3.766430717941783*^9, 
  3.766430753691351*^9}, {3.7664308858616295`*^9, 3.7664308859241257`*^9}, {
  3.7664897447555723`*^9, 3.7664897551460724`*^9}, {3.7728930570776405`*^9, 
  3.7728930663229737`*^9}, {3.772894079680624*^9, 3.772894148037685*^9}},
 CellLabel->
  "In[152]:=",ExpressionUUID->"42b7d6bc-8eb8-4de8-9123-cb51e5633b53"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox["\<\"Small-footprint \
(15-to-1\\!\\(\\*SubscriptBox[\\()\\), \\(\\!\\(\\*RowBox[{\\\"9\\\"}]\\), \
\\!\\(\\*RowBox[{\\\"5\\\"}]\\), \\!\\(\\*RowBox[{\\\"5\\\"}]\\)\\)]\\)\
\[Times](15-to-1\\!\\(\\*SubscriptBox[\\()\\), \
\\(\\!\\(\\*RowBox[{\\\"21\\\"}]\\), \\!\\(\\*RowBox[{\\\"9\\\"}]\\), \
\\!\\(\\*RowBox[{\\\"11\\\"}]\\)\\)]\\) with \\!\\(\\*SubscriptBox[\\(p\\), \
\\(phys\\)]\\)=\\!\\(\\*RowBox[{\\\"\\\\\\\"0.001\\\\\\\"\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(x\\)]\\)=\\!\\(\\*RowBox[{\\\"9\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(z\\)]\\)=\\!\\(\\*RowBox[{\\\"5\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(m\\)]\\)=\\!\\(\\*RowBox[{\\\"5\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(x2\\)]\\)=\\!\\(\\*RowBox[{\\\"21\\\"}]\\), \
\\!\\(\\*SubscriptBox[\\(d\\), \\(z2\\)]\\)=\\!\\(\\*RowBox[{\\\"9\\\"}]\\) \
and \\!\\(\\*SubscriptBox[\\(d\\), \\(m2\\)]\\)=\\!\\(\\*RowBox[{\\\"11\\\"}]\
\\)\"\>",
  StringForm[
  "Small-footprint (15-to-1\!\(\*SubscriptBox[\()\), \(`1`, `2`, `3`\)]\)\
\[Times](15-to-1\!\(\*SubscriptBox[\()\), \(`4`, `5`, `6`\)]\) with \
\!\(\*SubscriptBox[\(p\), \(phys\)]\)=`7`, \!\(\*SubscriptBox[\(d\), \
\(x\)]\)=`1`, \!\(\*SubscriptBox[\(d\), \(z\)]\)=`2`, \
\!\(\*SubscriptBox[\(d\), \(m\)]\)=`3`, \!\(\*SubscriptBox[\(d\), \
\(x2\)]\)=`4`, \!\(\*SubscriptBox[\(d\), \(z2\)]\)=`5` and \
\!\(\*SubscriptBox[\(d\), \(m2\)]\)=`6`", 9, 5, 5, 21, 9, 11, 
   NumberForm[0.001]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7728940462085505`*^9, {3.7728940830531745`*^9, 3.772894144087205*^9}, 
   3.7729232266781793`*^9},
 CellLabel->
  "During evaluation of \
In[152]:=",ExpressionUUID->"27d47be5-b79c-4a33-9bd5-494010238e25"],

Cell[BoxData[
 InterpretationBox["\<\"Output error: \\!\\(\\*SubscriptBox[\\(p\\), \
\\(out\\)]\\) = \\!\\(\\*RowBox[{\\\"\\\\\\\"6.076\\\\\\\"\\\", \
\\\"\[Times]\\\", SuperscriptBox[\\\"10\\\", \
\\\"\\\\\\\"-10\\\\\\\"\\\"]}]\\)\"\>",
  StringForm["Output error: \!\(\*SubscriptBox[\(p\), \(out\)]\) = `1`", 
   NumberForm[
   6.076102142672995720210654016325372737991707573601`36.80139080322329*^-10, 
    4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7728940462085505`*^9, {3.7728940830531745`*^9, 3.772894144087205*^9}, 
   3.7729232266821823`*^9},
 CellLabel->
  "During evaluation of \
In[152]:=",ExpressionUUID->"41b042f1-7b8c-48bc-9c16-14694d94ed9b"],

Cell[BoxData[
 InterpretationBox["\<\"Failure probability: \\!\\(\\*SubscriptBox[\\(p\\), \
\\(fail\\)]\\) = \\!\\(\\*RowBox[{\\\"\\\\\\\"0.003255\\\\\\\"\\\"}]\\)\"\>",
  StringForm[
  "Failure probability: \!\(\*SubscriptBox[\(p\), \(fail\)]\) = `1`", 
   NumberForm[
   0.0032546536251483234949897909231993690079809212408302392941`43.\
875504005223114, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7728940462085505`*^9, {3.7728940830531745`*^9, 3.772894144087205*^9}, 
   3.7729232266922503`*^9},
 CellLabel->
  "During evaluation of \
In[152]:=",ExpressionUUID->"799e1e0b-ef04-46ee-88d2-db760e8f4552"],

Cell[BoxData[
 InterpretationBox["\<\"Space cost: \\!\\(\\*RowBox[{\\\"7782\\\"}]\\) qubits\
\"\>",
  StringForm["Space cost: `1` qubits", 7782],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7728940462085505`*^9, {3.7728940830531745`*^9, 3.772894144087205*^9}, 
   3.7729232266922503`*^9},
 CellLabel->
  "During evaluation of \
In[152]:=",ExpressionUUID->"ee98f219-b1ce-45cf-901c-52bc20a8638c"],

Cell[BoxData[
 InterpretationBox["\<\"Time cost: \\!\\(\\*RowBox[{\\\"\\\\\\\"468.5\\\\\\\"\
\\\"}]\\) code cycles\"\>",
  StringForm["Time cost: `1` code cycles", 
   NumberForm[468.4593841386446856581`4., 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7728940462085505`*^9, {3.7728940830531745`*^9, 3.772894144087205*^9}, 
   3.7729232266983004`*^9},
 CellLabel->
  "During evaluation of \
In[152]:=",ExpressionUUID->"b9c509bb-20e6-4146-afcf-22f2a2f62f1f"],

Cell[BoxData[
 InterpretationBox["\<\"Spacetime cost: \
\\!\\(\\*RowBox[{\\\"\\\\\\\"3.646\\\\\\\"\\\", \\\"\[Times]\\\", \
SuperscriptBox[\\\"10\\\", \\\"\\\\\\\"6\\\\\\\"\\\"]}]\\) qubitcycles\"\>",
  StringForm["Spacetime cost: `1` qubitcycles", 
   NumberForm[
   3.6455509273669329437916655379807790095818730654016994391082456837`46.\
12420096421711*^6, 4]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7728940462085505`*^9, {3.7728940830531745`*^9, 3.772894144087205*^9}, 
   3.772923226702304*^9},
 CellLabel->
  "During evaluation of \
In[152]:=",ExpressionUUID->"d0364ba1-1e4b-440d-aaaf-79fdc428c524"],

Cell[BoxData[
 InterpretationBox["\<\"For a 100-qubit computation: \\!\\(\\*SuperscriptBox[\
\\(\\!\\(\\*RowBox[{\\\"\\\\\\\"74.74\\\\\\\"\\\"}]\\)d\\), \\(3\\)]\\) \
(d=\\!\\(\\*RowBox[{\\\"29\\\"}]\\))\"\>",
  StringForm[
  "For a 100-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\)]\) \
(d=`2`)", 
   NumberForm[
   74.7376056289091997169147061786210793714763431342346844706022`46.\
12420096421711, 4], 29],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7728940462085505`*^9, {3.7728940830531745`*^9, 3.772894144087205*^9}, 
   3.772923226702304*^9},
 CellLabel->
  "During evaluation of \
In[152]:=",ExpressionUUID->"7d082d30-3aa6-4fe4-8e2b-248da934900d"],

Cell[BoxData[
 InterpretationBox["\<\"For a 10000-qubit computation: \
\\!\\(\\*SuperscriptBox[\\(\\!\\(\\*RowBox[{\\\"\\\\\\\"50.72\\\\\\\"\\\"}]\\)\
d\\), \\(3\\)]\\) (d=\\!\\(\\*RowBox[{\\\"33\\\"}]\\))\"\>",
  StringForm[
  "For a 10000-qubit computation: \!\(\*SuperscriptBox[\(`1`d\), \(3\)]\) \
(d=`2`)", 
   NumberForm[
   50.7214142439120258200693649717669673259018986754834771838138`46.\
12420096421711, 4], 33],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7728940462085505`*^9, {3.7728940830531745`*^9, 3.772894144087205*^9}, 
   3.772923226708354*^9},
 CellLabel->
  "During evaluation of \
In[152]:=",ExpressionUUID->"f261b763-59e1-4a8f-9d16-704ee4c93185"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{635, 1108},
WindowMargins->{{Automatic, -7}, {Automatic, 0}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 284, 5, 96, "Title",ExpressionUUID->"7b061464-1174-42da-9a30-015c9811eb9c",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[889, 31, 291, 5, 53, "Subsection",ExpressionUUID->"9ebe6c1d-02e0-4df3-9f0b-a476c90512f9",
 InitializationCell->True],
Cell[1183, 38, 1232, 27, 121, "Input",ExpressionUUID->"502f799d-cad8-4eb8-a569-7f825d0b12d9",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[2452, 70, 259, 6, 53, "Subsection",ExpressionUUID->"1919e19d-05f9-4691-900f-a2678a4e9203",
 InitializationCell->True],
Cell[2714, 78, 1625, 51, 83, "Input",ExpressionUUID->"0e8a831e-4518-4d6d-9873-6edd7268de0b",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[4376, 134, 220, 4, 53, "Subsection",ExpressionUUID->"790315b2-b4b4-4a0e-9436-cd193891b3b3",
 InitializationCell->True],
Cell[4599, 140, 852, 22, 83, "Input",ExpressionUUID->"f9bbf4ed-d63c-44b4-b382-bb4523a0e8b2",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[5488, 167, 274, 7, 53, "Subsection",ExpressionUUID->"15368d64-d5dc-400a-be4e-3c8e0363c136",
 InitializationCell->True],
Cell[5765, 176, 806, 20, 83, "Input",ExpressionUUID->"c115fa45-4058-4b57-8100-0fa8b25ae19e",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[6608, 201, 445, 12, 53, "Subsection",ExpressionUUID->"2b4d590d-9b92-403f-ad14-1bbc3524227b",
 InitializationCell->True],
Cell[7056, 215, 918, 23, 44, "Input",ExpressionUUID->"8eb5be51-f800-4bdf-824e-9cc74a87a20f",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[8011, 243, 5000, 169, 83, "Subsection",ExpressionUUID->"f4f0b7fa-5ce7-4424-bffd-7b23bd97be66",
 InitializationCell->True],
Cell[13014, 414, 1901, 57, 44, "Input",ExpressionUUID->"4dd718ac-0c82-44ca-9dec-5d5008c8bd22",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[14952, 476, 292, 7, 53, "Subsection",ExpressionUUID->"060ecccd-6c36-408b-ae7f-075de8b4df9d",
 InitializationCell->True],
Cell[15247, 485, 612, 16, 44, "Input",ExpressionUUID->"4ec0e330-bb8f-4409-83b0-94cafced2957",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[15896, 506, 433, 11, 56, "Subsection",ExpressionUUID->"805c1e0c-df17-490a-acc0-2cd362f2af9e",
 InitializationCell->True],
Cell[16332, 519, 481, 14, 67, "Input",ExpressionUUID->"1b1a8366-6b6d-4811-9042-767ad19fad5e",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[16850, 538, 352, 8, 53, "Subsection",ExpressionUUID->"8a8c97dd-e7dd-47e9-8352-4a1f3be55759",
 InitializationCell->True],
Cell[17205, 548, 1550, 38, 140, "Input",ExpressionUUID->"7d73a321-eaac-4fac-904c-47ff56c07f6f",
 InitializationCell->True],
Cell[18758, 588, 1546, 38, 140, "Input",ExpressionUUID->"16f46c30-1471-433e-8711-28372439517d",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[20341, 631, 254, 7, 53, "Subsection",ExpressionUUID->"9c017ebc-519a-4f40-a733-73cf474ef4d7",
 InitializationCell->True],
Cell[20598, 640, 1817, 44, 159, "Input",ExpressionUUID->"77e7bfdd-72d9-4fc0-8438-7c8618af701e",
 InitializationCell->True],
Cell[22418, 686, 1815, 44, 159, "Input",ExpressionUUID->"7790425b-67fc-4a5a-9af9-7fb6072120af",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[24270, 735, 254, 7, 53, "Subsection",ExpressionUUID->"2fcbcf47-d3c2-4aa2-ad3d-2a245cb767bc",
 InitializationCell->True],
Cell[24527, 744, 2657, 64, 197, "Input",ExpressionUUID->"dfe4f924-234f-488a-9cf6-8163b81c8ba0",
 InitializationCell->True],
Cell[27187, 810, 2681, 64, 197, "Input",ExpressionUUID->"3710a954-c850-4b2f-be8f-36996c7da5bc",
 InitializationCell->True],
Cell[29871, 876, 413, 8, 64, "Input",ExpressionUUID->"3fe62e5e-f406-46e5-9029-8b957d9a3e02",
 InitializationCell->True]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[30333, 890, 188, 4, 70, "Title",ExpressionUUID->"2cf1b9f8-6207-4ef8-9bb1-e72fb706d8c5",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[30546, 898, 248, 6, 79, "Subsection",ExpressionUUID->"cf4077be-3b48-4490-bdaa-3655940f326c",
 InitializationCell->True],
Cell[30797, 906, 28069, 719, 3498, "Input",ExpressionUUID->"b909ae9e-36fe-4f24-9c65-d4e05336a134",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[58903, 1630, 970, 25, 86, "Subsection",ExpressionUUID->"4b4a6f57-2631-4851-8f13-3a7b4f2b2589",
 InitializationCell->True],
Cell[59876, 1657, 11407, 274, 662, "Input",ExpressionUUID->"92310ae5-d95b-40eb-bef5-476929887f1b",
 InitializationCell->True]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[71332, 1937, 260, 5, 70, "Title",ExpressionUUID->"16af40d5-7719-4dfa-9552-ab3062ed2075",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[71617, 1946, 1347, 37, 116, "Subsection",ExpressionUUID->"865670e1-1850-4537-a572-5d54955a35f5",
 InitializationCell->True],
Cell[72967, 1985, 49325, 1224, 5673, "Input",ExpressionUUID->"d7e8b2ec-aa9e-423c-90aa-a7caca52b7ae",
 InitializationCell->True]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[122341, 3215, 308, 5, 70, "Title",ExpressionUUID->"cc221950-c2a6-4cd5-8ffa-4154722ff588",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[122674, 3224, 1362, 36, 116, "Subsection",ExpressionUUID->"758a7373-ab77-48e5-87d9-52bccfdfd20b",
 InitializationCell->True],
Cell[124039, 3262, 65826, 1683, 7802, "Input",ExpressionUUID->"d57c9250-a2bd-4585-b5bf-b1bb54d29152",
 InitializationCell->True]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[189914, 4951, 309, 5, 70, "Title",ExpressionUUID->"f6cd8429-dffb-44bc-b8e8-ac0857f37351",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[190248, 4960, 1448, 38, 116, "Subsection",ExpressionUUID->"9719aa13-1c19-49ad-8930-8ef0ed383918",
 InitializationCell->True],
Cell[191699, 5000, 36750, 914, 4093, "Input",ExpressionUUID->"60078593-e9e7-49ab-a3f7-598cc35e5bdf",
 InitializationCell->True]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[228498, 5920, 351, 6, 70, "Title",ExpressionUUID->"36b7e4b4-fd7c-46de-a5fb-9989ca393b3c",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[228874, 5930, 957, 25, 112, "Subsection",ExpressionUUID->"e3e6bdec-a6c9-431d-bb71-03483ba9a798",
 InitializationCell->True],
Cell[229834, 5957, 47732, 1226, 6025, "Input",ExpressionUUID->"7917b973-72c6-4fd1-8170-ad8ae191a475",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[277603, 7188, 1337, 36, 112, "Subsection",ExpressionUUID->"7f53c6f0-584f-4c62-a439-27b858cbe224",
 InitializationCell->True],
Cell[278943, 7226, 60164, 1488, 7305, "Input",ExpressionUUID->"d7359a8d-f955-40c2-aee5-2bd3000f8d34",
 InitializationCell->True]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[339156, 8720, 150, 3, 70, "Title",ExpressionUUID->"17de98fd-e5bc-43bf-bcee-b42d7671d4b6"],
Cell[339309, 8725, 443, 11, 70, "Chapter",ExpressionUUID->"b45c8d01-6360-4a90-9931-6d85698dea07",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[CellGroupData[{
Cell[339777, 8740, 618, 12, 32, "Input",ExpressionUUID->"881c03f1-bce6-4945-bb48-12532cac4dc4"],
Cell[CellGroupData[{
Cell[340420, 8756, 2073, 33, 25, "Print",ExpressionUUID->"7b5c4bda-e3eb-48c1-8f48-26e080c736f7"],
Cell[342496, 8791, 1664, 27, 24, "Print",ExpressionUUID->"2d85b376-76ff-4e2a-8444-b28d43b58c4a"],
Cell[344163, 8820, 1607, 26, 22, "Print",ExpressionUUID->"5cf86f94-f807-4feb-b6bd-45f0f7e327ac"],
Cell[345773, 8848, 1391, 22, 22, "Print",ExpressionUUID->"474b65d4-ad8e-47bd-87a8-69bb835cd8c2"],
Cell[347167, 8872, 1518, 25, 22, "Print",ExpressionUUID->"326cbce8-7630-45b3-986f-ad64a66e3eb1"],
Cell[348688, 8899, 1532, 25, 22, "Print",ExpressionUUID->"bf8751e5-bc62-42d2-b748-1b33bba910b4"],
Cell[350223, 8926, 1667, 28, 24, "Print",ExpressionUUID->"bc8fac42-cd41-48d1-8fed-d64268a74649"],
Cell[351893, 8956, 1671, 28, 24, "Print",ExpressionUUID->"4fc4ce2d-cc5a-44e6-83f6-adb473365250"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[353613, 8990, 367, 8, 32, "Input",ExpressionUUID->"47ac73b4-a629-47e9-8119-b7d721138c87"],
Cell[CellGroupData[{
Cell[354005, 9002, 1643, 28, 25, "Print",ExpressionUUID->"cd817c6f-eea1-4c05-ae82-6093c412f7dd"],
Cell[355651, 9032, 1236, 22, 24, "Print",ExpressionUUID->"b8b398d6-cdac-4bee-a888-a9cbf0e0267e"],
Cell[356890, 9056, 1179, 21, 22, "Print",ExpressionUUID->"7b880c2a-a4dc-41f9-85a3-d9018bdc9ba5"],
Cell[358072, 9079, 965, 17, 22, "Print",ExpressionUUID->"3173d4e2-8ed5-4adc-9683-9fa6a3e304be"],
Cell[359040, 9098, 1091, 20, 22, "Print",ExpressionUUID->"bb741d8a-1fff-4c35-8345-09af79d046e8"],
Cell[360134, 9120, 1105, 20, 22, "Print",ExpressionUUID->"cbc6b4f7-2417-4700-a640-9284ca8feb38"],
Cell[361242, 9142, 1238, 23, 24, "Print",ExpressionUUID->"796b575f-17bf-4bd2-8259-6d3017a1043b"],
Cell[362483, 9167, 1242, 23, 24, "Print",ExpressionUUID->"b6e06727-6907-4c65-bfbf-2b1c49c007a1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[363774, 9196, 417, 9, 32, "Input",ExpressionUUID->"ce8cd55d-f39a-47da-968a-997e0a12f08e"],
Cell[CellGroupData[{
Cell[364216, 9209, 1006, 19, 25, "Print",ExpressionUUID->"d0a66bc2-df82-41a2-8ce5-b73388623a6e"],
Cell[365225, 9230, 593, 13, 24, "Print",ExpressionUUID->"45d5502b-c367-4cf6-ab34-61bb29b3521e"],
Cell[365821, 9245, 538, 12, 22, "Print",ExpressionUUID->"253f5931-27f4-4e80-bd7c-24237d2ecd64"],
Cell[366362, 9259, 323, 8, 22, "Print",ExpressionUUID->"788df7f4-714c-4aec-8286-d0477d4ff11d"],
Cell[366688, 9269, 449, 11, 22, "Print",ExpressionUUID->"1e240199-36b0-4e27-b725-40de096c79c7"],
Cell[367140, 9282, 463, 11, 22, "Print",ExpressionUUID->"64f300fe-2c43-451d-86a2-a811c135b207"],
Cell[367606, 9295, 596, 14, 24, "Print",ExpressionUUID->"3fcc097c-219f-438f-bbbd-7975dc7c133b"],
Cell[368205, 9311, 600, 14, 24, "Print",ExpressionUUID->"707ed62f-1407-4496-9e52-0e3170544c1c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[368854, 9331, 603, 11, 32, "Input",ExpressionUUID->"2961b85e-3821-4ff2-bb24-6ba4895a043b"],
Cell[CellGroupData[{
Cell[369482, 9346, 1904, 31, 46, "Print",ExpressionUUID->"e8f50537-a507-47bc-8ad8-b217affadd8b"],
Cell[371389, 9379, 680, 13, 24, "Print",ExpressionUUID->"d4cf0d8a-1285-4a22-9dbf-bda778e2c6bf"],
Cell[372072, 9394, 704, 14, 24, "Print",ExpressionUUID->"5505605b-2188-4ed3-a81b-574d2d5118ef"],
Cell[372779, 9410, 423, 9, 22, "Print",ExpressionUUID->"52be35d0-be93-4240-b7a8-d61498b60952"],
Cell[373205, 9421, 486, 10, 22, "Print",ExpressionUUID->"b9d327ed-b613-4818-9461-0fda46e58375"],
Cell[373694, 9433, 596, 13, 22, "Print",ExpressionUUID->"a0c1f8b8-b33f-4deb-ab9c-ae9fa9a9c398"],
Cell[374293, 9448, 692, 15, 24, "Print",ExpressionUUID->"2b8cfd64-4d48-458a-8445-dddc07712c63"],
Cell[374988, 9465, 696, 15, 24, "Print",ExpressionUUID->"bc555260-a56e-4561-8d5c-1078f608dac8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[375733, 9486, 533, 10, 32, "Input",ExpressionUUID->"aded8002-718c-4220-aebc-077146646eb0"],
Cell[CellGroupData[{
Cell[376291, 9500, 2904, 46, 46, "Print",ExpressionUUID->"97ae4f87-a0f1-4ec1-8fbb-f4bfef6fc2b4"],
Cell[379198, 9548, 1669, 27, 24, "Print",ExpressionUUID->"be3958af-6687-4208-8f19-6004f20e589e"],
Cell[380870, 9577, 1708, 29, 24, "Print",ExpressionUUID->"78ae19c8-1d17-470b-8a46-a8db756edb3b"],
Cell[382581, 9608, 1423, 24, 22, "Print",ExpressionUUID->"28730148-58a9-4f69-bfd4-58b441a37599"],
Cell[384007, 9634, 1488, 25, 22, "Print",ExpressionUUID->"a0b601b7-2e16-4a99-a03b-064c66849699"],
Cell[385498, 9661, 1638, 28, 24, "Print",ExpressionUUID->"96abc3b1-cf96-4976-a37f-3e04e46df9a7"],
Cell[387139, 9691, 1695, 30, 24, "Print",ExpressionUUID->"63a4da7d-56c6-4c66-ab8a-7b33e9f587a2"],
Cell[388837, 9723, 1699, 30, 24, "Print",ExpressionUUID->"aafd3179-cd94-46f7-93b8-cadd5828009a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[390585, 9759, 416, 11, 70, "Chapter",ExpressionUUID->"fd8ade6d-11fc-418d-b51d-3fc59ad1ac0b"],
Cell[CellGroupData[{
Cell[391026, 9774, 540, 10, 32, "Input",ExpressionUUID->"aa224796-0311-490e-9e30-ab7b13101bbf"],
Cell[CellGroupData[{
Cell[391591, 9788, 2012, 33, 25, "Print",ExpressionUUID->"be04bac7-75d4-42a4-97a8-9e2b8e028930"],
Cell[393606, 9823, 1602, 27, 24, "Print",ExpressionUUID->"d43a4418-dc13-4cbb-9051-defb45f6f006"],
Cell[395211, 9852, 1546, 26, 22, "Print",ExpressionUUID->"c2c2ee86-1d78-4be7-a6c4-b935d626e25c"],
Cell[396760, 9880, 1333, 22, 22, "Print",ExpressionUUID->"4903dec6-f3e5-4ce9-9394-751ef572ef60"],
Cell[398096, 9904, 1458, 25, 22, "Print",ExpressionUUID->"405d44e5-38b6-4ab3-950a-4c42e1880cfc"],
Cell[399557, 9931, 1474, 25, 22, "Print",ExpressionUUID->"a465d2d6-50ac-4120-ac29-4970ac0d661a"],
Cell[401034, 9958, 1603, 28, 24, "Print",ExpressionUUID->"647ab959-94a0-485b-a5e8-94f33e668fea"],
Cell[402640, 9988, 1607, 28, 24, "Print",ExpressionUUID->"4f25109b-2332-4725-90a6-ebc413a9fe7d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[404296, 10022, 421, 8, 28, "Input",ExpressionUUID->"19fb1c6f-1c94-42a5-a76b-172fabfe240f"],
Cell[CellGroupData[{
Cell[404742, 10034, 2304, 37, 46, "Print",ExpressionUUID->"1eeb1357-5b36-4856-8f8d-c07a0cf5ac41"],
Cell[407049, 10073, 1025, 18, 24, "Print",ExpressionUUID->"7af19f18-2d54-4092-b492-a96c88f7f047"],
Cell[408077, 10093, 966, 17, 22, "Print",ExpressionUUID->"2cdfd685-900f-4d8e-8cc1-888cd3a588b1"],
Cell[409046, 10112, 814, 15, 22, "Print",ExpressionUUID->"24e4ca6f-f5da-4c37-b359-5c71190e5d77"],
Cell[409863, 10129, 870, 16, 22, "Print",ExpressionUUID->"96c2edfe-87cd-462e-b2e9-bf1ecac17776"],
Cell[410736, 10147, 995, 18, 24, "Print",ExpressionUUID->"cf100b7f-0c38-4b7d-964b-f9ca452cc909"],
Cell[411734, 10167, 1021, 19, 24, "Print",ExpressionUUID->"6a377a8f-3363-44e9-911a-a94464d549d8"],
Cell[412758, 10188, 1022, 19, 24, "Print",ExpressionUUID->"e9842c8f-111a-4587-a810-f18982c0480e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[413829, 10213, 847, 13, 28, "Input",ExpressionUUID->"1c73749d-5689-430f-a91d-2f115b7d9eb1"],
Cell[CellGroupData[{
Cell[414701, 10230, 2284, 36, 46, "Print",ExpressionUUID->"634b9f17-ab86-4d59-88d6-319e4e31759f"],
Cell[416988, 10268, 1003, 17, 24, "Print",ExpressionUUID->"02fd3d83-ac8e-46a9-a5ab-32c0dd875c2d"],
Cell[417994, 10287, 948, 16, 22, "Print",ExpressionUUID->"6d8970b1-9938-46e0-9add-75716bb7cf5d"],
Cell[418945, 10305, 796, 14, 22, "Print",ExpressionUUID->"892fa5ec-40ba-473b-a988-2611d887eda0"],
Cell[419744, 10321, 851, 15, 22, "Print",ExpressionUUID->"501c2d0e-fa02-4a20-8c7a-5853cb0e62a2"],
Cell[420598, 10338, 973, 17, 24, "Print",ExpressionUUID->"226041b4-26c8-4bb0-9b6c-f9ff6011b619"],
Cell[421574, 10357, 996, 18, 24, "Print",ExpressionUUID->"042a89d9-05e9-420b-b2cb-84b96d644363"],
Cell[422573, 10377, 1003, 18, 24, "Print",ExpressionUUID->"0557f0d8-4a58-4dc8-839b-09593eb93df8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[423625, 10401, 1151, 18, 32, "Input",ExpressionUUID->"d41d8a30-bcca-4918-8c83-a3deb5c8194e"],
Cell[CellGroupData[{
Cell[424801, 10423, 2804, 44, 46, "Print",ExpressionUUID->"1f514d8d-0a24-41a9-929d-70d0b0651343"],
Cell[427608, 10469, 1582, 27, 24, "Print",ExpressionUUID->"5429866f-bd33-4b9e-9d00-d482099d44f7"],
Cell[429193, 10498, 1531, 26, 22, "Print",ExpressionUUID->"5e057fbc-8aa2-42d7-85c7-c55c1434bb41"],
Cell[430727, 10526, 1316, 22, 22, "Print",ExpressionUUID->"9fe14288-12b9-4a8a-80ed-49ed6ded52d3"],
Cell[432046, 10550, 1382, 23, 22, "Print",ExpressionUUID->"9e1a605d-c8a0-490d-a24f-71aadba2a585"],
Cell[433431, 10575, 1533, 26, 24, "Print",ExpressionUUID->"388f06dd-8fc1-4898-b7c4-a95739a2aba1"],
Cell[434967, 10603, 1586, 28, 24, "Print",ExpressionUUID->"d78ae4ca-101e-4114-98b7-5ce8f9c20230"],
Cell[436556, 10633, 1592, 28, 24, "Print",ExpressionUUID->"00d9a962-1277-4bfd-925f-282357da5801"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[438197, 10667, 579, 10, 32, "Input",ExpressionUUID->"dfda2e5c-4b85-455d-9069-0ddfb370b78d"],
Cell[CellGroupData[{
Cell[438801, 10681, 2491, 40, 46, "Print",ExpressionUUID->"0861c888-0e8b-4c15-ac47-56638373155e"],
Cell[441295, 10723, 1263, 22, 24, "Print",ExpressionUUID->"bafa1add-108e-46c7-9d15-2790f6bdf8c8"],
Cell[442561, 10747, 1216, 22, 22, "Print",ExpressionUUID->"0bf457f8-a839-4b45-9963-949f0b80e9e2"],
Cell[443780, 10771, 1005, 18, 22, "Print",ExpressionUUID->"b3b76423-59be-4ecb-8305-e956db93cad2"],
Cell[444788, 10791, 1068, 19, 22, "Print",ExpressionUUID->"9c8cfe40-609e-4660-9381-4962a5396060"],
Cell[445859, 10812, 1222, 22, 24, "Print",ExpressionUUID->"abdd5086-5233-469c-991e-2a94b6c4916c"],
Cell[447084, 10836, 1277, 24, 24, "Print",ExpressionUUID->"d9b9562c-3f71-4ec3-89a1-770717186c9c"],
Cell[448364, 10862, 1281, 24, 24, "Print",ExpressionUUID->"bae1fa99-5da5-4749-ba7d-33408b2aef1b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[449694, 10892, 1171, 18, 32, "Input",ExpressionUUID->"35d0f932-d4b7-4290-a6ef-c16c9fa56ef9"],
Cell[CellGroupData[{
Cell[450890, 10914, 2814, 44, 46, "Print",ExpressionUUID->"c57210c1-635f-4398-9c44-43a6a8fb4cb3"],
Cell[453707, 10960, 1581, 26, 24, "Print",ExpressionUUID->"7d544555-d0ff-4caf-976e-45661b94e3a3"],
Cell[455291, 10988, 1611, 27, 24, "Print",ExpressionUUID->"ad462e2d-9e6b-445d-bb3d-8f15c278d308"],
Cell[456905, 11017, 1326, 22, 22, "Print",ExpressionUUID->"4c3a83a1-6dde-47b7-95e0-1462a634ad00"],
Cell[458234, 11041, 1392, 23, 22, "Print",ExpressionUUID->"71c0efe6-dec1-494d-9a7b-0b8b3a4a4571"],
Cell[459629, 11066, 1544, 26, 24, "Print",ExpressionUUID->"5278ca77-2bcd-435d-9728-af8f9a2e9172"],
Cell[461176, 11094, 1597, 28, 24, "Print",ExpressionUUID->"04c7e3e6-266d-4a6a-a145-24b10c6923fe"],
Cell[462776, 11124, 1603, 28, 24, "Print",ExpressionUUID->"f7a6f48c-4e4a-4500-a8ed-8828326d3029"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[464440, 11159, 263, 4, 67, "Chapter",ExpressionUUID->"db33e2a9-363c-4ff3-a1fc-cab48fee6344"],
Cell[CellGroupData[{
Cell[464728, 11167, 682, 12, 32, "Input",ExpressionUUID->"66a4cc80-2583-4b09-bd35-e9f56a5beaec"],
Cell[CellGroupData[{
Cell[465435, 11183, 2550, 41, 46, "Print",ExpressionUUID->"fb96e8b9-4b24-4a9b-9d03-1a87e4d4f7cd"],
Cell[467988, 11226, 1326, 23, 24, "Print",ExpressionUUID->"ae5db285-a504-40a2-ae23-7c774348647f"],
Cell[469317, 11251, 1351, 24, 24, "Print",ExpressionUUID->"03d623f1-edfb-45dd-8b20-12afdeea31e8"],
Cell[470671, 11277, 1067, 19, 22, "Print",ExpressionUUID->"2b33f05d-2b13-4feb-a1a7-790f2855dffd"],
Cell[471741, 11298, 1132, 20, 22, "Print",ExpressionUUID->"53c9b71d-5503-4230-8199-030e8e4adbe8"],
Cell[472876, 11320, 1244, 23, 22, "Print",ExpressionUUID->"d3ebbb44-25e9-406a-acc8-24c2e7af9c05"],
Cell[474123, 11345, 1341, 25, 24, "Print",ExpressionUUID->"7f79753e-e005-4c69-a027-32bece865507"],
Cell[475467, 11372, 1345, 25, 24, "Print",ExpressionUUID->"41a4b6d9-a27a-4794-8c2d-5d58ff478410"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[476861, 11403, 1017, 16, 32, "Input",ExpressionUUID->"4ac8b07f-0c00-4dd0-8dab-62081c6d2e0b"],
Cell[CellGroupData[{
Cell[477903, 11423, 1969, 33, 46, "Print",ExpressionUUID->"d165bddd-a4b9-413c-9c97-dd97a5a7fc39"],
Cell[479875, 11458, 745, 16, 24, "Print",ExpressionUUID->"8e6fedaf-dd1f-4d79-b184-97dee22e1c5c"],
Cell[480623, 11476, 694, 15, 22, "Print",ExpressionUUID->"3b9fc894-c0bf-4fb3-99c8-e16c8a00f18b"],
Cell[481320, 11493, 479, 11, 22, "Print",ExpressionUUID->"e0ca3ad5-48da-4d58-8c0b-7e501afc42c4"],
Cell[481802, 11506, 542, 12, 22, "Print",ExpressionUUID->"730cd929-da7c-45ca-b52b-cad4798bce7b"],
Cell[482347, 11520, 732, 16, 24, "Print",ExpressionUUID->"9cd518a6-accf-492b-8877-aac048cdb701"],
Cell[483082, 11538, 751, 17, 24, "Print",ExpressionUUID->"3d8c0dcc-59c2-4c19-ac6f-065db0490a7b"],
Cell[483836, 11557, 753, 17, 24, "Print",ExpressionUUID->"9783da00-090f-4dde-95b9-0ed9f0cf65be"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[484650, 11581, 312, 5, 67, "Chapter",ExpressionUUID->"e3e334fc-58f4-4906-8766-d825a241219b"],
Cell[CellGroupData[{
Cell[484987, 11590, 825, 14, 32, "Input",ExpressionUUID->"c1f85ee1-5c17-4c0b-aac1-70137c2c4cda"],
Cell[CellGroupData[{
Cell[485837, 11608, 1887, 32, 25, "Print",ExpressionUUID->"19d61e60-4ece-42df-a48c-733cdef1e289"],
Cell[487727, 11642, 1446, 25, 24, "Print",ExpressionUUID->"79d9a50d-4225-4543-8e8a-6fe171e02847"],
Cell[489176, 11669, 1391, 24, 22, "Print",ExpressionUUID->"198677b1-43e8-479b-b0e1-156a96516520"],
Cell[490570, 11695, 1175, 20, 22, "Print",ExpressionUUID->"add4e0df-2047-4a2d-ad73-9626e05602eb"],
Cell[491748, 11717, 1301, 23, 22, "Print",ExpressionUUID->"b272e77b-451d-4822-b951-448f691912e9"],
Cell[493052, 11742, 1317, 23, 22, "Print",ExpressionUUID->"4f3e2c38-6e14-42f7-881b-3e40b5246fb2"],
Cell[494372, 11767, 1450, 26, 24, "Print",ExpressionUUID->"68d155f0-f76b-4b8c-a8dc-8fb63f20aa8b"],
Cell[495825, 11795, 1454, 26, 24, "Print",ExpressionUUID->"662e78ce-3013-41b4-9e24-3684ef39a4e2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[497328, 11827, 969, 16, 32, "Input",ExpressionUUID->"42b7d6bc-8eb8-4de8-9123-cb51e5633b53"],
Cell[CellGroupData[{
Cell[498322, 11847, 1715, 30, 45, "Print",ExpressionUUID->"27d47be5-b79c-4a33-9bd5-494010238e25"],
Cell[500040, 11879, 673, 15, 24, "Print",ExpressionUUID->"41b042f1-7b8c-48bc-9c16-14694d94ed9b"],
Cell[500716, 11896, 619, 14, 22, "Print",ExpressionUUID->"799e1e0b-ef04-46ee-88d2-db760e8f4552"],
Cell[501338, 11912, 404, 10, 22, "Print",ExpressionUUID->"ee98f219-b1ce-45cf-901c-52bc20a8638c"],
Cell[501745, 11924, 470, 11, 22, "Print",ExpressionUUID->"b9c509bb-20e6-4146-afcf-22f2a2f62f1f"],
Cell[502218, 11937, 620, 14, 24, "Print",ExpressionUUID->"d0364ba1-1e4b-440d-aaaf-79fdc428c524"],
Cell[502841, 11953, 675, 16, 24, "Print",ExpressionUUID->"7d082d30-3aa6-4fe4-8e2b-248da934900d"],
Cell[503519, 11971, 679, 16, 24, "Print",ExpressionUUID->"f261b763-59e1-4a8f-9d16-704ee4c93185"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

